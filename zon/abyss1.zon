/*
filename    abyss1
password    vrock
changedby   Eirinn
EmailAdd     Jpc - John <clarej@tcd.ie>
request     
version     17
END HEADER*/

#include <composed.h>
#include <values.h>

/*

   email version 13
   current version 1.08

   02/Nov/1996 : First official version ready for Valhalla
   03/Nov/1996 : * Added eat_given dil to prevent burning of mobs.
                 * Made reimbursement dil for vial needed for Acina's quest.
                 * Fiddled with the mobs somewhat (mainly height/weight)
		 * Hopefully fixed reset problem with quest items by adding
		   unique mobs to carry them.
		 * Made quests one dil each instead of two
		 * Set spell 75 on quest items to make them hard to locate
		 * Changed name of weapon to just enforcer etc. not THE
   06/May/1997 : Eirinn changed Spear of suffering from Axe to spear.
*/


%zone 		abyss1		/* zone name */
lifespan 	20		/* reset time */
reset		RESET_ANYHOW	/* always reset */
creators	{"nexus"}

notes "This is to be one of the Abyssal Planes, there might be more of them
later. It consists of the plains of ash, a large skull fortress hanging from
four huge chains in a pit, and a battlefield were a battle between the
Tanar'ri from the Abyss and devils from hell was recently fought. This layer
of the Abyss is ruled by Goruk and he is trying to get back at the devils.
The pc's can do a quest here by helping a wounded devil get home again. To
accomplish this they first have to help Goruk's archmage out who needs to
fabricate a scroll to open the portal so her Lord's forces can lauch a
counterattack.&n
This zone might later be linked to other Abyssal planes through various portal
(or link) opportunities present.&n
Nice features (I think), are the chains leading to and from the fortress that
players can fall off based on their dexterity, and the possibility to jump or
throw someone out of the skull's eyesockets, to end up (for now) on Udgaard
or Midgaard square. Sitting down on Goruk's throne might be a 'shocking'
experience. Furthermore I have prevented players from disarming Goruk to
prevent easy access to his weapon.&n
This plane should be reached through the Styx boatman who requires one gold
piece to give you a ride into the plane. It is possible for more than one
person to make the boat ride at the same time. The only ways out at the
moment are the eyesockets and (for the bold) a few dashes along the chains
or the skull's lower jaw. Players can also use dragon wings of course if
they have a pair."

/*

Layout of the of this layer of the Abyss:

 Abyss
        naa**B    Abyss
        | a**BBB
...AAAw-E-ebbBBp  A Plain of Ash                b Bridge over Styx
..AAAAA | a**BBB  a around the pit              n,e,s,w
..AAAAAasaa**B... B Battle field                   North, East etc of Pit
..AAAAA*****....  E entrance to skull fortress  | and -
.. AAA.*......    . cliffs                         Chains leading to fortress
.......*....      p Portal on battlefield       * The river Styx
.......

Kinda hard to read but maybe it helps :)



Layout of the skull fortress:

| and - are connections
+ is a door
= is a secret door


Top floor

Entrance is above the middle of the corridor

W-S K	W  Wizard Acina's Study		K  Kitchen
+   +	S  Summoning room
c-s-c   c  Corridor			s  Stairs in corridor
+ | +   G  General Irchak's room	g  Guard room
G g P	P  Priest Xorlock's room


Middle floor

A T=S	A  Altar in temple		T  Throne room
| |	S  Room with portal Symbol	s  Stairs in corridor
t-a-M   t  Entrance to temple		M  Military room
  +	a  Antechamber
c-c-c   c  Corridor
|   |
E   E	E  Eyesockets


Bottom floor

M D C	M  Room of Murder and Blood	D  Room of Death and Decay
| | |   C  Room of Cruelty and Torture
j-s-j   j  Corridor, down to jaw	s Stairs in corridor
  |
  N	N  Nose


Jaw

J   J   J  The skull's lower jaw
|   |
J-J-J

*/


help "If you need help you shouldn't be here.&n"


/* ################################################################## */
/* ---------------------= DEFINITIONS =------------------------------ */
/* ################################################################## */


#define ACINA_QUEST_ONGOING	"Portal scroll quest ongoing"
#define ACINA_QUEST_FINISHED	"Portal scroll quest completed"
#define DEVIL_QUEST_ONGOING	"Dying devil's quest ongoing"
#define DEVIL_QUEST_FINISHED	"Dying devil's quest completed"

#define CMD_KISS	"kiss"
#define CMD_FRENCH	"french"
#define CMD_ROLL	"roll"
#define CMD_THROW	"throw"
#define CMD_JUMP	"jump"


#define BASE_GREATER_TANARRI(MLVL,ARMOUR,SEX) \
   sex SEX \
   race RACE_GREATER_DEMON \
   level MLVL \
   height 200 + MLVL \
   weight 350 + MLVL*2 \
   NATURAL_DEF(WPN_CLAW,ARMOUR)

#define BASE_LESSER_TANARRI(MLVL,ARMOUR,SEX) \
   sex SEX \
   race RACE_LESSER_DEMON \
   level MLVL \
   height 200 + MLVL \
   weight 250 + MLVL*2 \
   NATURAL_DEF(WPN_CLAW,ARMOUR)

#define LESSER_DEVIL(MLVL) \
   sex SEX_NEUTRAL \
   race RACE_LESSER_DEMON \
   level MLVL \
   height 150 + MLVL*5 \
   weight 200 + MLVL*5 \
   NATURAL_DEF(WPN_CLAW,ARM_PLATE) \
   MSET_ABILITY(15,15,20,20,15,5,5,5) \
   MSET_WEAPON(8,8,8,8,8,5) \
   MSET_SPELL(5,5,5,5,5,5,5,5,5,5,5) \

#define STYX_BOATMAN(MLVL) \
   BASE_GREATER_TANARRI(MLVL,ARM_PLATE,SEX_MALE) \
   MSET_ABILITY(15,15,20,15,15,8,6,6) \
   MSET_WEAPON(7,8,7,8,8,7) \
   MSET_SPELL(5,5,5,5,5,5,5,5,5,5,5) \

#define PARASITE(MLVL) \
   BASE_LESSER_TANARRI(MLVL,ARM_PLATE,SEX_MALE) \
   MSET_ABILITY(18,20,15,32,15,0,0,0) \
   MSET_WEAPON(7,7,7,7,28,0) \
   MSET_SPELL(4,4,4,4,4,4,4,4,4,4,4) \

#define VROCK(MLVL) \
   BASE_LESSER_TANARRI(MLVL,ARM_PLATE,SEX_NEUTRAL) \
   MSET_ABILITY(25,20,15,20,15,5,0,0) \
   MSET_WEAPON(7,7,7,7,21,0) \
   MSET_SPELL(5,4,4,4,4,5,5,5,5,5,5) \
   exp 105 \

#define BABAU(MLVL) \
   BASE_LESSER_TANARRI(MLVL,ARM_PLATE,SEX_NEUTRAL) \
   MSET_ABILITY(16,18,20,20,15,5,3,3) \
   MSET_WEAPON(8,8,8,4,21,0) \
   MSET_SPELL(5,4,4,4,4,5,5,5,5,5,5) \
   exp 105 \

#define NABASSU(MLVL) \
   BASE_LESSER_TANARRI(MLVL,ARM_PLATE,SEX_NEUTRAL) \
   MSET_ABILITY(22,22,10,26,15,5,0,0) \
   MSET_WEAPON(7,7,7,7,21,0) \
   MSET_SPELL(5,4,4,4,4,5,5,5,5,5,5) \
   NATURAL_DEF(WPN_CRUSH,ARM_PLATE) \
   exp 100 \

#define DRETCH(MLVL) \
   BASE_LESSER_TANARRI(MLVL,ARM_PLATE,SEX_NEUTRAL) \
   MSET_ABILITY(25,20,15,20,15,5,0,0) \
   MSET_WEAPON(7,7,7,7,21,0) \
   MSET_SPELL(5,4,4,4,4,5,5,5,5,5,5) \
   exp 100 \

#define DEATH_SPIRIT(MLVL) \
   BASE_GREATER_TANARRI(MLVL,ARM_PLATE,SEX_NEUTRAL) \
   MSET_ABILITY(20,15,10,15,15,10,15,0) \
   MSET_WEAPON(10,10,7,7,10,6) \
   MSET_SPELL(4,4,4,4,4,4,4,4,4,10,4) \
   exp 120 \
   NATURAL_DEF(WPN_CRUSH,ARM_PLATE) \
   dilcopy combat_mag@function("toxicate","",0,10);

#define MURDER_SPIRIT(MLVL) \
   BASE_GREATER_TANARRI(MLVL,ARM_PLATE,SEX_NEUTRAL) \
   MSET_ABILITY(15,25,15,15,15,10,3,2) \
   MSET_WEAPON(10,10,10,8,10,8) \
   MSET_SPELL(4,4,4,4,4,4,4,4,4,4,4) \
   NATURAL_DEF(WPN_CRUSH,ARM_PLATE) \
   exp 120 \

#define CRUELTY_SPIRIT(MLVL) \
   BASE_GREATER_TANARRI(MLVL,ARM_PLATE,SEX_NEUTRAL) \
   MSET_ABILITY(15,15,15,15,15,10,15,0) \
   MSET_WEAPON(10,10,7,7,10,6) \
   MSET_SPELL(4,4,4,4,4,4,4,4,10,4,4) \
   exp 120 \
   NATURAL_DEF(WPN_CRUSH,ARM_PLATE) \
   dilcopy combat_mag@function("lightning bolt","",0,1);

#define ABYSSAL_LORD(MLVL,SEX) \
   BASE_GREATER_TANARRI(MLVL,ARM_PLATE,SEX) \
   MSET_ABILITY(15,15,15,15,15,10,10,5) \
   MSET_WEAPON(10,10,7,7,10,6) \
   MSET_SPELL(4,4,4,4,4,4,5,5,6,5,5) \
   exp 130 \
   dilcopy combat_mag@function("lightning bolt","",0,1);

/* ---------- EXTRAS ---------- */

#define CHAIN_EXTRA \
   extra {"chains","chain"} \
"The chains are wrought of cold looking black steel. As you look closer \
you see there are runes scratched onto the seperate links which are oval \
loops of 3 foot thick metal." \
   extra {"runes","rune"} \
"These are wicked and pointy looking runes. They might even allow you some \
grip when traveling along these chains." \
   extra {"skull","palace","fortress"} \
"The skull looks even bigger from here than it did from the edge of the \
pit. You are looking at it's left side." \
   extra {"pit","dark pit"} \
"You see only darkness below you." \
   extra {"down"} \
"*EEK*" \

#define ASH_EXTRA \
   extra {"ash","ground","soil"} \
"The ground seems to be made out of a strange mixture of ashes and \
charcoal." \
   extra {"blood red sky","sky"} \
"No sun lights it although some form of light emenates from it." \

#define BATTLE_EXTRA \
   extra {"ground","rock","sand"} \
"The ground is rocky, but at some places a thin layer of compact sand \
covers it. Small leafless bushes grow from it or from cracks in the rocky \
surface." \
   extra{"bushes","bush"} \
"The bushes are devoid of leaves and look to be dead. You wonder how they \
got to grow in this desolate environment in the first place." \
   extra {"blood red sky","sky"} \
"No sun lights it although some form of light emenates from it." \

/* ################################################################## */
/* -----------------------= DIL SECTION =---------------------------- */
/* ################################################################## */

%dil


/*
   Effect dil for damge dil on the Enforcer of Entropy
*/

dilbegin entropy_eff(medi : unitptr,targ : unitptr,hm : integer);

code {

   act("You scream with evil rage as you &crCLEAVE&cw $3n!",
      A_ALWAYS,self,null,targ,TO_CHAR);
   act("$1n screams with evil rage as $1e &crCLEAVES&cw you!",
      A_SOMEONE,self,null,targ,TO_VICT);
   act("$1n screams with evil rage as $1e &crCLEAVES&cw $3n!",
      A_SOMEONE,self,null,targ,TO_NOTVICT);
   return;

}
dilend /* entropy_eff */


/*
   Next dil is an effect for the berserk dil on the Enforcer of Entopy
*/

dilbegin ent_bers_eff(medi : unitptr, targ : unitptr, hm : integer);

code {

   act("The evil chaos of your &crEnforcer of Entropy&cw enters your mind.",
      A_ALWAYS,self,null,targ,TO_CHAR);
   act("The evil chaos of $1n's &crEnforcer of Entropy&cw enters $1s mind.",
      A_SOMEONE,self,null,targ,TO_REST);
   act("You go berserk!",A_ALWAYS,self,null,targ,TO_CHAR);
   act("$1n goes berserk!",A_SOMEONE,self,null,targ,TO_REST);
   return;

}
dilend /* ent_bers_eff */

/*
   The following dil blocks all commands when copied on a player
*/

dilbegin block_all();

code {

:start:
   wait(SFB_CMD,TRUE);
   block;
   goto start;

}
dilend /* block_all */


/*
   The following dil is copied onto a player if he/she falls into the pit
   below the skull fortress. If they jump or are thrown out of the skull's
   eyesockets. Or if they slip and fall of the chains leading to the
   fortress or the skull's lower jaw.
*/

dilbegin recall fall_seq(destination : string);

var
   randest	: unitptr;

code {

:start:
   heartbeat := PULSE_SEC*4;
   act("Biting cold wind stings in your eyes as you fall down into the "+
      "pit.",A_ALWAYS,self,null,null,TO_CHAR);
   pause;
   act("Darkness starts to envelop you as you plummet down. Deeper and "+
      "deeper.",A_ALWAYS,self,null,null,TO_CHAR);
   pause;
   act("You feel yourself being caught by some sort of web.",
       A_ALWAYS,self,null,null,TO_CHAR);
   pause;
   act("It stretches until you come to a complete stop.",
       A_ALWAYS,self,null,null,TO_CHAR);
   pause;
   act("Just as you expect it to catapult you back up you hear a loud "+
      "snap.",A_ALWAYS,self,null,null,TO_CHAR);
   if (destination=="random")
   {
   :ran_room:
      randest := findrndunit(self,FIND_UNIT_WORLD,UNIT_ST_ROOM);
      if (isset(randest.flags,UNIT_FL_NO_TELEPORT))
      {
         goto ran_room;
      }
      link(self,randest);
   }
   else
   {
      link(self,findroom(destination));
   }
   pause;
   act("You rub your sore bottom as you fall to the ground somewhere else.",
      A_ALWAYS,self,null,null,TO_CHAR);
   act("Suddenly a portal opens overhead.",A_ALWAYS,self,null,null,TO_REST);
   pause;
   act("$1n rubs $1s sore bottom after $1e falls through the portal to "+
      "the floor.",A_ALWAYS,self,null,null,TO_REST);
   exec("look",self);
   pause;
   quit;

}
dilend /* fall_seq */


/*
   Players can throw players out of the skull fortress' eyesockets
*/

dilbegin throw_pc(destination : string);
var
   thrower	: unitptr;
   victim	: unitptr;
   result	: integer;

code {

:init:
   heartbeat := PULSE_SEC*1;
:start:
   wait(SFB_CMD,command(CMD_THROW) and ("out" in argument));
   thrower := activator;
   victim := findunit(activator,getword(argument),FIND_UNIT_SURRO,null);
   if (victim.type==UNIT_ST_NPC)
   {
      block;
      exec("emote becomes pissed at you!",victim);
      exec("kill "+thrower.name,victim);
      goto start;
   }
   block;
   if (victim == thrower) {
      act("You can't throw yourself out!",
         A_ALWAYS,thrower,null,null,TO_CHAR);
      goto start;
   }
   if (victim != null) {
      secure(victim,lost_victim);
      dilcopy("block_all@abyss1",victim);
      act("$2n picks you up and throws you out of the socket!",
         A_ALWAYS,victim,thrower,null,TO_CHAR);
      act("You pick $2n up and throw $2m out of the socket!",
         A_ALWAYS,thrower,victim,null,TO_CHAR);
      act("$1n picks $3n up and throws $3m out of the socket!",
         A_ALWAYS,thrower,null,victim,TO_NOTVICT);
      act("You scream in terror before disappearing over the edge!",
         A_ALWAYS,victim,null,null,TO_CHAR);
      act("$1n screams in terror before disappearing over the edge!",
         A_ALWAYS,victim,null,null,TO_REST);
      pause;
      link(victim,findroom("fall_room@abyss1"));
      result := dildestroy("block_all@abyss1",victim);
      dilcopy("fall_seq@abyss1("+destination+")",victim);
      unsecure(victim);
   }
   goto start;

:lost_victim:
   unsecure(victim);
   goto start;

}
dilend /* throw_pc */


/*
   Players can jump out of the skull fortress' eyesockets
*/

dilbegin jump_pc(destination : string);
var
   jumper	: unitptr;
   result	: integer;

code {

:init:
   heartbeat := PULSE_SEC*1;
:start:
   wait(SFB_CMD,command(CMD_JUMP) and ("out" in argument));
   jumper := activator;
   block;
   secure(jumper,lost_jumper);
   dilcopy("block_all@abyss1",jumper);
   act("You jump out of the socket!",A_ALWAYS,jumper,null,null,TO_CHAR);
   act("$1n jumps out of the socket!",A_SOMEONE,jumper,null,null,TO_REST);
   act("You scream in terror before disappearing over the edge!",
      A_ALWAYS,jumper,null,null,TO_CHAR);
   act("$1n screams in terror before disappearing over the edge!",
      A_SOMEONE,jumper,null,null,TO_REST);
   pause;
   link(jumper,findroom("fall_room@abyss1"));
   result := dildestroy("block_all@abyss1",jumper);
   dilcopy("fall_seq@abyss1("+destination+")",jumper);
   unsecure(jumper);
   goto start;

:lost_jumper:
   unsecure(jumper);
   goto start;

}
dilend /* jump */


/*
   Dil routine copied onto rooms that players can fall out off (on the
   chains or the jaw) Chances of falling can be passed for high (>100),
   medium (50-100) and low dexterity (<50)
*/

dilbegin fall(high : integer,med:integer,low : integer);
var
   pc		: unitptr;
   chance	: integer;
   ranvalue	: integer;
   destination  : string;

code {

:init:
   destination := "random";
:start:
   wait(SFB_CMD,command(CMD_NORTH) or
		command(CMD_EAST) or
		command(CMD_SOUTH) or
		command(CMD_WEST));
   pc := activator;
   if (pc.type != UNIT_ST_PC) goto start;
   if (pc.abilities[ABIL_DEX] > 100)
   {
      chance := high;
   }
   else
   {
      if (pc.abilities[ABIL_DEX] >50)
      {
         chance := med;
      }
      else
      {
         chance := low;
      }
   }
   ranvalue := rnd(1,100);
   if (ranvalue <= chance)
   {
      block;
      act("You slip and fall off!",A_ALWAYS,pc,null,null,TO_CHAR);
      act("$1n slips and falls off into the pit!",
         A_ALWAYS,pc,null,null,TO_REST);
      link(pc,findroom("fall_room@abyss1"));
      dilcopy("fall_seq@abyss1("+destination+")",pc);
   }

}
dilend /* fall */


/*
   Affect dil for when a player sits down on Goruk's throne and gets
   electrocuted
*/

dilbegin throne_effect(medi : unitptr, targ : unitptr, hm : integer);

code {

	act("Spasms wrack your body as lightning crackles all around you.",
	   A_ALWAYS,targ,null,targ,TO_VICT);
	act("You scream in agony!",A_ALWAYS,targ,null,targ,TO_VICT);
	act("Lightning crackles around $3n sending spasms through $3s "+
           "body.",A_SOMEONE,targ,null,targ,TO_NOTVICT);
	act("$3n screams in agony!",A_ALWAYS,targ,null,targ,TO_NOTVICT);
	return;

}
dilend /* throne_effect */


/*
   For the two rooms that contain a symbol that can be entered
   The players will be linked to the other symbol room
*/

dilbegin symbol_enter(destination : string);
var
   pc		: unitptr;

code {
:start:
   heartbeat := PULSE_SEC*1;
   wait(SFB_CMD,command(CMD_ENTER) and ("symbol" in argument));
   block;
   pc := activator;
   secure(pc,lost_pc);
   act("$1n steps onto the symbol into the red swirling tornado.",
      A_ALWAYS,pc,null,null,TO_REST);
   act("You see the flesh being torn from $1s body by some unseen "+
      "force, then $1e is gone.",A_ALWAYS,pc,null,null,TO_REST);
   link(pc,findroom("abyssal_void@abyss1"));
   dilcopy("symbol_seq@abyss1("+destination+")",pc);
   unsecure(pc);
   pause;
   goto start;

:lost_pc:
   unsecure(pc);
   goto start;

}
dilend /* symbol_enter */


/*
   Dil copied onto a player that shows the player the sequence of acts
   when they enter one of the symbols (see above dil)
*/

dilbegin recall symbol_seq(destination : string);

code {

:start:
   heartbeat := PULSE_SEC*3;
   act("You feel the flesh being torn from your bones by some unseen "+
      "force.",A_ALWAYS,self,null,null,TO_CHAR);
   pause;
   act("You are somewhere and nowhere at the same time.",
      A_ALWAYS,self,null,null,TO_CHAR);
   pause;
   link(self,findroom(destination));
   act("You feel better as you feel your flesh reforming again.",
      A_ALWAYS,self,null,null,TO_CHAR);
   pause;
   exec("look",self);
   quit;

}
dilend /* symbol_seq */


/*
   This dil blocks disarm on the owner
*/

dilbegin no_disarm();

var
   pc	: unitptr;

code {

:init:
   heartbeat := PULSE_SEC*3;
:start:
   wait(SFB_CMD,command(CMD_DISARM));
   pc := activator;
   secure(pc,lost_pc);
   if (findunit(activator,argument,FIND_UNIT_SURRO,null)==self)
   {
      block;
      exec("emote tightens the grip on his weapon.",self);
      exec("moo "+pc.name,self);
      goto start;
   }
   goto start;


:lost_pc:
   unsecure(pc);
   exec("snicker",self);
   goto start;

}
dilend /* no_disarm */

/*
   The dil eat_given makes the mob destroy items given to him.
   This is to prevent burning by oposite alignment items.
*/

dilbegin eat_given();

var
   pc	: unitptr;

code {

:init:
   heartbeat := PULSE_SEC*3;
:start:
   wait(SFB_DONE,(command(CMD_GIVE)) and (self==target));
   pc := activator;
   secure(pc,lost_pc);
   destroy(medium);
   exec("emote utters the words 'kragh pouder' and the "+medium.name+
      " crumbles to dust.",self);
   exec("moo "+pc.name,self);
   goto start;

:lost_pc:
   unsecure(pc);
   exec("snicker",self);
   goto start;

}
dilend /* eat_given */


dilbegin give_move();

external
   string dirstring@function(dr : integer);
   integer rev_dir@function(i : integer);

var
   i 		: integer;
   n		: integer;
   dir  	: integer;
   dest		: unitptr;
   here		: unitptr;
   time 	: string;
   heart 	: integer;
   ts		: string;

code {

:init:
   heartbeat := PULSE_SEC*5;
   i := interrupt(SFB_CMD,command("stop"),stop);

:start:
   wait(SFB_CMD,command("hop"));
   time := argument;
   block;
   if (activator.level < GOD_LEVEL)
   {
      act("$1n exclaims 'You're not a god! I won't listen to you "+
         activator.name+"!'",A_SOMEONE,self,null,null,TO_ALL);
      goto start;
   }

   if (time != "")
   {
      heart := atoi(getword(time));
      if (heart < 5) heart := 5;
   }
   else heart := 10;

   act("$1n exclaims 'You got it boss, I'm moving every "+itoa(heart)+
      " seconds!'",
      A_SOMEONE,self,null,null,TO_ALL);
   heart := PULSE_SEC*heart;
:moving:
   wait(SFB_TICK, TRUE);

   n := 0;  /* initilize loop counter, to prevent dil destroy */
:get_dir:
   heartbeat := 3;
   dir := rnd(0,5);
   here := self.outside;
   dest := self.outside.exit_to[dir];

   if ((dest == null) or
       (isset(dest.flags, UNIT_FL_NO_MOB)) or
       (dest.movement == SECT_WATER_SWIM) or
       (dest.movement == SECT_WATER_SAIL) or
       (dest.movement == SECT_UNDER_WATER))
   {
      n := n + 1;
      if (n > 20)
      {
         n := 0;
         pause;
      }
      goto get_dir;
   }
   heartbeat := PULSE_SEC*heart;

   if (isset (self.outside.exit_info[dir], EX_CLOSED))
   {
      act("$1n miraculously hops through the "+
         here.exit_names[dir].[0]+"!",
         A_SOMEONE,self,null,null,TO_ALL);
      link(self,dest);
      act("$1n miraculously hops into this room through the "+
         here.exit_names[dir].[0]+"!",
         A_SOMEONE,self,null,null,TO_ALL);
      goto moving;
   }
   ts := dirstring@function(dir);
   act("$1n hops away "+ts+".",
      A_SOMEONE,self,null,null,TO_ALL);
   link(self,dest);
   dir := rev_dir@function(dir);
   ts := dirstring@function(dir);
   act("$1n hops in from the "+ts+".",
      A_SOMEONE,self,null,null,TO_ALL);
   goto moving;

:stop:
   block;
   if (activator.level < GOD_LEVEL)
   {
      act("$1n exclaims 'You're not a god! I won't listen to you "+
         activator.name+"!'",A_SOMEONE,self,null,null,TO_ALL);
      goto moving;
   }
   act("$1n exclaims 'Okay, you're the boss! I have stopped!'",
      A_SOMEONE,self,null,null,TO_ALL);
   goto start;

}
dilend /* give_move */


dilbegin recall foozle_destroy();

var
   i		: integer;
   lspan	: integer;
   lifestring	: string;

code {

:init:
   i := interrupt(SFB_CMD,command("lspan"),changelife);
   lspan := 120; /* 2 hours for normal foozle */
:start:
   self.value[1] := lspan;
   heartbeat := PULSE_SEC*20; /* first tick tends to come fast */
   pause;
:loop:
   heartbeat := PULSE_SEC*60;
   wait(SFB_TICK,TRUE);
   self.value[1] := self.value[1] - 1;
   if (self.value[1] < 1)
   {
      heartbeat := PULSE_SEC;
      if (self.outside.type != UNIT_ST_ROOM)
      {
         sendtext("A quest foozle expires with a small peep.&n",self.outside);
      }
      else
      {
         act("$1n expires with a small peep.",
            A_SOMEONE,self,null,null,TO_ALL);
      }
      pause;
      destroy(self);
   }
   goto loop;

:changelife:
   block;
   if (activator.level < GOD_LEVEL)
   {
      if (self.outside.type != UNIT_ST_ROOM)
      {
         sendtext("A foozle exclaims 'You are not a god! I won't listen to "+
            "you "+activator.name+"!'&n",activator);
         goto start;
      }
      else
      {
         act("$1n exclaims 'You're not a god! I won't listen to you "+
            activator.name+"!'",A_SOMEONE,self,null,null,TO_ALL);
         goto start;
      }
   }
   lifestring := getword(argument);
   if (lifestring == "") goto report;
   lspan := atoi(lifestring);
   if (lspan < 1)
   {
      lspan := 1;
   }
   self.value[1] := lspan;
      if (self.outside.type != UNIT_ST_ROOM)
      {
         sendtext("A foozle exclaims 'Okay, you're the boss! Lifespan "+
            "changed to "+itoa(lspan)+" minutes!'&n",activator);
         goto start;
      }
      else
      {
         act("$1n exclaims 'Okay, you're the boss! Lifespan changed to "+
            itoa(lspan)+" minutes!'",A_SOMEONE,self,null,null,TO_ALL);
         goto start;
      }

:report:
   act("$1n exclaims 'I have "+itoa(lspan)+ "mudminutes of life "+
      "left Boss!",A_SOMEONE,self,null,null,TO_ALL);
   goto start;

}
dilend /* foozle_destroy */


dilbegin foozle_happy();

var
   i	: integer;

code {

:init:
   self.value[2] := 6;
:start:
   heartbeat := PULSE_SEC*3;
   i := interrupt(SFB_CMD,(command("stroke") or
                           command("ruffle") or
                           command("snuggle")) and
                          ("foozle" in argument),happy);
   pause;
:loop:
   heartbeat := PULSE_SEC*60;
   wait(SFB_TICK,TRUE);
   if (self.value[2] > 0)
   {
      self.value[2] := self.value[2] - 1;
   }
   goto loop;

:happy:
   block;
   self.value[2] := 10;
   if (self.outside.type != UNIT_ST_ROOM)
   {
      sendtext("A foozle purrs contently.&n",activator);
      goto loop;
   }
   else
   {
      act("A foozle purrs contently.",A_SOMEONE,self,null,null,TO_ALL);
      goto loop;
   }
   goto loop;

}
dilend /* foozle_happy */


dilbegin give_tricky();

var
   i 		: integer;
   container	: unitptr;
   contname	: string;

code {

:init:
   heartbeat := PULSE_SEC*5;
   i := interrupt(SFB_CMD,command("nice"),stop);

:start:
   wait(SFB_CMD,command("tricky"));
   block;
   if (activator.level < GOD_LEVEL)
   {
      act("$1n exclaims 'You're not a god! I won't listen to you "+
         activator.name+"!'",A_SOMEONE,self,null,null,TO_ALL);
      goto start;
   }
   act("$1n exclaims 'You got it boss, I'm playing hard to get!'",
      A_SOMEONE,self,null,null,TO_ALL);
   heartbeat := PULSE_SEC*10;
   self.value[3] := 1;

:tricky:
   wait(SFB_TICK, TRUE);
   container := self.outside;
   contname := self.outside.name;
   if ((self.value[3] == 1) and
       (self.value[2] < 1) and
       (container.type != UNIT_ST_ROOM))
   {
      link(self,container.outside);
      if ((container.type == UNIT_ST_PC) or (container.type == UNIT_ST_NPC))
      {
         act("$1n emerges from "+contname+".",
            A_SOMEONE,self,null,self.outside,TO_ALL);
         act("$1n exlaims 'Sorry but I have my orders "+container.name+".",
            A_SOMEONE,self,null,container,TO_ALL);
      }
   }
   goto tricky;

:stop:
   block;
   if (activator.level < GOD_LEVEL)
   {
      act("$1n exclaims 'You're not a god! I won't listen to you "+
         activator.name+"!'",A_SOMEONE,self,null,null,TO_ALL);
      goto tricky;
   }
   act("$1n exclaims 'Okay, you're the boss! I won't be tricky now!'",
      A_SOMEONE,self,null,null,TO_ALL);
   self.value[3] := 0;
   goto start;

}
dilend /* give_tricky */



dilbegin pfoozle_box(pet_passed :string);

var
   pc		: unitptr;
   pet		: unitptr;
   petname	: string;
   petcolor	: string;

code {

:init:
   heartbeat := PULSE_SEC*3;
:start:
   wait(SFB_CMD,command("open"));
   if (findunit(activator, argument,FIND_UNIT_INVEN|FIND_UNIT_SURRO,null) != self)
      goto start;
   priority;
   pc := activator;
   secure(pc,lostowner);
   pet := load(pet_passed);
   secure(pet,lostpet);
   link(pet,self.inside);
   pause;

:getname:
   act("When you take a peek inside the box you see a cute "+
      "Prize Foozle. Since it will be yours you must give it a name "+
      "according to tradition. Just 'say' its name and it will be yours.",
       A_SOMEONE,pc,null,null,TO_CHAR);

   wait(SFB_CMD,(command(CMD_SAY)) and (activator == pc));

:named:
   block;
   petname := argument;
   act("Your Foozle will now listen to you if you call it by its special "+
      "name '"+petname+"'. Please be very careful with it since people "+
      "it can still pick it up using its original name.",
      A_SOMEONE,pc,null,null,TO_CHAR);
   act("Is this name right? NOD if it is or SHAKE your head otherwise.",
      A_SOMEONE,pc,null,null,TO_CHAR);
   wait(SFB_DONE,(command(CMD_NOD)) or (command(CMD_SHAKE)));
   if (command(CMD_SHAKE)) goto getname;
   addstring(pet.names,petname);

:color:
   act("Now you have to pick a color for your Prize Foozle. It can be "+
      "either &crred&cw, &cbblue&cw, &c+yyellow&cw, &cggreen&cw or "+
      "&cmpurple&cw. Just 'say <color>' and it will be that color from "+
      "then on.",A_SOMEONE,pc,null,null,TO_CHAR);

   wait(SFB_CMD,(command(CMD_SAY)) and (activator == pc));

   block;
   petcolor := argument;
   if (petcolor =="red")
   {
      petcolor := "&crRed&cw";
      goto colored;
   }
   if (petcolor =="blue")
   {
      petcolor := "&cbBlue&cw";
      goto colored;
   }
   if (petcolor =="yellow")
   {
      petcolor := "&c+yYellow&cw";
      goto colored;
   }
   if (petcolor =="green")
   {
      petcolor := "&cgGreen&cw";
      goto colored;
   }
   if (petcolor =="purple")
   {
      petcolor := "&cmPurple&cw";
      goto colored;
   }
   act("That is not a valid color.",A_SOMEONE,pc,null,null,TO_CHAR);
   goto color;

:colored:
   act("Your Foozle is now "+petcolor+".",
      A_SOMEONE,pc,null,null,TO_CHAR);
   act("Is this color right? NOD if it is or SHAKE your head otherwise.",
      A_SOMEONE,pc,null,null,TO_CHAR);
   wait(SFB_DONE,(command(CMD_NOD)) or (command(CMD_SHAKE)));
   if (command(CMD_SHAKE)) goto color;

   pet.title := "&cwa "+petcolor+ " Prize Foozle";
   pet.outside_descr := "&cw"+pc.name+"'s "+petcolor+" Furry Fuzzy Prize "+
      "Foozle happily hops around here.";
   addextra(pet.extra,{""},"This Foozle is a special one that very rare "+
      "and is given to winners of quests. It is actually nothing more "+
      "than a small ball that is just big enough to fill your hand. It "+
      "is covered with soft fur that is "+petcolor+" in color and it has two "+
      "small eyes that are even cuter than those of a puppy. A little "+
      "mouth that seems to be fixed in a constant smile makes it "+
      "complete. It loves its owner dearly, but is rather shy towards "+
      "others.");
   exec("exit",pet);
   dilcopy("pet_base@hobgob("+pc.name+")",pet);
   dilcopy("pfoozle_act@abyss1("+pc.name+")",pet);
   dilcopy("pfoozle_tricky@abyss1("+pc.name+")",pet);
   nopriority;
   quit;

:lostowner:
   quit;

:lostpet:
   quit;

}
dilend /* pfoozle_box */


dilbegin pfoozle_act(pname : string);

var
   owner 	: string;
   rndplayer	: unitptr;
   player	: string;
   i		: integer;
   j		: integer;
   container	: unitptr;
   contname	: string;
   ownerptr	: unitptr;
   tempstr	: string;

code {

:init:
   heartbeat := PULSE_SEC*15;
   owner := pname;
   i := interrupt(SFB_TICK|SFB_CMD,(self.outside.type != UNIT_ST_ROOM) and
                                   (owner != self.outside.name) and
				   (owner != self.outside.outside.name) and
				   ("corpse of "+owner != self.outside.name),
                                    get_out);
   exec("hail "+owner,self);

:start:
   pause;
   wait (SFB_DONE,(activator.type == UNIT_ST_PC));

   if (self.outside.type != UNIT_ST_ROOM) goto start;

   rndplayer := findrndunit(self,FIND_UNIT_SURRO,UNIT_ST_PC);
   player := rndplayer.name;

   on rnd(0,51) goto aa,ab,ac,ad,ae,af,ag,ah,ai,aj,ak,al,am,an,ao,ap,aq,ar,
      as,at,au,av,aw,ax,ay,az,ba,bb,bc,bd,be,bf,bg,bh,bi,bj,bk,bl,bm,bn,bo,
      bp,bq,br,bs,bt,bu,bv,bw,bx,by,bz;
:aa:
   exec("bounce",self);
   goto done;
:ab:
   exec("giggle",self);
   goto done;
:ac:
   exec("zigzag",self);
   goto done;
:ad:
   exec("hiccup",self);
   goto done;
:ae:
   exec("jump",self);
   goto done;
:af:
   exec("rofl",self);
   goto done;
:ag:
   exec("iwhistle",self);
   goto done;
:ah:
   exec("chuckle",self);
   goto done;
:ai:
   exec("cackle",self);
   goto done;
:aj:
   exec("strut",self);
   goto done;
:ak:
   exec("somersault",self);
   goto done;
:al:
   exec("boggle",self);
   goto done;
:am:
   exec("eyeball",self);
   goto done;
:an:
   exec("cheer",self);
   goto done;
:ao:
   exec("nuzzle "+owner,self);
   goto done;
:ap:
   exec("say I love "+owner+"!",self);
   goto done;
:aq:
   exec("lick "+player,self);
   goto done;
:ar:
   exec("snicker",self);
   goto done;
:as:
   exec("respect",self);
   goto done;
:at:
   exec("respect "+owner,self);
   goto done;
:au:
   exec("emote does the Foozle dance!",self);
   goto done;
:av:
   exec("snuggle "+owner,self);
   goto done;
:aw:
   exec("smile "+player,self);
   goto done;
:ax:
   exec("smile",self);
   goto done;
:ay:
   exec("emote sneezes and curses the dust in here.",self);
   goto done;
:az:
   exec("emote chants 'Foozles Rock!",self);
   goto done;
:ba:
   exec("flipflop",self);
   goto done;
:bb:
   exec("bonk "+player,self);
   goto done;
:bc:
   exec("kiss "+owner,self);
   goto done;
:bd:
   exec("moo",self);
   goto done;
:be:
   exec("drool",self);
   goto done;
:bf:
   exec("drool "+player,self);
   goto done;
:bg:
   exec("hail "+player,self);
   goto done;
:bh:
   exec("hail",self);
   goto done;
:bi:
   exec("salute "+player,self);
   goto done;
:bj:
   exec("burp",self);
   goto done;
:bk:
   exec("burp",self);
   goto done;
:bl:
   exec("nibble "+owner,self);
   goto done;
:bm:
   exec("purr",self);
   goto done;
:bn:
   exec("wiggle",self);
   goto done;
:bo:
   exec("emote starts spinning around and then almost dizzily rolls out "+
      "of the room.",self);
   goto done;
:bp:
   exec("emote bounces up and down chanting 'Foozles Rule!'",self);
   goto done;
:bq:
   exec("emote blinks at "+player+" with its puppy eyes.",self);
   goto done;
:br:
   exec("tongue "+player,self);
   goto done;
:bs:
   exec("say I wanna join a Foozle clan!",self);
   goto done;
:bt:
   exec("bark",self);
   goto done;
:bu:
   exec("herald "+owner,self);
   goto done;
:bv:
   exec("zigzag "+player,self);
   goto done;
:bw:
   exec("secret "+owner,self);
   goto done;
:bx:
   exec("greet "+player,self);
   goto done;
:by:
   exec("emote laughs THE evil Foozle laugh. FOOHAHAhahaha..." ,self);
   goto done;
:bz:
   exec("say Shouldn't you be out doing a quest "+player+"?",self);
   goto done;
:done:
  pause;
  goto start;

:get_out:
   container := self.outside;
   contname := self.outside.name;
   link(self,container.outside);
   if (container.outside.type == UNIT_ST_ROOM)
   {
      act("$1n emerges from "+contname+".",
         A_SOMEONE,self,null,self.outside,TO_ALL);
      tempstr := owner;
      ownerptr := findunit(self,tempstr,FIND_UNIT_WORLD,null);
      log("Prize Foozle : Owner = "+ownerptr.name);
      act("$1n utters the words 'Sanctuarius "+owner+"'",
         A_SOMEONE,self,null,self.outside,TO_ALL);
      act("$1n implodes in a puff of multicolored smoke.",
         A_SOMEONE,self,null,self.outside,TO_ALL);
      link(self,ownerptr);
   }
   goto start;

}
dilend /* pfoozle_act */


dilbegin recall boat_unfolded(pname : string,cword : string);

var
   cmdword 	: string;
   owner   	: string;
   ownerptr	: unitptr;
   i		: integer;
   foldboat	: unitptr;

code {

:init:
   heartbeat := PULSE_SEC*60;
   owner := pname;
   cmdword := cword;
   i := interrupt(SFB_CMD,command(CMD_SAY) or command(CMD_WHISPER),action);
:start:
   wait(SFB_TICK,TRUE);
/*
   if (self.outside.type != UNIT_ST_ROOM)
   {
      ownerptr := findunit(self,owner,FIND_UNIT_WORLD,null);
      log("UnFolded Boat / Not room - Owner : "+ownerptr.name);
      if (ownerptr == null)
         goto no_owner;
      else
         goto found_owner;
   }
   else
   {
      ownerptr := findunit(self,owner,FIND_UNIT_WORLD,null);
      log("UnFolded Boat / Is room - Owner : "+ownerptr.name);
      if (ownerptr == null)
         goto no_owner;
      if (not((ownerptr.outside == self) or
              (ownerptr.outside == self.outside)))
      {
         if (self.value[1] < 1)
            goto found_owner;
         else
            self.value[1] := self.value[1] - 1;
      }
      else
         self.value[1] := 5;
   }
   goto start;

:no_owner:
   log("UnFolded Boat / No Owner");
   foldboat := load("folded_boat@abyss1");
   secure(foldboat,lost_boat);
   dilcopy("boat_folded@abyss1("+owner+","+cmdword+")",foldboat);
   foldboat.value[1] := 0;
   act("$1n magically folds itself up into a packet of wood.",
      A_ALWAYS,self,null,null,TO_ALL);
   if (self.inside != null)
      act("The contents are spilled out in the process.",
         A_ALWAYS,self,null,null,TO_ALL);
   while (self.inside != null) link(self.inside,self.outside);
   act("$1n disappears in a flash of light!",
      A_ALWAYS,self,null,null,TO_ALL);
   link(foldboat,findroom("void@basis"));
   unsecure(foldboat);
   destroy(self);
   quit;

:found_owner:
   log("UnFolded Boat / Found Owner");
   foldboat := load("folded_boat@abyss1");
   secure(foldboat,lost_boat);
   dilcopy("boat_folded@abyss1("+owner+","+cmdword+")",foldboat);
   foldboat.value[1] := 5;
   act("$1n magically folds itself up into a packet of wood.",
      A_ALWAYS,self,null,null,TO_ALL);
   if (self.inside != null)
      act("The contents are spilled out in the process.",
         A_ALWAYS,self,null,null,TO_ALL);
   while (self.inside != null) link(self.inside,self.outside);
   act("$1n disappears in a flash of light!",
      A_ALWAYS,self,null,null,TO_ALL);
   link(foldboat,ownerptr);
   sendtext("$1n magically appears in your inventory.&n",ownerptr);
   unsecure(foldboat);
   destroy(self);
   quit;
*/
   goto start; /* only since shit above don't work. Fucking findunit */

:action:
   if ((activator.name != owner) or (not(cmdword in argument)))
      goto start;
   block;
   foldboat := load("folded_boat@abyss1");
   secure(foldboat,lost_boat);
   dilcopy("boat_folded@abyss1("+owner+","+cmdword+")",foldboat);
   foldboat.value[1] := 5;
   act("$1n softly whispers a command word to $3n.",
      A_SOMEONE,activator,null,self,TO_REST);
   act("You softly whisper the command word.",
      A_ALWAYS,activator,null,self,TO_CHAR);
   act("$1n magically folds itself up into a packet of wood.",
      A_ALWAYS,self,null,null,TO_ALL);
   if (self.inside != null)
   {
      while (self.inside != null) link(self.inside,self.outside);
      act("The contents are spilled out in the process.",
         A_ALWAYS,self,null,null,TO_ALL);
   }
   link(foldboat,activator);
   act("You pick up the packet of wood and put it away.",
      A_ALWAYS,activator,null,self,TO_CHAR);
   act("$1n picks up the packet of wood and puts it away.",
      A_ALWAYS,activator,null,self,TO_REST);
   unsecure(foldboat);
   destroy(self);
   quit;

:lost_boat:
   unsecure(foldboat);
   goto start;

}
dilend /* boat_unfolded */


dilbegin recall boat_folded(pname : string,cword : string);

var
   cmdword 	: string;
   owner   	: string;
   ownerptr	: unitptr;
   i		: integer;
   unfoldboat	: unitptr;

code {

:init:
   heartbeat := PULSE_SEC*60;
   owner := pname;
   cmdword := cword;
   i := interrupt(SFB_CMD,command(CMD_SAY) or command(CMD_WHISPER),action);
:start:
   wait(SFB_TICK,TRUE);
/*
   if ((owner != self.outside.name) and
       (owner != self.outside.outside.name))
   {
      if (self.outside.type != UNIT_ST_ROOM)
      {
         ownerptr := findunit(self,owner,FIND_UNIT_WORLD,null);
         if (ownerptr == null)
            goto no_owner;
         else
            goto found_owner;
      }
      else
      {
         ownerptr := findunit(self,owner,FIND_UNIT_WORLD,null);
         if (ownerptr == null)
            goto no_owner;
         if (not(ownerptr.outside == self.outside))
         {
            if (self.value[1] < 1)
               goto found_owner;
            else
               self.value[1] := self.value[1] - 1;
         }
         else
         {
            self.value[1] := 5;
            goto start;
         }
      }
   }
   else
      self.value[1] := 5;
   goto start;

:no_owner:
   self.value[1] := 0;
   act("$1n disappears in a flash of light!",
      A_ALWAYS,self,null,null,TO_ALL);
   link(self,findroom("void@basis"));
   goto start;

:found_owner:
   unfoldboat.value[1] := 5;
   act("$1n disappears in a flash of light!",
      A_ALWAYS,self,null,null,TO_ALL);
   link(unfoldboat,ownerptr.inside);
   sendtext("$1n magically appears in your inventory.&n",ownerptr);
*/
   goto start;

:action:
   if ((activator.name != owner) or (not(cmdword in argument)))
      goto start;
   block;
   unfoldboat := load("unfolded_boat@abyss1");
   secure(unfoldboat,lost_boat);
   dilcopy("boat_unfolded@abyss1("+owner+","+cmdword+")",unfoldboat);
   unfoldboat.value[1] := 5;
   act("$1n softly whispers a command word to $3n.",
      A_SOMEONE,activator,null,self,TO_REST);
   act("You softly whisper the command word.",
      A_ALWAYS,activator,null,self,TO_CHAR);
   act("$3n magically unfolds into a boat.",
      A_ALWAYS,activator,null,self,TO_ALL);
   log("Folding Boat / Owner : "+owner);
   link(unfoldboat,activator.outside);
   unsecure(unfoldboat);
   destroy(self);
   quit;

:lost_boat:
   unsecure(unfoldboat);
   goto start;

}
dilend /* boat_folded */


dilbegin recall aware shielding_dil(protect : string, resist : string);

var
   i		: integer;
   spl		: string;
   spllist	: string;
   resistspl	: integer;
   damage	: integer;
   modifier	: integer;
   splresult	: integer;

code {

:init:
   spllist := protect;
   resistspl := atoi(resist);
   i := interrupt(SFB_CMD,((command("resist")) and
                           (activator == self.outside)),resist);
   log("Brooch of shielding : Spells restisted - "+spllist);
   log("Brooch of shielding : Resistance Spell - "+resist);
:start:
   wait(SFB_PRE,((command(CMD_CAST)) and (target == self.outside)));
   log("Brooch of shielding : Passed SFB_PRE wait");
   log("Brooch of shielding : Spell cast is "+argument);
   spl := getword(argument);
   damage := power;
   if ((self.value[1] < 1) and (self.value[2] < 1))
      goto kaput;
   else
      if (self.value[1] < 1) goto start;

   if ((self.equip == WEAR_CHEST) and
       (target == self.outside) and
       (spl in spllist) and
       (self.value[1] > 0))
   {
   /* determine damage modifier and update protection left */
       log("Brooch of shielding : Damage - "+itoa(damage));
       modifier := damage * (25/100);
       log("Brooch of shielding : Modifier - "+itoa(damage));
       if (self.value[1] >= modifier)
          self.value[1] := self.value[1] - modifier;
       else
       {
          modifier := self.value[1];
          self.value[1] := 0;
       }
    /* change damage done */
       log("Brooch of shielding : Modifier is "+itoa(modifier));
       power := power - modifier;
       log("Brooch of shielding : New power is "+itoa(power));
       if (power < 0) power := 0; /* just for safety */
       act("Your "+self.title+" glows brightly!",
         A_ALWAYS,self.outside,null,null,TO_CHAR);
       act("$1n's "+self.title+" glows brightly!",
         A_SOMEONE,self.outside,null,null,TO_REST);
       goto start;
    }
    goto start;

:resist:
    if (self.value[2] > 0)
    {
       splresult := cast_spell(resistspl,self.outside,self,self.outside,
          "shield_eff@abyss1");
       self.value[2] := self.value[2] - 1;
       block;
       goto start;
    }
    else
    {
       if ((self.value[1] < 1) and (self.value[2] < 1))
       {
          block;
          goto kaput;
       }
       else
       {
          sendtext("Your "+self.title+" has no more charges.&n",self.outside);
          block;
          goto start;
       }
    }

:kaput:
   act("Your "+self.title+" turns a dull black and breaks!",
      A_ALWAYS,self.outside,null,null,TO_CHAR);
   act("$1n's "+self.title+" turns a dull black and breaks!",
      A_SOMEONE,self.outside,null,null,TO_REST);
   destroy(self);
   quit;

}
dilend /* shielding_dil */


dilbegin shield_eff(medi : unitptr, targ : unitptr, hm : integer);

code {

   act("Your brooch produces a bright flash!",
      A_ALWAYS,self,null,targ,TO_CHAR);
   act("$1n's brooch productes a bright flash!.",
      A_SOMEONE,self,null,targ,TO_REST);
   return;

}
dilend /* shielf_eff */


dilbegin recall blasting_charge();

code {

:start:
   heartbeat := PULSE_SEC*SECS_PER_MUD_DAY; /* 1 charge per day */
   wait(SFB_TICK,TRUE);
   heartbeat := PULSE_SEC*3;

   act("Your &c+wHorn of Blasting&cw howls like the wind.",
      A_ALWAYS,self.outside,self,null,TO_CHAR);
   act("$1n's &c+wHorn of Blasting&cw howls like the wind.",
      A_ALWAYS,self.outside,self,null,TO_REST);

   sendto("charge",self);

   goto start;

}
dilend /* blasting_charger */

dilbegin recall aware horn_blast();

var
   result	: integer;
   charge	: integer;
   charges	: integer;
   enemyname	: string;
   enemy	: unitptr;


code {

   charges := 1;

:init:
   heartbeat := PULSE_SEC*1;
   charge := interrupt(SFB_MSG,(activator==self) and
      (argument=="charge"), charge);

:start:
   wait(SFB_CMD,((activator==self.outside) and
                 (self.equip==WEAR_HOLD)) and
                 (command("blast")));
   enemyname := getword(argument);
   block;
   if (charges < 1) goto empty;
   charges := charges - 1;
   enemy := findunit(self.outside,enemyname,FIND_UNIT_SURRO,null);
   if (enemy == null)
   {
      act("You don't see that person here.",
         A_ALWAYS,self.outside,null,null,TO_CHAR);
      goto start;
   }
   result := cast_spell(SPL_LIGHTNING_3,
      self.outside,self,enemy,"blasting_eff@abyss1()");
   goto start;

:empty:
   act("Your &c+wHorn of Blasting&cw has not recharged yet.",
      A_SOMEONE,self.outside,null,self,TO_CHAR);
   goto start;

:charge:
   clear(charge);
   if (charges<1) charges := 1;
   goto init;
   goto start;

}
dilend /* horn_blast */


dilbegin blasting_eff(medi : unitptr, targ : unitptr, hm : integer);

code {

   act("You blow your &c+wHorn of Blasting releasing its deadly power!",
      A_ALWAYS,self,null,targ,TO_CHAR);
   act("$1n's blows $1s &c+wHorn of Blasting releasing its deadly power!",
      A_SOMEONE,self,null,targ,TO_REST);
   return;

}
dilend /* blasting_eff */



/* ################################################################## */
/* -----------------------= ROOMS SECTION=--------------------------- */
/* ################################################################## */

%rooms

/* ----------------------- PRIVATE ROOM ------------------------------- */

			the_nexus
names {"the nexus","room_nexus"}
title "The Nexus"
descr "This large circular room is the home of the god Nexus. You see a
granite desk that faces the center of the room sitting near the wall. It
has a peculiar chair placed behind it. The wall behind the desk is covered
by an enormous mural that grabs your attention, and mounted on the wall
opposite to the mural you notice a painting. In the room's exact middle the
floor is a disc of swirling colors about five yards in diameter. Your best
guess is that it must be a portal that leads to another part of the world.
There is another similar portal in the ceiling that you can be sucked
into."

extra {"tome","tomes","book","books"}
"These are vast books bound in thick leather. As you open one of them you
can see they are filled with knowledge. Some about Abyssal planes and others
about a most peculiar thing called DIL. There is one especially large one
that has the title 'Draconomicon' on the cover."

extra {"draconomicon"}
"Turning the large pages, you see it covers every single aspect of
dragonkind. The book features colourful drawings of every type of dragon
known. After starting at one of the drawings for a second it suddenly comes
to life so you can study the way the dragon moves and behaves."

extra {"granite desk","desk"}
"The massive granite desk must be very heavy. It is littered with books and
documents and in one corner a glowing crystal ball sits on a stand, shedding
a soft light over the desk. You notice an vial filled with ink with a large
colourful quill placed inside it."

extra {"glowing chair","chair"}
"The chair is made of solid granite but it has cushions that appear to be
some sort of bundled energy. They glow with a soft red light and look even
more comfortable than regular cushions."

extra {"dragon mural","mural"}
"As you take a good look at the mural it appears to you as if the dragon is
actually coming out of the wall. It has it's left claw outstretched in your
direction and it's mouth is slightly ajar. Large wings spread out from the
dragon's body in majestic splendor."

extra {"painting","picture"}
"The painting contains a group portrait of the many friends Nexus and his
avatar Orin have made in the world of Valhalla. Among others you see: Julia,
Zag, Isigow, Rattlesnake, Hex, Dominic, Boh, Rikuo, Tigika, Silencer, Belar,
Kuros, Kyt, Zex, Jem, Chavez, Cecil, Zandar, Whistler, Palio, Javelin, Rand,
Wynne, Ashes, Aqua, Cinnamon, Oops and Dionysus."

flags{UNIT_FL_INDOORS,UNIT_FL_NO_WEATHER,UNIT_FL_NO_TELEPORT }
movement SECT_INSIDE

ALWAYS_LIGHT

down to sk_entrance descr "On top of the skull.";
up to square@udgaard descr "Udgaard Square.";

end /* the_nexus */

/* ----------------------- SPECIAL ROOMS ------------------------------ */

			fall_room
names {"fall_room"}
title "Falling down the pit"
descr "You see the sides of the pit rush by as you fall down with dazzling
speed."

/*
effect : This dil prevents the player from looking in the fall_room.
*/

dilbegin fall_look();
var
   pc	: unitptr;

code {

:start:
   heartbeat := PULSE_SEC*1;
   wait(SFB_CMD,command(CMD_LOOK));
   block;
   pc := activator;
   secure(pc,lost_pc);
   act("The sharp wind rushing into your face brings tears to your eyes "+
      "that block your vision.",A_ALWAYS,pc,null,null,TO_CHAR);
   unsecure(pc);
   goto start;

:lost_pc:
   goto start;

}
dilend /* fall_look */

flags {UNIT_FL_INDOORS, UNIT_FL_NO_WEATHER, UNIT_FL_NO_TELEPORT}
movement SECT_INSIDE

ALWAYS_LIGHT

end /* fall_room */

			abyssal_void
names {"abyssal_void"}
title "Abyssal Void"
descr "Emptyness."

/*
effect : This routine prevents the person in this room from looking.
*/

dilbegin void_look();
var
   pc	: unitptr;

code {

:start:
   heartbeat := PULSE_SEC*1;
   wait(SFB_CMD,command(CMD_LOOK));
   block;
   pc := activator;
   secure(pc,lost_pc);
   act("You see absolutely nothing.",A_ALWAYS,pc,null,null,TO_CHAR);
   unsecure(pc);
   goto start;

:lost_pc:
   goto start;

}
dilend /* void_look */

flags {UNIT_FL_INDOORS, UNIT_FL_NO_WEATHER, UNIT_FL_NO_TELEPORT}
movement SECT_INSIDE

ALWAYS_LIGHT

end /* fall_room */

/* ------------------------ CHAIN ROOMS ------------------------------- */

			n_o_pit
names {"n_o_pit","pit"}
title "At the north side of the dark pit"
descr "You are at the north side of the big dark pit. As you look over the
edge, south into the pit you see a huge human skull hanging in mid air from
four big black steel chains. One of the chains starts right here coming out
of the ash gray ground. Although dangerous, going south along the chain
would allow you to reach the enormous skull. A bottomless abyss lies to the
west and north and you can go east around the pit."

extra {"chains","chain"}
"The chains are wrought of cold looking black steel. As you look closer you
see there are runes scratched onto the seperate links which are oval loops
of 3 foot thick metal. Here one of the chains comes right out of the ground,
you can't see where it is fastened, but you hope it is in a deep and solid
place."

extra {"runes","rune"}
"These are wicked and pointy looking runes. They might even allow you some
grip when traveling along these chains."

extra {"ground","soil"}
"The ground seems to be made out of a strange mixture of ashes and
charcoal."

extra {"skull","palace","fortress"}
"From here it seems the skull is made of solid bone. It looks human, but you
can't imagine a human being this big. From here you can see the back side of
the skull. It looks like there is an entrance on top of it."

extra {"pit","dark pit"}
"The dark pit is five hundred yards across. And so deep you can only see
ever darkening night when you look down into it. You are on the north side
of it."

flags { UNIT_FL_NO_TELEPORT,UNIT_FL_NO_WEATHER}
movement SECT_FIELD

south to chain_n1 descr "On the north chain.";
east to around_pit07 descr "North of the pit.";

end /* n_o_pit */


			e_o_pit
names {"e_o_pit","pit"}
title "At the east side of the dark pit"
descr "You are at the east side of the enormous pit. As you look west and
down into the pit you see a huge human skull dangling from four black
steel chains. One of the chains comes out of the ground here holding up the
east side of the skull. You can go along the chain to the west although
it might be a dangerous journey. A bridge to the east allows you to cross
the river Styx."

extra {"chains","chain"}
"The chains are wrought of cold looking black steel. As you look closer you
see there are runes scratched onto the seperate links which are oval loops
of 3 foot thick metal. Here one of the chains comes right out of the ground,
you can't see where it is fastened, but you hope it is in a deep and solid
place."

extra {"runes","rune"}
"These are wicked and pointy looking runes. They might even allow you some
grip when traveling along these chains."

extra {"ground","soil"}
"The ground seems to be made out of a strange mixture of ashes and
charcoal."

extra {"skull","palace","fortress"}
"From here it seems the skull is made of solid bone. It looks human, but you
can't imagine a human being this big. From here you can see the left side of
the skull. It looks like there is an entrance on top of it."

extra {"pit","dark pit"}
"The dark pit is five hundred yards across. And so deep you can only see
ever darkening night when you look down into it. You are on the east side of
it."

flags { UNIT_FL_NO_TELEPORT,UNIT_FL_NO_WEATHER}
movement SECT_FIELD

west to chain_e1 descr "On the east chain.";
north to around_pit05 descr "East of the pit.";
south to around_pit04 descr "East of the pit.";
east to styx_bridge01 descr "A bridge across the Styx.";

end /* e_o_pit */


			s_o_pit
names {"s_o_pit","pit"}
title "At the south side of the dark pit"
descr "You are at the south side of the dark pit. As you look into the pit to
the north, you see a enormous human skull hanging from four huge black steel
chains. You are looking right into it's dead face. One of the chains comes
out of the ground here holding the south side of the skull. You can travel
the chain to the north. Surely a treacherous path."

extra {"chains","chain"}
"The chains are wrought of cold looking black steel. As you look closer you
see there are runes scratched onto the seperate links which are oval loops
of 3 foot thick metal. Here one of the chains comes right out of the ground,
you can't see where it is fastened, but you hope it is in a deep and solid
place."

extra {"runes","rune"}
"These are wicked and pointy looking runes. They might even allow you some
grip when traveling along these chains."

extra {"ground","soil"}
"The ground seems to be made out of a strange mixture of ashes and
charcoal."

extra {"skull","palace","fortress"}
"From here it seems the skull is made of solid bone. It looks human, but you
can't imagine a human being this big. From here you stare right into it's
empty face. You think you see some movement in the eye sockets that are
glowing with red light and also on the lower jaw that is still present.
Blood red smoke billows forth out of the mouth. It looks like there is an
entrance on top of the skull."

extra {"pit","dark pit"}
"The dark pit is five hundred yards across. And so deep you can only see
ever darkening night when you look down into it. You are at the south side
of it."

flags { UNIT_FL_NO_TELEPORT,UNIT_FL_NO_WEATHER}
movement SECT_FIELD

north to chain_s1 descr "On the south chain.";
west to around_pit01 descr "South of the pit.";
east to around_pit02 descr "South of the pit.";

end /* s_o_pit */


			w_o_pit
names {"w_o_pit","pit"}
title "At the west side of the dark pit"
descr "You are at the west side of the big dark pit. As you look to the east
down into the pit you see a huge human skull dangling from four big black
steel chains. You are looking at it's right side. One of the chains
originates here comeing right out of the ground. You are able to travel
along the chain to the east. But it looks like a dangerous road. As you look
to the north east you can see that although round in form the pit is not
entirely closed as it opens to connect to the infinitely deep Abyss which
prevents travel north. You can go south or west onto the plain of ash."

extra {"chains","chain"}
"The chains are wrought of cold looking black steel. As you look closer you
see there are runes scratched onto the seperate links which are oval loops
of 3 foot thick metal. Here one of the chains comes right out of the ground,
you can't see where it is fastened, but you hope it is in a deep and solid
place."

extra {"runes","rune"}
"These are wicked and pointy looking runes. They might even allow you some
grip when traveling along these chains."

extra {"ground","soil"}
"The ground seems to be made out of a strange mixture of ashes and
charcoal."

extra {"skull","palace","fortress"}
"From here it seems the skull is made of solid bone. It looks human, but you
can't imagine a human being this big. From here you see the left side and
what looks like an entrance on top of it."

extra {"pit","dark pit"}
"The dark pit is five hundred yards across. And so deep you can only see
ever darkening night when you look down into it. You are at the west side
of it."

flags { UNIT_FL_NO_TELEPORT,UNIT_FL_NO_WEATHER}
movement SECT_FIELD

east to chain_w1 descr "On the west chain.";
west to ash_01 descr "The edge of the plain of ash.";
south to ash_07 descr "The edge of the plain of ash.";

end /* w_o_pit */


			chain_n1
names {"chain_n1","chain"}
title "On the north chain"
descr "You are clinging to the north chain. There is only black night below
you and not much else to see other than the skull and the chain itself. To
the south you can travel nearer to the skull and north to the north edge of
the pit."

CHAIN_EXTRA

flags {UNIT_FL_NO_TELEPORT,UNIT_FL_NO_WEATHER }
movement SECT_MOUNTAIN /* player is climbing along chains */

dilcopy fall@abyss1(1,3,5);

north to n_o_pit descr "North of the pit.";
south to chain_n2 descr "Middle of the the north chain.";

end /* chain_n1 */


			chain_n2
names {"chain_n2","chain"}
title "Middle of the north chain"
descr "You are almost above the skull now, but falling now would still send
you falling down into the pit. The chain is swaying somewhat here in the
middle. You can go north along the chain in the direction of the edge of the
pit or south to the end of the chain where it is fastened to the skull."

CHAIN_EXTRA

flags {UNIT_FL_NO_TELEPORT,UNIT_FL_NO_WEATHER }
movement SECT_MOUNTAIN /* player is climbing along chains */

dilcopy fall@abyss1(2,4,6);

north to chain_n1 descr "On the north chain.";
south to chain_n3 descr "On the north chain.";

end /* chain_n2 */


			chain_n3
names {"chain_n3","chain"}
title "On the north chain"
descr "You are on the north chain near it's fastening point on the enormous
skull. The skull is below you now but you dropping falling off here will
send you sliding off it's top down into the pit. You can go south off the
chain to the entrance of the skull fortress or north on the chain in the
direction of the edge of the pit."

CHAIN_EXTRA

flags {UNIT_FL_NO_TELEPORT,UNIT_FL_NO_WEATHER }
movement SECT_MOUNTAIN /* player is climbing along chains */

dilcopy fall@abyss1(1,3,5);

north to chain_n2 descr "Middle of the north chain.";
south to sk_entrance descr "The entrance to the skull fortress.";

end /* chain_n3 */


			chain_e1
names {"chain_e1","chain"}
title "On the east chain"
descr "You are climbing along the east chain. There is only darkness below
you and not much else to see but the skull and the chain itself. You barely
escape a nasty slip on some kind of bird-like droppings and try to wrap
yourself tightly around one of the links. To the west you can move nearer
to the skull and east to the east edge of the pit."

CHAIN_EXTRA

flags {UNIT_FL_NO_TELEPORT,UNIT_FL_NO_WEATHER }
movement SECT_MOUNTAIN /* player is climbing along chains */

dilcopy fall@abyss1(1,3,5);

east to e_o_pit descr "East of the pit.";
west to chain_e2 descr "Middle the east chain.";

end /* chain_e1 */


			chain_e2
names {"chain_e2","chain"}
title "Middle of the east chain"
descr "You are traveling along the east chain. You are almost above the
skull now, but falling now would still send you falling down into the pit.
Did you just see a huge tentacle swaying through the dark mist below? As
you wonder you almost forget to hold on to the chain. You can go east along
the chain to the east edge of the pit or west to the end of the chain where
it is connected to the skull."

CHAIN_EXTRA

flags {UNIT_FL_NO_TELEPORT,UNIT_FL_NO_WEATHER }
movement SECT_MOUNTAIN /* player is climbing along chains */

dilcopy fall@abyss1(2,4,6);

east to chain_e1 descr "On the east chain.";
west to chain_e3 descr "On the east chain.";

end /* chain_e2 */


			chain_e3
names {"chain_e3","chain"}
title "On the east chain"
descr "You are on the east chain near the point where it connects to
the enormous skull. The skull is below you now but you falling off here will
most likely send you sliding off it's top down into the pit. You can go west
to the entrance to the skull fortress or east along the chain back to the
edge of the pit."

CHAIN_EXTRA

flags {UNIT_FL_NO_TELEPORT,UNIT_FL_NO_WEATHER }
movement SECT_MOUNTAIN /* player is climbing along chains */

dilcopy fall@abyss1(1,3,5);

east to chain_e2 descr "Middle of the east chain.";
west to sk_entrance descr "The entrance to the skull fortress.";

end /* chain_e3 */


			chain_s1
names {"chain_s1","chain"}
title "On the south chain"
descr "You are climbing along the south chain. Little black bat-like horrors
suddenly fly into your face almost knocking you off. Your heart is pounding
in your chest. South lies the edge of the pit where it at least a little
safer, and to the north is the middle of the chain."

CHAIN_EXTRA

flags {UNIT_FL_NO_TELEPORT,UNIT_FL_NO_WEATHER }
movement SECT_MOUNTAIN /* player is climbing along chains */

dilcopy fall@abyss1(1,3,5);

south to s_o_pit descr "South of the pit.";
north to chain_s2 descr "Middle of the south chain.";

end /* chain_s1 */


			chain_s2
names {"chain_s2","chain"}
title "Middle the south chain"
descr "You are traveling along the south chain, almost above the skull now,
but not yet. A sudden rotten stench that rises from the pit makes you want
to squeeze your nose shut, but you think you'd better not lose your grip.
You can go south along the chain in the direction of the edge of the pit
or north to the end of the chain where it reaches the skull."

CHAIN_EXTRA

flags {UNIT_FL_NO_TELEPORT,UNIT_FL_NO_WEATHER }
movement SECT_MOUNTAIN /* player is climbing along chains */

dilcopy fall@abyss1(2,4,6);

south to chain_s1 descr "On the south chain.";
north to chain_s3 descr "On the south chain.";

end /* chain_s2 */


			chain_s3
names {"chain_s3","chain"}
title "On the south chain"
descr "You are on the south chain near the big skull. The skull is below you
now. You still don't like the feeling of dropping off here, but the sweat
in your palms almost made you do just that! You can go north to the entrance
to the skull fortress or south along the chain back to the edge of the pit."

CHAIN_EXTRA

flags {UNIT_FL_NO_TELEPORT,UNIT_FL_NO_WEATHER }
movement SECT_MOUNTAIN /* player is climbing along chains */

dilcopy fall@abyss1(1,3,5);

south to chain_s2 descr "Middle of the south chain.";
north to sk_entrance descr "The entrance to the skull fortress.";

end /* chain_s3 */


			chain_w1
names {"chain_w1","chain"}
title "On the west chain"
descr "You are balancing on the west chain, deperately trying to hang on to
it. Eternal night lures below you, waiting for you to join it. You can go
west to the west edge of the pit or go east to the middle of the west
chain."

CHAIN_EXTRA

flags {UNIT_FL_NO_TELEPORT,UNIT_FL_NO_WEATHER }
movement SECT_MOUNTAIN /* player is climbing along chains */

dilcopy fall@abyss1(1,3,5);

west to w_o_pit descr "West of the pit.";
east to chain_w2 descr "Middle of the west chain.";

end /* chain_w1 */


			chain_w2
names {"chain_w2","chain"}
title "Middle of the west chain"
descr "You are traveling along the west chain. A sudden jolt in the chain
makes the link you are on twitch, almost throwing you off. To the west you
can travel in the direction of the west side of the pit, east leads over the
chain to the skull. You don't want to know what lies in the darkness below
you."

CHAIN_EXTRA

flags {UNIT_FL_NO_TELEPORT,UNIT_FL_NO_WEATHER }
movement SECT_MOUNTAIN /* player is climbing along chains */

dilcopy fall@abyss1(2,4,6);

west to chain_w1 descr "On the west chain.";
east to chain_w3 descr "On the west chain.";

end /* chain_w2 */


			chain_w3
names {"chain_w3","chain"}
title "On the west chain"
descr "You are traveling along the west chain near the skull. You can go
east to the skull fortress entrance from here and west to the middle of the
west chain. Below you lies the west part of the skull but it is still too
steep to gain steady footing on. It a good place to slide off though."

CHAIN_EXTRA

flags {UNIT_FL_NO_TELEPORT,UNIT_FL_NO_WEATHER }
movement SECT_MOUNTAIN /* player is climbing along chains */

dilcopy fall@abyss1(1,3,5);

west to chain_w2 descr "Middle of the west chain.";
east to sk_entrance descr "The entrance to the skull fortress.";

end /* chain_w3 */

/* --------------------- SKULL FORTRESS ROOMS ------------------------- */

			sk_entrance
names {"sk_entrance","skull fortress entrance"}
title "On top of the skull"
descr "You have reached the top of the huge skull. It sways softly hanging
from it's chains. Around you lie the flesh and bones of some unfortunate men
and beasts. You notice a trapdoor probably leading down into the skull's
interior. You can travel from here along the thick black chains to the four
edges of the pit."

extra {"chains","chain"}
"The chains are wrought of cold looking black steel. As you look closer you
see there are runes scratched onto the seperate links which are oval loops
of 3 foot thick metal. Here on the skull the chains are linked to four large
rings that stick half out of the bone."

extra {"rings"}
"The rings are made of black steel just like the chains. On it are pictures
of foul beasts each eating another beast in front of it, thus forming a
chain all around the ring."

extra {"runes","rune"}
"These are wicked and pointy looking runes. They might even allow you some
grip when traveling along these chains."

extra {"skull","palace","fortress"}
"You are standing on top of it. It looks like it is made of real bone!"

extra {"pit","dark pit"}
"At least you won't fall into it easily from here."

flags {UNIT_FL_NO_TELEPORT }
movement SECT_CITY

north to chain_n3 descr "On the north chain.";
east to chain_e3 descr "On the east chain.";
south to chain_s3 descr "On the south chain.";
west to chain_w3 descr "On the west chain.";
down to sk_top01 open {EX_OPEN_CLOSE,EX_CLOSED} keyword
{"trapdoor","door","hatch","floor"};

end /* sk_entrance */

/* top floor */


			sk_top01
names {"sk_top01"}
title "In the middle of a dark and dampy corridor"
descr "You are in the middle of a dark and dampy corridor. Green vapors that
give of a faint eerie light flow across the floor. There is a smell of death
and decay in the air and to the east it seems to get even worse. You can
also follow the corridor to the west. A staircase made entirely out of the
bones of different dead beings spirals up and down. A door south leads to
the guard room."

extra {"corridor"}
"The walls, ceiling and even floor that form the corridor are also made out
of bone. They look like they have always been here inside this skull, but
you never saw compartments in any skull that you have split in the past.
It really makes you wonder."

extra {"staircase","stairs","stair","spiral"}
"It consists entirely of bones of different size and shape spiraling up
around the backbone of some dead wyrm. The bones are bound together with
sinews."

extra {"door"}
"The door to the south is marked with a picture of a claw wielding a deadly
weapon."

extra {"vapor","vapour","mist"}
"You are not sure if the smell around here originates from the mist. But you
do know that all light here probably does as the green mist along the floor
sheds a pale green light."

extra {"smell"}
"This smell is so bad you think you can see it."

flags
   {UNIT_FL_NO_TELEPORT,UNIT_FL_INDOORS,UNIT_FL_NO_WEATHER }
movement SECT_INSIDE

ALWAYS_LIGHT

east to sk_top02 descr "East end of the corridor.";
west to sk_top03 descr "West end of the corridor.";
down to sk_mid01 descr "Middle of a torch lit corridor.";
south to sk_guard_room open {EX_OPEN_CLOSE,EX_CLOSED} keyword {"door"};
up to sk_entrance open {EX_OPEN_CLOSE,EX_CLOSED} keyword
{"trapdoor","door","hatch","floor"};

end /* sk_top01 */


			sk_top02
names {"sk_top02"}
title "East end of a dark and dampy corridor"
descr "You reached the east end of the corridor. The green glowing mist that
is present all along the corridor seems to come from the north, as thick
clouds of it flow from under the north door. The rotting smell is getting
really bad here. To the south is another door and you can go west along the
corridor."

extra {"corridor"}
"The walls, ceiling and even floor that form the corridor are also made out
of bone. They look like they have always been here inside this skull, but
you never saw compartments in any skull that you have split in the past.
It really makes you wonder."

extra {"doors","door"}
"The door to the north is marked with a picture of a claw wielding a deadly
looking kitchen utensil. The door to the south has the mark of claw wielding
a mace."

extra {"vapor","vapour","mist"}
"The green vapors are thick here. It is pretty clear now that they are
responsible for the terrible smell around here since the smell has gotten
worse as the amount of vapor increased. They seem to be coming from the room
north of here."

extra {"smell"}
"This smell is so bad you think you can see it."

flags
   {UNIT_FL_NO_TELEPORT,UNIT_FL_INDOORS,UNIT_FL_NO_WEATHER }
movement SECT_INSIDE

ALWAYS_LIGHT

west to sk_top01 descr "Middle of the corridor.";
north to sk_kitchen open {EX_OPEN_CLOSE,EX_CLOSED} keyword {"door"};
south to sk_priest_room open {EX_OPEN_CLOSE,EX_CLOSED} keyword {"door"};

end /* sk_top02 */


			sk_top03
names {"sk_top03"}
title "West end of a dark and dampy corridor"
descr "Here at the west end of the corridor the green smelly vapour is not
very thick anymore. An uneasy feeling comes over you as you behold the two
doors here, one leading north and one to the south. East lies the middle
of the corridor."

extra {"corridor"}
"The walls, ceiling and even floor that form the corridor are also made out
of bone. They look like they have always been here inside this skull, but
you never saw compartments in any skull that you have split in the past.
It really makes you wonder."

extra {"doors","door"}
"The door to the north is marked with some arcane symbol. The door to the
south has a picture of a claw wielding a sword on it."

extra {"vapor","vapour","mist"}
"The green vapors are not very thick here. There is a little less light but
that's not a real problem since the smell has lessened too."

extra {"smell"}
"This smell is so bad you think you can see it."

flags
   {UNIT_FL_NO_TELEPORT,UNIT_FL_INDOORS,UNIT_FL_NO_WEATHER }
movement SECT_INSIDE

ALWAYS_LIGHT

east to sk_top01 descr "Middle of the corridor.";
south to sk_general_room open {EX_OPEN_CLOSE,EX_CLOSED} keyword {"door"};
north to sk_wiz_study open {EX_OPEN_CLOSE,EX_CLOSED} keyword {"door"};

end /* sk_top03 */


			sk_guard_room
names {"sk_guard_room"}
title "In the skull fortress' guard room"
descr "Even demons seem to have boring guard rooms. There is a solid wooden
table here with some empty mugs on it and some scattered stools. A small
pile of trash litters one of the corners. An odor of sweat and rotting
filth makes you feel slightly ill. North through the door leads to the
corridor through which you entered here."

extra {"table"}
"This solid table seems to be brute guard proof."

extra {"mugs","mug"}
"The mugs contained some liquid that you probably haven't seen before and
luckily never tasted."

extra {"stools","stool"}
"The stools are simple but strong."

extra {"pile","trash","litter"}
"Yuck!"

flags
   {UNIT_FL_NO_TELEPORT,UNIT_FL_INDOORS,UNIT_FL_NO_WEATHER }
movement SECT_INSIDE

ALWAYS_LIGHT

north to sk_top01 open {EX_OPEN_CLOSE,EX_CLOSED} keyword {"door"};

end /* sk_guard_room */


			sk_kitchen
names {"sk_kitchen"}
title "In the skull fortress kitchen"
descr "Upon entering the kitchen you almost pass out. The air of blood
and rotting flesh assaults your nostrils. As you shake a shred of dead meat
off your boots you notice a big table, labeled pots and a large fireplace
with a cauldron hanging in it. Thick clouds of a greenish vapor erupt from
the cauldron which is boiling over. There are also various kitchen machines
that are probably used by the cook. A door leads south to the corridor."

extra {"vapor","vapour","mist"}
"The vapors are so thick it's hard to see and breathe here."

extra {"smell"}
"This smell is so bad you think you can see it."

extra {"shred","flesh","meat"}
"There are lots of pieces of bloody meat lying around here. You hope it is
dead."

extra {"kitchen table","table"}
"The kitchen is filled with various knifes, chopping blades and some strange
machines."

extra {"labeled pots","labeled pot","pots","pot","labels","label"}
"There are various pots here with labels on them. A brief glance tells you
they hold 'bat wings','demon toe cheese','lemure eyes' and 'little horrors'
among other disgusting things."

extra {"fireplace","fire place","stove"}
"This fireplace is heated with molten lava. As you look closer you see that
there is no chimney! You have the feeling that this room is not very good
for you health."

extra {"cauldron","pot","kettle"}
"The cauldron is filled with red goo but green mist is rising from it. It is
boiling over and the muck falling over makes a hissing noise as it hits the
lava below the cauldron."

extra {"machines","machine"}
"These are odd looking machines which sometimes seem to have a life of it's
own as they stir and make funny noises. You can't tell the funtion of each
of them but you think you can name one as a meat grinder and another as a
head press. Better not go too near to them."

flags
   {UNIT_FL_NO_TELEPORT,UNIT_FL_INDOORS,UNIT_FL_NO_WEATHER }
movement SECT_INSIDE

ALWAYS_LIGHT

south to sk_top02 open {EX_OPEN_CLOSE,EX_CLOSED} keyword {"door"};

end /* sk_kitchen */


			sk_priest_room
names {"sk_priest_room"}
title "Xorlock's private room"
descr "These are the private quarters of Xorlock, Goruk's high priest. This
room is scarcely furnitured. The only things you see are a small shrine, a
desk and chair, and a tome. The state of the room makes you feel empty
inside."

extra {"shrine"}
"The shrine is dedicated to Goruk. It seems that Goruk is trying to become a
power in his own right. Xorlock's task is probably to find souls and
followers to fuel his master's power."

extra {"desk","bureau"}
"On the desk are an ink pot, quill and some scattered papers. The desk
itself is made of black marble and has no fancy decorations whatsoever."

extra {"chair","stool"}
"The chair is made of very solid wood and doesn't look very pleasant. There
are no pillows in it."

extra {"tome","book"}
"The tome is empty! how strange! Maybe there will be a quest in it later?"

flags
   {UNIT_FL_NO_TELEPORT,UNIT_FL_INDOORS,UNIT_FL_NO_WEATHER }
movement SECT_INSIDE

ALWAYS_LIGHT

north to sk_top02 open {EX_OPEN_CLOSE,EX_CLOSED} keyword {"door"};

end /* sk_priest_room */


			sk_general_room
names{"sk_general_room"}
title "Irchak's private room"
descr "Various decorative weapons and shields are hang on the walls here.
Most are evil looking but you see a brighter looking sword somewhere among
them. Probably some trophy. Other furniture includes a desk and chair, a
bed and two torches for light. There is also a rather large map mounted on
the wall here. You can go north to the corridor."

extra {"desk","bureau"}
"On the desk are an ink pot, quill and some small scattered maps. The desk
itself is made of black wood and has pictures of great and glorious battles
carved into it."

extra {"chair","stool"}
"This solid wooden chair looks nice and comfortable."

extra {"torches","torch"}
"The torches shed a orange flickering light on the room."

extra {"map"}
"&l
     ______  hades 1
    |      |_  hades 2
    |______| |_  hades 3
      |______| |_  hades 4
        |______| |_  hades 5
          |______| |_  hades 6
            |______| |_  hades 7
   primary    |______| |_  hades 8
   targets      |______| |_  hades 9
                  |______| |
                    |______|"

flags
   {UNIT_FL_NO_TELEPORT,UNIT_FL_INDOORS,UNIT_FL_NO_WEATHER }
movement SECT_INSIDE

ALWAYS_LIGHT

north to sk_top03 open {EX_OPEN_CLOSE,EX_CLOSED} keyword {"door"};

end /* sk_general_room */


			sk_wiz_study
names {"sk_acina_study"}
title "Acina's study"
descr "Glowing crystal balls softly light Acina's study. There are large
shelves filled with books and arcane objects. You feel the presence of
tremendous power waiting to be released. Various papers and manuscripts
litter a slender desk that is accompanied by a matching chair and there is a
bed in the corner.."

extra {"crystal balls","crystal ball","balls","ball"}
"The crystal balls are placed on delicate standards and give just enough
light to allow reading."

extra {"shelves","shelf"}
"There are all kinds of books and objects on these shelves. Most of them are
probably magical and maybe even protected. Better not touch them."

extra {"books","book"}
"Lots and lots of them."

extra {"objects","object"}
"Very strange objects indeed. You wonder what they might do."

extra {"desk","bureau"}
"This desk is as delicate as a spellcaster. It's subtle forms match it's
owner perfectly."

extra {"chair"}
"The chair matches the desk perfectly."

extra {"papers","paper","manuscripts","manuscript"}
"There is all kinds of writing on these, too bad you can't descipher any of
it. Must be some abyssal script."

extra {"bed"}
"This is definately a nice canopy bed! It's poles are carved into the forms
of beautiful naked men and women and on the bed itself are all kinds of
swirling figures making your eyes go funny. Only thing missing really, is a
mirror."

flags
   {UNIT_FL_NO_TELEPORT,UNIT_FL_INDOORS,UNIT_FL_NO_WEATHER }
movement SECT_INSIDE

ALWAYS_LIGHT

south to sk_top03 open {EX_OPEN_CLOSE,EX_CLOSED} keyword {"door"};
east to sk_wizsum_room descr "Acina's summoning room.";

end /* sk_wiz_room */


			sk_wizsum_room
names {"sk_wizsum_room"}
title "Acina's summoning room"
descr "This room is empty exept for a rather large summoning circle, and a
standard with a glowing crystal ball. You see scorch marks and dried blood
on some of the walls. Maybe not all summons have turned out the way they
should?"

extra {"summoning circle","circle"}
"The circle is burned into the bone floor."

extra {"standard","crystal ball","ball"}
"The crystal ball is placed on delicate standard and gives just enough
light to allow reading."

extra {"marks","mark"}
"Something definately exploded inhere!"

extra {"blood"}
"It looks like parts of someone went for a closer look at the walls."

flags
   {UNIT_FL_NO_TELEPORT,UNIT_FL_INDOORS,UNIT_FL_NO_WEATHER }
movement SECT_INSIDE

ALWAYS_LIGHT

west to sk_wiz_study descr "Acina's study.";

end /* sk_wizsum_room */


/* 2nd floor */


			sk_mid01
names {"sk_mid01"}
title "In middle of a torch-lit corridor"
descr "Flickering torches line the walls of this clean corridor. Wisps of
green mist come trickling down the bony stairway that leads up and down
from here. There is a very large ebony double door surrounded by softly
glowing runes to the north. The corridor itself allows you to go east and
west from here."

extra {"torches","torch"}
"The torches make sure there is some light here, although it is not much."

extra {"corridor"}
"The walls, ceiling and even floor that form the corridor are also made out
of bone. They look like they have always been here inside this skull, but
you never saw compartments in any skull that you have split in the past.
It really makes you wonder."

extra {"staircase","stairs","stair","spiral"}
"It consists entirely of bones of different size and shape spiraling up
around the backbone of some dead wyrm. The bones are bound together with
sinews."

extra {"double doors","double door","doors","door"}
"The double doors are made of think ebony and have no mark on them. They are
surrounded by runes that glow in a soft red light."

extra {"runes","rune"}
"These pointy looking runes scratched into the bone wall glow with a soft
red light."

extra {"vapor","vapour","mist"}
"The vapor is green and sheds a soft light as it spirals down the stairway
from above."

flags
   {UNIT_FL_NO_TELEPORT,UNIT_FL_INDOORS,UNIT_FL_NO_WEATHER }
movement SECT_INSIDE

ALWAYS_LIGHT

east to sk_mid02 descr "A bend in the corridor.";
west to sk_mid03 descr "A bend in the corridor.";
up to sk_top01 descr "Middle of a dark and dampy corridor.";
down to sk_bot01 descr "Middle of a filthy corridor.";
north to sk_throne_ante open{EX_OPEN_CLOSE,EX_CLOSED} keyword {"double
doors","doors","door"};

end /* sk_mid01 */


			sk_mid02
names {"sk_mid02"}
title "A bend in the east end of the corridor"
descr "The torch-lit corridor makes a bend to the south here leading to a
large room that has a bright red light coming from it. The light makes it
hard to see into the room but you can feel a draft coming from it. To the
west you can go back to the middle of the corridor."

extra {"torches","torch"}
"The torches make sure there is some light here, although it is not much."

extra {"corridor","bend"}
"The walls, ceiling and even floor that form the corridor are also made out
of bone. They look like they have always been here inside this skull, but
you never saw compartments in any skull that you have split in the past.
It really makes you wonder."

extra {"red light","light"}
"The red light makes it hard to look into the room to the south."

flags
   {UNIT_FL_NO_TELEPORT,UNIT_FL_INDOORS,UNIT_FL_NO_WEATHER }
movement SECT_INSIDE

ALWAYS_LIGHT

south to sk_socket01 descr "In a room shining with red light.";
west to sk_mid01 descr "In the middle of a torch lit corridor.";

end /* sk_mid02 */


			sk_mid03
names {"sk_mid03"}
title "A bend in the west end of the corridor"
descr "The torch-lit corridor bends south here. You can feel a draft coming
in from there. Red light makes it hard to see what is in the room from here.
This might be worth a little investigation. Walking east will take you to
the middle of the corridor."

extra {"torches","torch"}
"The torches make sure there is some light here, although it is not much."

extra {"corridor","bend"}
"The walls, ceiling and even floor that form the corridor are also made out
of bone. They look like they have always been here inside this skull, but
you never saw compartments in any skull that you have split in the past.
It really makes you wonder."

extra {"red light","light"}
"The red light makes it hard to look into the room to the south."

flags
   {UNIT_FL_NO_TELEPORT,UNIT_FL_INDOORS,UNIT_FL_NO_WEATHER }
movement SECT_INSIDE


ALWAYS_LIGHT

south to sk_socket02 descr "In a room shining with red light.";
east to sk_mid01 descr "In the middle of a torch lit corridor.";

end /* sk_mid03 */


			sk_socket01
names {"sk_socket01"}
title "In the skull's left eye socket"
descr "You are standing in the skull's left eye socket. There is a huge red
ruby here shining with an almost blinding light. You have to keep your back
in it's direction to be able to see something in this room. The spheric
shape makes this room look somewhat like a cave. A gaping hole to the south
allows you to look out into the pit or even jump out of the socket. Maybe
you should take a closer look at it."

extra {"ruby","gem"}
"It shines brightly and is clearly to heavy for you to pick up."

extra {"hole"}
"As you look out of the socket you can see the south edge of the pit above
and darkness below. You wonder what would happen if you &cbjump&cwed
&cbout&cw? Maybe you can test it by &cbthrow&cwing &c+wsomeone&cw else
&cbout&cw! HeHeHe!"

flags
   {UNIT_FL_NO_TELEPORT,UNIT_FL_INDOORS,UNIT_FL_NO_WEATHER }
movement SECT_INSIDE

ALWAYS_LIGHT

dilcopy throw_pc@abyss1("pzone_13@demon_realm");
dilcopy jump_pc@abyss1("pzone_13@demon_realm");

north to sk_mid02 descr "A bend in the torch lit corridor.";

end /* sk_socket01 */


			sk_socket02
names {"sk_socket02"}
title "In the skull's right eye socket"
descr "You have entered the skull's right eye socket. Bright light shines
from a huge ruby that is placed in the middle of the room. You can't look
directly into it and have to turn your back to it to see normally here. To
the south is a big hole where you can look out of the skull or down into the
pit. Perhaps you should take a closer look at it. Jumping out is also a
possibility although the thought gives you the creeps."

extra {"ruby","gem"}
"It shines brightly and is clearly to heavy for you to pick up."

extra {"hole"}
"As you look out of the socket you can see the south edge of the pit above
and darkness below. You wonder what would happen if you &cbjump&cwed
&cbout&cw? Maybe you can test it by &cbthrow&cwing &c+wsomeone&cw else
&cbout&cw! HeHeHe!"

flags
   {UNIT_FL_NO_TELEPORT,UNIT_FL_INDOORS,UNIT_FL_NO_WEATHER }
movement SECT_INSIDE

ALWAYS_LIGHT

dilcopy throw_pc@abyss1("temple@warntz");
dilcopy jump_pc@abyss1("temple@warntz");

north to sk_mid03 descr "A bend in the torch lit corridor.";

end /* sk_socket02 */


			sk_throne_ante
names {"sk_throne_room01"}
title "The antechamber to Goruk's throne room"
descr "You're in the antechamber to Goruk's throne room. Here people are
placed while waiting for an audience with the lord. A skeleton in the corner
indicates that it can be a long time before Goruk feels like hearing you.
There are no benches or stools here, making it an altogether uncomfortable
room. There are three arches here. To the north lies the throne room, an
arch to the west leads to a small temple and east lies the military room."

extra {"double doors","double door"}
"The double doors are made of think ebony and have no mark on them. They are
surrounded by runes that glow in a soft red light. The other doors"

extra {"doors","door"}
"They look sturdy enough."

flags
   {UNIT_FL_NO_TELEPORT,UNIT_FL_INDOORS,UNIT_FL_NO_WEATHER }
movement SECT_INSIDE

ALWAYS_LIGHT

south to sk_mid01 open {EX_OPEN_CLOSE,EX_CLOSED} keyword {"double
doors","doors","door"};
west to sk_temple01 descr "The skull fortress temple.";
east to sk_mil_room descr "The skull military room.";
north to sk_throne_room descr "Goruk's throne room.";

end /* sk_throne_ante */


			sk_temple01
names {"sk_temple01"}
title "The skull fortress temple"
descr "You have entered the skull fortress' temple. A large statue of Goruk
looms over you with a malevolent look on it's face. In it's upturned claw
lies the body of a young woman, her back broken, the look of death in her
eyes. Blood trickles down from the statue's claws and beak into a growing
puddle on the floor. There are also icons on the walls depicting unspeakable
evil. You can leave north through an arch to the temple altar or west to the
antechamber to the throne room."

extra {"statue","goruk"}
"The statue depicts a huge demon with a strong muscular humanoid body. It
has a head that has vulture like features and also strong claws and
talons and two big feathery wings. The thought of being ripped to shreds by
its claws, talons and mighty beak makes you shiver."

extra {"corpse","body","woman"}
"You feel sad as you think of what has happened to this once beautiful
maiden. Her lifeless body lies on her clearly broken back in the statue's
upturned claw, her guts spilling out of gaping wounds in her abdomen. The
look in her eyes is one of surprise and then death, she must have suffered a
lot."

extra {"blood","puddle"}
"All this is coming from the body of the sacrificed woman. It looks fresh."

extra {"icons","icon"}
"Shivers run down your spine as you see demons of various sorts slaughter
screaming terrified victims. As you look longer at them the pictures start
to move making the butchering look even more real."

flags
   {UNIT_FL_NO_TELEPORT,UNIT_FL_INDOORS,UNIT_FL_NO_WEATHER }
movement SECT_INSIDE

ALWAYS_LIGHT

east to sk_throne_ante descr "The antechamber.";
north to sk_temple02 descr "At the temple altar.";

end /* sk_temple01 */


			sk_temple02
names {"sk_temple02"}
title "Before the temple altar"
descr "Large steps lead up to the temple altar that dominates this room. It
has been cleaned recently but red stains tell you that some of the blood
that has been on this altar can't be removed, possibly not even by magical
means. The room is otherwise sober, no fancy decorations line the walls. It
seems that it is used for ceremonial purposes only."

extra {"altar"}
"It is carved out of solid rock and has been laid in with fragments of bone
that form what probably are runes. You can see red stains where the blood
has soaked into the stone so deep it can't be removed."

flags
   {UNIT_FL_NO_TELEPORT,UNIT_FL_INDOORS,UNIT_FL_NO_WEATHER }
movement SECT_INSIDE

ALWAYS_LIGHT

south to sk_temple01 descr "The skull fortress temple.";

end /* sk_temple02 */


			sk_mil_room
names {"sk_mil_room"}
title "The skull fortress military room"
descr "Here Irchak comes to check on the progress of the blood war. There is
a large wooden table here that has an odd feature. The tabletop is not all
wood, all but the outer five inches is a crystal window that you can look
into. There is a chalkboard on the wall. You can go west to the
antechamber."

extra {"crystal window","window","crystal"}
"When you look into the crystal window you see only darkness, hmm maybe this
table needs some further examining."

extra {"table"}
"As you examine the table more closely you see there are a &crbutton&cw and
a small &crtrackball&cw mounted on the side of the tabletop."

extra {"button"}
"&l
  _____
 |     |
 |&cy~PwR~&cw|
 |_____|

Maybe you should try to &cbpush&cw the &cbbutton&cw?"

extra {"trackball","ball"}
"Maybe you could &cbroll&cw the &cbball&cw? What a wonderful toy!"

extra {"chalkboard","board"}
"&l
&c+n        _                 _
       | |               |V|
       |M|               |A|
 ______|O|______   ______|S|______
|______ R ______| |______ S ______|
       |N|               |L|
       |I|               |I|
       |C|               |U|
       |K|               |S|
      _|_|_             _|_|_
&cg    ^'     `^`^'~^~`^'^'     `^&cw"

flags
   {UNIT_FL_NO_TELEPORT,UNIT_FL_INDOORS,UNIT_FL_NO_WEATHER }
movement SECT_INSIDE

ALWAYS_LIGHT

west to sk_throne_ante descr "The antechamber.";

dilbegin use_map();

var
   pc	: unitptr;

code {

:start:
   heartbeat := PULSE_SEC*4;
   wait(SFB_CMD,command(CMD_PUSH) and ("button" in argument));
   block;
   pc := activator;
   act("You push the button on the table and hear a soft humming sound.",
      A_ALWAYS,pc,null,null,TO_CHAR);
   act("$1n pushes the button on the table. You hear a soft humming sound.",
      A_ALWAYS,pc,null,null,TO_REST);
   pause;
   wait(SFB_CMD,command(CMD_ROLL) and ("ball" in argument));
   block;
   pc := activator;
   secure(pc,lost_pc);
   act("You roll the trackball and look into the table.",
      A_ALWAYS,pc,null,null,TO_CHAR);
   act("$1n rolls the trackball and looks into the table.",
      A_ALWAYS,pc,null,null,TO_REST);
   pause;
   act("The darkness in the crystal window fades away and is replaced by "+
      "a birdseye view of a dark and fiery landscape.",
      A_ALWAYS,self,null,null,TO_CHAR);
   pause;
   act("The view zooms in on the landscape below and you start to discern "+
      "a large group of figures crawling among each other like ants.",
      A_ALWAYS,pc,null,null,TO_CHAR);
   pause;
   act("As the view comes even closer you see that it is a large group of "+
      "demons of various sorts murdering each other.",
      A_ALWAYS,pc,null,null,TO_CHAR);
   pause;
   act("Greater demons grab smaller ones and rip them apart using their "+
      "mighty claws.",A_ALWAYS,pc,null,null,TO_CHAR);
   pause;
   act("On one side a general is desperately trying to organize the "+
      "efforts of his army.",A_ALWAYS,pc,null,null,TO_CHAR);
   pause;
   act("On the other side chaos reigns supreme.",
      A_ALWAYS,pc,null,null,TO_CHAR);
   pause;
   act("As the view fades you realize that you have just seen the reality "+
      "that is called the Blood War.",A_ALWAYS,pc,null,null,TO_CHAR);
   pause;
   unsecure(pc);
   act("The button on the table springs out with a click.",
      A_ALWAYS,pc,null,null,TO_ALL);
   goto start;

:lost_pc:
   unsecure(pc);
   act("The button on the table springs out with a click.",
      A_ALWAYS,pc,null,null,TO_ALL);
   goto start;

}
dilend /* use_map */

end /* sk_mil_room */


			sk_throne_room
names {"sk_throne_room"}
title "Before Goruk's throne"
descr "As you enter the throne room you are overwhelmed by the presence of
a tremendous power. A starless night enters your mind and you sense a numb
and empty feeling entering your bones. A large throne is placed against the
north wall, big enough to set a very large person. Streaks of red mist swirl
around it. The ceiling is decorated with a myriad of skulls of different
race and size hanging from a large spidery web. You realize that what
impresses you about this room is not the decoration, it's Goruk's power."

extra {"throne"}
"The throne is simple in design. Apart from it being large only the red mist
swirling about it makes it look like might be more to it. You are tempted to
&cbsit&cw down on the &cbthrone&cw and feel the power it holds."

extra {"skulls","skull"}
"Truly an amazing collection."

extra {"web","webs"}
"You don't want to know what foul creature spun these."

spell 50

flags
   {UNIT_FL_NO_TELEPORT,UNIT_FL_INDOORS,UNIT_FL_NO_WEATHER }
movement SECT_INSIDE

ALWAYS_LIGHT

south to sk_throne_ante descr "The antechamber.";
east to sk_symbol_room open {EX_OPEN_CLOSE,EX_CLOSED,EX_LOCKED,EX_HIDDEN}
   key lord_key keyword {"secret door","door","wall"};
SECRET_DOOR_DIFFICULTY(EAST,50)

dilbegin throne_penalty();

var
   pc		: unitptr;
   result	: integer;

code {

:init:
   heartbeat := PULSE_SEC*1;
:start:
   wait(SFB_CMD,command(CMD_SIT) and ("throne" in argument));
   block;
   pc := activator;
   secure(pc,lost_pc);
   act("You sit down on the throne.",A_ALWAYS,pc,null,null,TO_CHAR);
   act("$1n sits down on the throne.",A_ALWAYS,pc,null,null,TO_REST);
   pause;
   act("A voice booms in your head.",A_ALWAYS,pc,null,null,TO_CHAR);
   act("Feel my wrath filthy mortal!",A_ALWAYS,pc,null,null,TO_CHAR);
   result := cast_spell(SPL_LIGHTNING_2,pc,self,pc,"throne_effect@abyss1");
   unsecure(pc);
   goto start;

:lost_pc:
   unsecure(pc);
   goto start;

}

dilend /* throne_penalty */

end /* sk_throne_room */


			sk_symbol_room
names {"sk_symbol_room"}
title "A secret room in the skull fortress"
descr "You have entered a secret room that is empty exept for a large arcane
symbol that is traced on the floor. Wisps of red smoke swirl in a tornado
like fashion above it."

extra {"symbol"}
"It is circular in shape and is formed of runes that you don't understand.
You can discern faces in the symbol though. One of them resembles Goruk.
Maybe you could enter the symbol?"

extra {"tornado of red smoke","tornado","smoke"}
"This tornado is most likely magical in nature."

flags
   {UNIT_FL_NO_TELEPORT,UNIT_FL_INDOORS,UNIT_FL_NO_WEATHER }
movement SECT_INSIDE

ALWAYS_LIGHT

west to sk_throne_room open {EX_OPEN_CLOSE,EX_CLOSED,EX_LOCKED,EX_HIDDEN}
   key lord_key keyword {"secret door","door","wall"};
SECRET_DOOR_DIFFICULTY(WEST,50)

dilcopy symbol_enter@abyss1("lords_room@abyss1");

end /* sk_symbol_room */

/* 3rd floor */


			sk_bot01
names {"sk_bot01"}
title "In middle of a filthy corridor"
descr "Unlike the corridor one floor up this one is filled with trash and
muck. No torches light it and there is a distinct smell of decay hanging in
the air. To the north there is an arch filled with rotting flesh but it
looks thin enough to force your way through. The corridor also leads south,
your knowledge of anatomy tells you that the nose might be located there.
You can go east and west to the corridor's ends."

extra {"corridor"}
"Definately very filthy."

extra {"staircase","stairs","stair","spiral"}
"It consists entirely of bones of different size and shape spiraling up
around the backbone of some dead wyrm. The bones are bound together with
sinews."

extra {"trash and muck","trash","muck"}
"This corridor has not been cleaned in ages, if ever."

extra {"arch","curtain"}
"It looks like a normal arch that you can walk through. But walking through
the decaying flesh is not something that you'll do gladly."

extra {"decaying flesh","flesh"}
"This flesh has been dead a long time. *yuck*"

flags
   {UNIT_FL_NO_TELEPORT,UNIT_FL_INDOORS,UNIT_FL_NO_WEATHER }
movement SECT_INSIDE

OUT_ALWAYS_DARK

east to sk_bot02 descr "East end of the filthy corridor.";
west to sk_bot03 descr "West end of the filthy corridor.";
up to sk_mid01 descr "Middle of a torch lit corridor.";
north to sk_room_death descr "The room of death.";
south to sk_nose descr "At the skull's nose.";

OUT_ALWAYS_DARK

end /* sk_bot01 */


			sk_bot02
names {"sk_bot02"}
title "East end of a filthy corridor"
descr "Muck and filth covers the floor. To the north you see an archway with
a curtain of spiked chains hanging in it. It allows you to go through but it
might hurt . There is also a hole in the floor and as you look down into it
you see that it allows you to climb onto the skull's lower jaw. To the west
lies the center of this corridor."

extra {"corridor"}
"Somebody ought to clean this up!"

extra {"hole"}
"This hole is big enough to allow you to climb through."

extra {"arch"}
"You can walk through but those chains are going to hurt!"

extra {"spiked chains","chains"}
"They are like normal chains exept for the razorsharp spikes that are on
them."

flags {UNIT_FL_NO_TELEPORT,UNIT_FL_INDOORS,UNIT_FL_NO_WEATHER,
    UNIT_FL_NO_MOB}
movement SECT_INSIDE

OUT_ALWAYS_DARK

west to sk_bot01 descr "In the middle of a filthy corridor.";
north to sk_room_cruelty descr "The room of cruelty.";
down to sk_jaw01 descr "On the skull's lower jaw.";

end /* sk_bot02 */


			sk_bot03
names {"sk_bot03"}
title "West end of a filthy corridor"
descr "As you walk through the muck you notice an arch, raining blood to the
north. It allows you to step through and enter the room beyond. A hole has
been crafted in the floor for climbing down onto the skull's lower jaw. To
the east you can go to the middle of this filthy corridor."

extra {"corridor"}
"The walls, ceiling and even floor that form the corridor are also made out
of bone. They look like they have always been here inside this skull, but
you never saw compartments in any skull that you have split in the past.
It really makes you wonder."

extra {"corridor"}
"Somebody ought to clean this up!"

extra {"hole"}
"This hole is big enough to allow you to climb through."

extra {"arch"}
"You can walk through but getting wet with blood doesn't sound nice."

extra {"blood"}
"As you catch a little drop on your hand and test it you see that it is
indeed real blood."

flags {UNIT_FL_NO_TELEPORT,UNIT_FL_INDOORS,UNIT_FL_NO_WEATHER,
    UNIT_FL_NO_MOB}
movement SECT_INSIDE

OUT_ALWAYS_DARK

east to sk_bot01 descr "In the middle of a filthy corridor.";
north to sk_room_blood descr "The room of blood.";
down to sk_jaw02 descr "On the skull's lower jaw.";

end /* sk_bot03 */


			sk_nose
names {"sk_nose"}
title "At the skull's nose"
descr "You are standing in front of two nose holes but they pretty are big
compared to yours. As you stick your head through one of them you can see
the pit outside. You have descended too low to be able to see the pit's rim
though. You can go back north to the filthy corridor."

extra {"nose holes","nose","holes","hole"}
"You marvel at the amounts of snot that could theoreticaly pass through
them. It could bury you!"

flags
   {UNIT_FL_NO_TELEPORT,UNIT_FL_INDOORS,UNIT_FL_NO_WEATHER }
movement SECT_INSIDE

ALWAYS_LIGHT

north to sk_bot01 descr "In the middle of a filthy corridor.";

end /* sk_nose */


			sk_room_death
names {"sk_room_death"}
title "The room of death and decay"
descr "You have entered a room full of corpses and other decaying things. A
horrible smell fills your nostrils making your stomach twist into a knot.
The walls are not bone as they are elsewhere in this skull but flesh as are
the floor and ceiling. Walking on the soft rubbery floor is not easy, making
it hard to stay secure on your feet. To the south you can go back through
the arch and the rotting curtain to the filthy corridor beyond."

extra {"corpses","corpse"}
"The corpses are in various states of decay, but none of the original
features on any of their faces can be discerned."

extra {"things","thing"}
"You can also see limbs, organs and other loose things rotting away."

extra {"room","walls","wall","floor","ceiling"}
"This looks very strange, it gives you the feeling you're actually inside
some kind of undead."

extra {"arch","curtain"}
"It looks like a normal arch that you can walk through. But walking through
the decaying flesh is not something that you'll do gladly."

flags
   {UNIT_FL_NO_TELEPORT,UNIT_FL_INDOORS,UNIT_FL_NO_WEATHER }
movement SECT_INSIDE

ALWAYS_LIGHT

south to sk_bot01 descr "In the middle of a filthy corridor.";

end /* sk_room_death */


			sk_room_cruelty
names {"sk_room_cruelty"}
title "The room of cruelty and torture"
descr "This room is made of cold black steel. A terrible cold wind bites
into your body making you want to snuggle up in your cloak. Around you are
various torturing utensils like thumb screws, whips and other even nastier
looking things. You can leave back south through the south arch and the
curtain of chains."

extra {"black steel","steel","room"}
"Cold seeps into your bones as you touch it."

extra {"torturing utensils","utensils"}
"What a nasty collection."

extra {"thumbscrews","thumbscrew"}
"*ouch*"

extra {"whips","whip"}
"You shiver at the thought of the pain that these could inflict."

extra {"arch","curtain"}
"The spiked chains hanging in the arch match this room perfectly. The spikes
are like thorns longing to rip your flesh."

flags
   {UNIT_FL_NO_TELEPORT,UNIT_FL_INDOORS,UNIT_FL_NO_WEATHER }
movement SECT_INSIDE

ALWAYS_LIGHT

south to sk_bot02 descr "East end of a filthy corridor.";

end /* sk_room_cruelty */


			sk_room_blood
names {"sk_room_blood"}
title "The room of murder and blood"
descr "As you enter the room you find yourself sloshing through a pool of
blood about eight inches deep. The walls and ceiling here are bone as most
are in this fortress but they are bleeding through fractures and cracks that
run through them. In the corner lies a corpse with a dagger stuck in it's
back. You can go south through the blood raining arch to the corridor."

extra {"pool of blood","pool","blood"}
"The blood from the pool sticks to your boots. You're going to have a tough
time cleaning them."

extra {"murdered corpse","corpse","dagger"}
"This person was clearly killed by an unexpected stab in the back."

extra {"cracks and fractures","cracks","fractures"}
"These give you some idea as to what broken bones and skulls look like."

extra {"arch","curtain"}
"A small bloody waterfall fills the arch. It appears from an unseen source
and flows into the room. Despite it the depth of the pool of blood doesn't
increase."

flags
   {UNIT_FL_NO_TELEPORT,UNIT_FL_INDOORS,UNIT_FL_NO_WEATHER }
movement SECT_INSIDE

ALWAYS_LIGHT

south to sk_bot03 descr "West end of a filty corridor.";

end /* sk_room_blood */


			sk_jaw01
names {"sk_jaw01"}
title "On the skull's lower jaw."
descr "As you stand on the jaw's back teeth you notice the vast depth that
lurks below you. A steady wind makes hit hard to keep a steady footing.
There must be numerous ways to fall off. But then again you might as well
make it easy on yourself and jump off. You can leave up back to the filthy
corridor and you can go south further down the jaw."

extra {"back teeth","back tooth","teeth","tooth"}
"They are in pretty good shape but their uneven form makes it hard to stand
with this wind. If you tried to push someone off it might very well
succeed."

flags {UNIT_FL_NO_TELEPORT }
movement SECT_MOUNTAIN

dilcopy fall@abyss1(3,5,10);

up to sk_bot02 descr "East end of a filthy corridor.";
south to sk_jaw03 descr "On the skull's lower jaw.";

end /* sk_jaw01 */


			sk_jaw02
names {"sk_jaw02"}
title "On the skull's lower jaw."
descr "A strong wind and the form of the skull's back teeth make it hard to
stay afoot. You realize you have a good chance of falling off, it's even
more easy to jump off. Up from here lies the filthy corridor and you can
go south further along the jaw."

extra {"back teeth","back tooth","teeth","tooth"}
"They are in pretty good shape but their uneven form makes it hard to stand
with this wind. If you tried to push someone off it might very well
succeed."

flags {UNIT_FL_NO_TELEPORT }
movement SECT_MOUNTAIN

dilcopy fall@abyss1(3,5,10);

up to sk_bot03 descr "West end of a filthy corridor.";
south to sk_jaw04 descr "On the skull's lower jaw.";

end /* sk_jaw02 */


			sk_jaw03
names {"sk_jaw03"}
title "On the skull's lower jaw."
descr "The teeth get more pointy in form here, making it a little harder to
stay on the jaw. To the west you can see the middle of the jaw. Large clouds
of smoke billow forth from what should be the mouth through there. You can
go north to the jaw's back teeth."

extra {"teeth","tooth"}
"They are in pretty good shape but their pointy form makes it very hard to
stay on your feet. Pushing someone off must be very easy here."

flags {UNIT_FL_NO_TELEPORT }
movement SECT_MOUNTAIN

dilcopy fall@abyss1(3,5,10);

north to sk_jaw01 descr "On the skull's lower jaw.";
west to sk_jaw05 descr "Middle of the skull's lower jaw.";

end /* sk_jaw03 */


			sk_jaw04
names {"sk_jaw04"}
title "On the skull's lower jaw."
descr "Here the teeth are beginning to get a pointy form making traveling
the jaw more hazardous. To the east lies the middle of the jaw. Clouds of
red smoke billow forth through there. You can go back north to the skull's
back teeth and the relatively safe corridor beyond."

extra {"teeth","tooth"}
"They are in pretty good shape but their pointy form makes it very hard to
stay on your feet. Pushing someone off must be very easy here."

flags {UNIT_FL_NO_TELEPORT }
movement SECT_MOUNTAIN

dilcopy fall@abyss1(3,5,10);

north to sk_jaw02 descr "On the skull's lower jaw.";
east to sk_jaw05 descr "Middle of the skull's lower jaw.";

end /* sk_jaw04 */


			sk_jaw05
names {"sk_jaw05"}
title "The middle of the skull's lower jaw."
descr "You are surrounded by smoke that seems to come out of nowhere. A
small breeze makes it look like the skull is breathing the smoke out. The
razor sharp teeth make this a dangerous place. You have to use all your
dexterous skills to stay afoot. The pit beckons below you. You can leave
east and west travel back to the skull's interior and you feel very much
like doing so."

extra {"teeth","tooth"}
"They are in pretty good shape but their sharp form makes it very hard to
stay on your feet. Pushing someone off must be very easy here."

flags {UNIT_FL_NO_TELEPORT }
movement SECT_MOUNTAIN

dilcopy fall@abyss1(5,10,15);

east to sk_jaw03 descr "On the skull's lower jaw.";
west to sk_jaw04 descr "On the skull's lower jaw.";

end /* sk_jaw05 */

/*
   The room below is not really serving a purpose at the moment but can be
   used in new quests.
*/

			lords_room
names {"lords_room"}
title "The room of Abyssal Lords."
descr "You have entered a large circular room carved out of black granite.
On the walls all around you are ancient reliefs depicting the various
inhabitants of the Abyss. The room is large enough to hold a great number of
demons. In the center you see a symbol like the one that you entered to get
here. There are no other exits."

extra {"reliefs","relief"}
"The demons are all engrossed in different evil deeds."

extra {"symbol"}
"It is circular in shape and is formed of runes that you don't understand.
You can discern faces in the symbol though. One of them resembles Goruk.
Maybe you could enter the symbol?"

flags
   {UNIT_FL_NO_TELEPORT,UNIT_FL_INDOORS,UNIT_FL_NO_WEATHER }
movement SECT_MOUNTAIN

ALWAYS_LIGHT

dilcopy symbol_enter@abyss1("sk_symbol_room@abyss1");

end /* sk_jaw05 */

/* ---------------------- PLAIN OF ASH ROOMS -------------------------- */

			ash_01
names {"ash_01"}
title "The edge of the plain of ash"
descr "As you look north into the infinitely deep abyss you see a lonely
spire rising up a few hundered yards north from here. Somewhere to your east
lies a large dark looking pit and you can discern something that looks like
a very large chain. The plain stretches out to the south and west."

extra {"spire"}
"Considering the depth of the abyss this spire must be very long!"

extra {"pit"}
"It's pretty large and darkness seems to emenate from it."

extra {"chain"}
"You're still too far away to see clearly."

ASH_EXTRA

flags {UNIT_FL_NO_TELEPORT ,UNIT_FL_NO_WEATHER}
movement SECT_FIELD

east to w_o_pit descr "West of the dark pit.";
west to ash_02 descr "Edge of the plain of ash.";
south to ash_03 descr "The plain of ash.";

end /* ash_01 */


			ash_02
names {"ash_02"}
title "The edge of the plain of ash"
descr "As the ash soil gets more solid you notice that you are approaching
the north end of this plain where it stops to make place for the abyss. Some
distance into the abyss you see a tall slender spire standing all alone.
To the south you see a strange form rising out of the ground. You can also
go east from here."

extra {"spire"}
"Considering the depth of the abyss this spire must be very long!"

extra {"strange form","strange shape","form","shape"}
"Looking from here you think it resembles a hand."

ASH_EXTRA

flags {UNIT_FL_NO_TELEPORT ,UNIT_FL_NO_WEATHER}
movement SECT_FIELD

west to ash_13 descr "Edge of the plain of ash.";
east to ash_01 descr "Edge of the plain of ash.";
south to ash_04 descr "A hand in the ash.";

end /* ash_02 */


			ash_03
names {"ash_03"}
title "The edge of the plain of ash"
descr "The smell of burnt bodies rises from the ashes as you walk across the
plain. A blood red cloudless sky is above you. To your west you see a
strange form rising from the ground and to the south you see a small pointy
hill. North and east the plain continues although it seems to end beyond in
both directions."

extra {"small pointy hill","hill"}
"It rises out of the ground very abruptly. It doesn't seem natural at all."

extra {"strange form","strange shape","form","shape"}
"Looking from here you think it resembles a hand."

ASH_EXTRA

flags {UNIT_FL_NO_TELEPORT ,UNIT_FL_NO_WEATHER}
movement SECT_FIELD

north to ash_01 descr "Edge of the plain of ash.";
west to ash_04 descr "A hand in the ash.";
south to ash_06 descr "A knee in the ash.";
east to ash_07 descr "Edge of the plain of ash.";

end /* ash_03 */


			ash_04
names {"ash_04"}
title "A hand rising from the ashes"
descr "Rising from the ashes you see a huge stone hand twitched in a spasm.
It is visible from the wrist up. To the west you see a strangely shaped hill
and south a small spire rises. You can also travel north to the edge of the
plain and east."

extra {"strangely shaped hill","hill"}
"As you try to focus you think it might be the front of a face rising from
the plain."

extra {"spire"}
"Hmm. Not much you can tell at this distance."

extra {"large stone hand","hand"}
"It rises up and looks like it is desperately trying to hold on to some
unseen round object."

ASH_EXTRA

flags {UNIT_FL_NO_TELEPORT ,UNIT_FL_NO_WEATHER}
movement SECT_FIELD

north to ash_02 descr "Edge of the plain of ash.";
west to ash_08 descr "A face in the ash.";
south to ash_05 descr "A spire in the ash.";
east to ash_03 descr "The plain of ash.";

end /* ash_04 */


			ash_05
names {"ash_05"}
title "A small spire rising from the ashes"
descr "As you come upon the relatively small spire you wonder if it goes
with the other body parts you've come across so far. The fact that it has
been subject to erosion makes it hard to tell. To the north and west strange
forms rise up from the plain. East and south two small pointy looking hills
can be seen."

extra {"strange form","strange shape","form","shape"}
"Looking from here you think it resembles a hand."

extra {"small pointy hill","hill"}
"It rises out of the ground very abruptly. It doesn't seem natural at all."

extra {"spire"}
"As you look closer you think the colour of the spire's stone is different
from that of the other body parts. It probably stands on itself."

ASH_EXTRA

flags {UNIT_FL_NO_TELEPORT ,UNIT_FL_NO_WEATHER}
movement SECT_FIELD

north to ash_04 descr "A hand in the ash.";
west to ash_09 descr "A hand in the ash.";
south to ash_11 descr "A knee in the ash.";
east to ash_06 descr "A knee of ash.";

end /* ash_05 */


			ash_06
names {"ash_06"}
title "A knee rising from the ashes"
descr "When you come upon the strange hill you see that it's in fact the
stone knee of a very large, more or less bent leg sticking out of the ash.
To the west a small spire rises. The plain continues in all other
directions."

extra {"spire"}
"Hmm. Not much you can tell at this distance."

extra {"knee","hill"}
"With knees like that you would be able to carry a lot of weight. But being
that size might have it's complications too."

ASH_EXTRA

flags {UNIT_FL_NO_TELEPORT ,UNIT_FL_NO_WEATHER}
movement SECT_FIELD

north to ash_03 descr "The plain of ash.";
west to ash_05 descr "A spire in the ash.";
south to ash_12 descr "The plain of ash.";
east to ash_10 descr "The plain of ash.";

end /* ash_06 */


			ash_07
names {"ash_07"}
title "The edge of the plain of ash"
descr "A large dark pit prevents you from traveling east. As you look into
it you see a huge skull hanging from four large chains. One of the chains
originates north from here. You can also go west further into the plain or
south along the pit."

extra {"chains","chain"}
"The chains are wrought of cold looking black steel."

extra {"skull","palace","fortress"}
"From here it seems the skull is made of solid bone. It looks human, but you
can't imagine a human being this big. From here you see the left side and
what looks like an entrance on top of it."

extra {"pit","dark pit"}
"The dark pit is five hundred yards across. And so deep you can only see
ever darkening night when you look down into it. You are at the west side
of it."

ASH_EXTRA

flags {UNIT_FL_NO_TELEPORT ,UNIT_FL_NO_WEATHER}
movement SECT_FIELD

north to w_o_pit descr "West of the dark pit.";
west to ash_03 descr "The plain of ash.";
south to ash_10 descr "The plain of ash.";

end /* ash_07 */


			ash_08
names {"ash_08"}
title "At a face rising from the ashes"
descr "The front half of a large face comes out of the ground here. A small
part of the ears is hardly visible. It was frozen into stone while in great
pain judging from the the look on it. The mouth is open wide as if the
person was screaming in agony. You also hear a faint howling sound here. Two
strangely formed shapes rise from the ash south and east of here. You can
also go north and west."

extra {"face in agony","face","hill"}
"This giant person must have suffered greatly before being turned to stone.
You wonder if he suffers still."

extra {"strange form","strange shape","form","shape"}
"Looking from here you think it resembles a hand."

extra {"screaming mouth","mouth"}
"It's frozen in what must have been a scream from agonizing pain."

ASH_EXTRA

flags {UNIT_FL_NO_TELEPORT ,UNIT_FL_NO_WEATHER}
movement SECT_FIELD

north to ash_13 descr "Edge of the plain of ash.";
west to ash_14 descr "At the endless cliffs in the plain of ash.";
south to ash_09 descr "A hand in the ash.";
east to ash_04 descr "A hand in the ash.";
up to ash_face descr "The face";

end /* ash_08 */


			ash_09
names {"ash_09"}
title "A hand rising from the ashes"
descr "A strong looking hand turned to stone rises from the ashes here. It
looks like it was desperately trying to get hold of something just before it
froze. To the north you see a strangely shaped hill and to the east a small
spire rises. You can also travel west and south from here."

extra {"strangely shaped hill","hill"}
"As you try to focus you think it might be the front of a face rising from
the plain."

extra {"spire"}
"Hmm. Not much you can tell at this distance."

extra {"large stone hand","hand"}
"It rises up and looks like it is desperately trying to hold on to some
unseen round object."

ASH_EXTRA

flags {UNIT_FL_NO_TELEPORT ,UNIT_FL_NO_WEATHER}
movement SECT_FIELD

west to ash_15 descr "Edge of the plain of ash.";
north to ash_08 descr "A face in the ash.";
south to ash_17 descr "A spire in the ash.";
east to ash_05 descr "The plain of ash.";

end /* ash_09 */


			ash_10
names {"ash_10"}
title "The edge of the plain of ash"
descr "Walking under the blood red sky you see a large dark pit to the
north-east with a huge skull hanging from four chains in it.The southern
side of the pit lies to the east while the west side lies north of here.
To the west an unnatural looking hill can be seen and you can travel south
along the edge of the plain."

extra {"small pointy hill","hill"}
"It rises out of the ground very abruptly. It doesn't seem natural at all."

extra {"chains","chain"}
"The chains are wrought of cold looking black steel."

extra {"skull","palace","fortress"}
"From here it seems the skull is made of solid bone. It looks human, but you
can't imagine a human being this big. From here you see the front left side
and what looks like an entrance on top of it."

extra {"pit","dark pit"}
"The dark pit is five hundred yards across. And so deep you can only see
ever darkening night when you look down into it. You are at the west side
of it."

ASH_EXTRA

flags {UNIT_FL_NO_TELEPORT ,UNIT_FL_NO_WEATHER}
movement SECT_FIELD

north to ash_07 descr "Edge of the plain of ash.";
south to ash_21 descr "Edge of the plain of ash.";
west to ash_06 descr "A knee in the ash..";
east to around_pit01 descr "South of the pit.";

end /* ash_10 */


			ash_11
names {"ash_11"}
title "A knee rising from the ashes"
descr "A large knee frozen in a bent position emerges from the ash soil.
Judging from it's size the owner must be very big. A sudden gust of wind
blows ash in to your eyes, but to the north you can still see a small spire.
The plain continues in all other directions."

extra {"spire"}
"Hmm. Not much you can tell at this distance."

extra {"knee","hill"}
"With knees like that you would be able to carry a lot of weight. But being
that size might have it's complications too."

ASH_EXTRA

flags {UNIT_FL_NO_TELEPORT ,UNIT_FL_NO_WEATHER}
movement SECT_FIELD

south to ash_19 descr "At the endless cliffs in plain of ash.";
north to ash_05 descr "A spire in the ash.";
west to ash_17 descr "The plain of ash.";
east to ash_12 descr "The plain of ash.";

end /* ash_11 */


			ash_12
names {"ash_12"}
title "The plain of ash"
descr "Toiling through the desert-like ash under a sunless sky, you start
to wonder what it is you are doing here. The plain continues in all
directions. To the north and west two small pointy hills are the only
landmarks you can see."

extra {"small pointy hill","hill"}
"It rises out of the ground very abruptly. It doesn't seem natural at all."

ASH_EXTRA

flags {UNIT_FL_NO_TELEPORT ,UNIT_FL_NO_WEATHER}
movement SECT_FIELD

east to ash_21 descr "Edge of the plain of ash.";
south to ash_20 descr "Edge of the plain of ash.";
north to ash_06 descr "A knee in the ash.";
west to ash_11 descr "A knee in the ash.";

end /* ash_12 */


			ash_13
names {"ash_13"}
title "The edge of the plain of ash"
descr "Large cliffs so high you can't even see their end block the way
west. As you study them a little from a distance you notice an upturned claw
asticking out a few hundred metres above you with a birdlike creature
sitting on it. North the abyss prevents you from going any further so making
south and east the only directions you can travel."

extra {"strangely shaped hill","hill"}
"As you try to focus you think it might be the front of a face rising from
the plain."

ASH_EXTRA

flags {UNIT_FL_NO_TELEPORT ,UNIT_FL_NO_WEATHER}
movement SECT_FIELD

east to ash_02 descr "Edge of the plain of ash.";
south to ash_08 descr "A face in the ash.";

end /* ash_13 */


			ash_14
names {"ash_14"}
title "The edge of the plain of ash"
descr "To the west lies an enourmous cliff wall that continues south along
the plain. A strangely shaped hill can be seen east of here. The plain also
continues south. The cliffs are so high they seem to disappear into the
blood red sky."

extra {"strangely shaped hill","hill"}
"As you try to focus you think it might be the front of a face rising from
the plain."

extra {"cliff wall","cliffs","cliff"}
"They appear to be granite cliffs and have large cracks running through them
at places. Other than that there are no irregularities on them, making them
impossible to climb."

ASH_EXTRA

flags {UNIT_FL_NO_TELEPORT ,UNIT_FL_NO_WEATHER}
movement SECT_FIELD

south to ash_15 descr "Edge of the plain of ash.";
east to ash_08 descr "A face in the ash.";

end /* ash_14 */


			ash_15
names {"ash_15"}
title "The edge of the plain of ash"
descr "The depth of the ash suddenly becomes deeper here making it hard to
keep a steady pace. An enourmous cliff wall that continues north and south
along the plain blocks the ways west. A strange shape coming from the soil
can be seen east of here. You can also travel along the plain's edge north
and south."

extra {"cliff wall","cliffs","cliff"}
"They appear to be granite cliffs and have large cracks running through them
at places. Other than that there are no irregularities on them, making them
impossible to climb."

extra {"strange form","strange shape","form","shape"}
"Looking from here you think it resembles a hand."

ASH_EXTRA

flags {UNIT_FL_NO_TELEPORT ,UNIT_FL_NO_WEATHER}
movement SECT_FIELD

south to ash_16 descr "Edge of the plain of ash.";
north to ash_14 descr "Edge of the plain of ash.";
east to ash_09 descr "A face in the ash.";

end /* ash_15 */


			ash_16
names {"ash_16"}
title "The edge of the plain of ash"
descr "Ash whirls up as you walk on. It clogs your nostrils and at times it
is knee deep, making difficult to travel. The unscalable cliff wall turns
here and makes travel west and south impossible. You can however travel to
the north and east from here."

extra {"cliff wall","cliffs","cliff"}
"They appear to be granite cliffs and have large cracks running through them
at places. Other than that there are no irregularities on them, making them
impossible to climb."

ASH_EXTRA

flags {UNIT_FL_NO_TELEPORT ,UNIT_FL_NO_WEATHER}
movement SECT_FIELD

north to ash_15 descr "Edge of the plain of ash.";
east to ash_17 descr "A face in the ash.";

end /* ash_16 */


			ash_17
names {"ash_17"}
title "The plain of ash"
descr "While toiling through this gray landscape, you notice a strange form
rising from the ash to the north and a pointy little hill to the east. You
can travel west and south towards a great cliff wall that borders the
plains."

extra {"strange form","strange shape","form","shape"}
"Looking from here you think it resembles a hand."

extra {"small pointy hill","hill"}
"It rises out of the ground very abruptly. It doesn't seem natural at all."

ASH_EXTRA

flags {UNIT_FL_NO_TELEPORT ,UNIT_FL_NO_WEATHER}
movement SECT_FIELD

north to ash_09 descr "A hand in the ash.";
east to ash_11 descr "A knee in the ash.";
west to ash_16 descr "Edge of the plain of ash.";
south to ash_18 descr "Edge of the plain of ash.";

end /* ash_17 */


			ash_18
names {"ash_18"}
title "The edge of the plain of ash"
descr "The plain of ash end abrubtly as huge granite cliffs block passage to
the south and west. They tower above you and you are unable to determine
where they end or if they even do. You can go north into the plain of ash or
walk along the cliffs to the east."

extra {"cliff wall","cliffs","cliff"}
"They appear to be granite cliffs and have large cracks running through them
at places. Other than that there are no irregularities on them, making them
impossible to climb."

ASH_EXTRA

flags {UNIT_FL_NO_TELEPORT ,UNIT_FL_NO_WEATHER}
movement SECT_FIELD

north to ash_17 descr "The plain of ash.";
east to ash_19 descr "The edge of the plain of ash.";

end /* ash_18 */


			ash_19
names {"ash_19"}
title "The edge of the plain of ash"
descr "You have reached the southern border of the plain of ash. You can
travel along the gigantic cliff wall that blocks your way to the east and
west. To the north you can discern a small pointy looking hill that doesn't
looks natural at all."

extra {"cliff wall","cliffs","cliff"}
"They appear to be granite cliffs and have large cracks running through them
at places. Other than that there are no irregularities on them, making them
impossible to climb."

extra {"small pointy hill","hill"}
"It rises out of the ground very abruptly. It doesn't seem natural at all."

ASH_EXTRA

flags {UNIT_FL_NO_TELEPORT ,UNIT_FL_NO_WEATHER}
movement SECT_FIELD

north to ash_11 descr "The plain of ash.";
east to ash_20 descr "The edge of the plain of ash.";
west to ash_18 descr "The edge of the plain of ash.";

end /* ash_19 */


			ash_20
names {"ash_20"}
title "The edge of the plain of ash"
descr "Enormous cliffs so high that you can't see where they end prevent
travel to the south and east. You can however travel west along the cliffs
or north deeper into the plain."

extra {"cliff wall","cliffs","cliff"}
"They appear to be granite cliffs and have large cracks running through them
at places. Other than that there are no irregularities on them, making them
impossible to climb."

ASH_EXTRA

flags {UNIT_FL_NO_TELEPORT ,UNIT_FL_NO_WEATHER}
movement SECT_FIELD

north to ash_12 descr "The plain of ash.";
west to ash_19 descr "The edge of the plain of ash.";

end /* ash_20 */


			ash_21
names {"ash_21"}
title "The edge of the plain of ash"
descr "This is the eastern border of the the plains of ash. To the east you
see the banks of the legendary river Styx. You can travel the ash covered
plains to the north and west. Large cliffs block the way south."

extra {"cliff wall","cliffs","cliff"}
"They appear to be granite cliffs and have large cracks running through them
at places. Other than that there are no irregularities on them, making them
impossible to climb."

ASH_EXTRA

flags {UNIT_FL_NO_TELEPORT ,UNIT_FL_NO_WEATHER}
movement SECT_FIELD

north to ash_10 descr "The edge of the plain of ash.";
west to ash_12 descr "The plain of ash.";
east to styx_bank01 descr "On the bank of the river styx.";

end /* ash_21 */


			ash_face
names {"ash_face"}
title "On a face."
descr "You are standing on top of the huge stone face. Although touched by
erosion all of it's features look shockingly real. You can't help but think
that this once might have been a living creature. The mouth is opened in a
silent scream."

extra {"nose"}
"It's ... well ... BIG!"

extra {"eyes"}
"You wonder if these stone eyes can still see."

extra {"mouth"}
"It is wide open. Perhaps you should enter it?"

extra {"blood red sky","sky"}
"No sun lights it although some form of light emenates from it."

flags {UNIT_FL_NO_TELEPORT ,UNIT_FL_NO_WEATHER}
movement SECT_FIELD

dilbegin enter_mouth();

var
   pc	: unitptr;

code {

:init:
   heartbeat := PULSE_SEC*1;
:start:
   wait(SFB_CMD,command("enter") & ("mouth" in argument));
   block;
   pc := activator;
   secure(pc,lost_pc);
   act("$1n enters the mouth.",A_SOMEONE,pc,null,null,TO_REST);
   act("You enter the mouth.",A_ALWAYS,pc,null,null,TO_CHAR);
   link(pc,findroom("ash_mouth@abyss1"));
   act("$1n enters the mouth.",A_SOMEONE,pc,null,null,TO_REST);
   exec("look",pc);
   unsecure(pc);
   pause;
   goto start;

:lost_pc:
   unsecure(pc);
   goto start;

}
dilend /* enter_mouth */

down to ash_08 descr "A face in the plane of ash.";

end /* ash_face */


			ash_mouth
names {"ash_mouth"}
title "Inside the mouth."
descr "You have entered the mouth of the stone face. You see large rows of
teeth all around you. You think it's possible to slide down the tongue into
the oesophagus. The rows of teeth provide enough hand and footholds to exit
the mouth."

extra {"teeth"}
"You notice a small hole here and there. Good thing stone mouths can't have
bad breath."

extra {"tongue"}
"It leads right down into the throat."

flags {UNIT_FL_NO_TELEPORT ,UNIT_FL_NO_WEATHER}
movement SECT_FIELD

dilbegin enter_belly();

var
   pc	: unitptr;

code {

:init:
   heartbeat := PULSE_SEC*1;
:start:
   wait(SFB_CMD,command("slide") and
      (("tongue" in argument) or ("down" in argument)));
   block;
   pc := activator;
   secure(pc,lost_pc);
   act("$1n slides down the tongue.",A_SOMEONE,pc,null,null,TO_REST);
   act("You slide down the tongue.",A_ALWAYS,pc,null,null,TO_CHAR);
   link(pc,findroom("ash_belly@abyss1"));
   act("$1n enters the belly.",A_SOMEONE,pc,null,null,TO_REST);

   exec("look",pc);
   unsecure(pc);
   pause;
   goto start;

:lost_pc:
   unsecure(pc);
   goto start;

}
dilend /* enter_belly */

dilbegin exit_mouth();

var
   pc	: unitptr;

code {

:init:
   heartbeat := PULSE_SEC*1;
:start:
   wait(SFB_CMD,command("exit"));
   block;
   pc := activator;
   secure(pc,lost_pc);
   act("$1n climbs out of the mouth.",A_SOMEONE,pc,null,null,TO_REST);
   act("You climb out of the mouth.",A_ALWAYS,pc,null,null,TO_CHAR);
   link(pc,findroom("ash_face@abyss1"));
   act("$1n emerges from the mouth.",A_SOMEONE,pc,null,null,TO_REST);
   exec("look",pc);
   unsecure(pc);
   pause;
   goto start;

:lost_pc:
   unsecure(pc);
   goto start;

}
dilend /* exit_mouth */

end /* ash_mouth */


			ash_belly
names {"ash_stomach"}
title "Inside the stomach."
descr "As you arrive in the stomach you are shocked to find out the interior
is not solid stone but soft wet flesh. There is a distinct acidic smell in
the air that makes it hard for you to breathe. Maybe it would be better to
exit the stomach as soon as you're done here."

extra {"flesh"}
"It's real!"

flags
   {UNIT_FL_NO_TELEPORT,UNIT_FL_INDOORS,UNIT_FL_NO_WEATHER }
movement SECT_FIELD

OUT_ALWAYS_DARK

dilbegin exit_belly();

var
   pc	: unitptr;

code {

:init:
   heartbeat := PULSE_SEC*1;
:start:
   wait(SFB_CMD,command("exit"));
   block;
   pc := activator;
   secure(pc,lost_pc);
   act("$1n exits the belly.",A_SOMEONE,pc,null,null,TO_REST);
   act("You exit the belly.",A_ALWAYS,pc,null,null,TO_CHAR);
   link(pc,findroom("ash_mouth@abyss1"));
   act("$1n emerges from below.",A_SOMEONE,pc,null,null,TO_REST);
   exec("look",pc);
   unsecure(pc);
   pause;
   goto start;

:lost_pc:
   unsecure(pc);
   goto start;

}
dilend /* exit_belly */

end /* ash_belly */

/* ------------------ ROOMS AROUND STYX AND PIT ----------------------- */

			around_pit01
names {"around_pit01"}
title "South of the pit"
descr "You are south of a seemingly bottomless pit. If you look down into it
you look straight into the face of a huge skull, hanging from four iron
chains. One of the chains originates east of here, while to the south you
can reach the banks of the river Styx which bends south-east of here. To the
west lies a plain of ash."

extra {"pit","dark pit"}
"The dark pit is five hundred yards across. And so deep you can only see
ever darkening night when you look down into it. You are at the south side
of it."

extra {"skull","palace","fortress"}
"From here it seems the skull is made of solid bone. It looks human, but you
can't imagine a human being this big. From here you can see the front of
the skull. It looks like there is an entrance on top of it."

extra {"chains","chain"}
"The chains are very thick and look strong enough to hold a tremendous
weight. They are wrought of black steel and are probably magically
reinforced."

extra {"ash","ground","soil"}
"The ground seems to be made out of a strange mixture of ashes and
charcoal."

extra {"blood red sky","sky"}
"No sun lights it although some form of light emenates from it."

extra {"the river Styx","styx"}
"A wise man once said: If you swim the Styx you're barmy."

flags {UNIT_FL_NO_TELEPORT ,UNIT_FL_NO_WEATHER}
movement SECT_FIELD

west to ash_10 descr "The edge of the plain of ash.";
east to s_o_pit descr "South of the pit.";
south to styx_bank01 descr "The bank of the river Styx.";

end /* around_pit01 */


			around_pit02
names {"around_pit02","vialfill"}
title "South of the pit"
descr "As you look into the pit to the north you see very large skull
hanging from four chains. A bright red light shines from the eyesockets
making it look evil. One of the chains originates west from here and the
pit's south-east corner lies east. The legendary and deadly river Styx flows
south of here."

extra {"pit","dark pit"}
"The dark pit is five hundred yards across. And so deep you can only see
ever darkening night when you look down into it. You are at the south side
of it."

extra {"skull","palace","fortress"}
"From here it seems the skull is made of solid bone. It looks human, but you
can't imagine a human being this big. From here you can see the front of
the skull. It looks like there is an entrance on top of it."

extra {"chains","chain"}
"The chains are very thick and look strong enough to hold a tremendous
weight. They are wrought of black steel and are probably magically
reinforced."

extra {"ash","ground","soil"}
"The ground seems to be made out of a strange mixture of ashes and
charcoal."

extra {"blood red sky","sky"}
"No sun lights it although some form of light emenates from it."

extra {"the river Styx","styx"}
"A wise man once said: If you swim the Styx you're barmy."

flags {UNIT_FL_NO_TELEPORT ,UNIT_FL_NO_WEATHER}
movement SECT_FIELD

west to s_o_pit descr "South of the pit.";
east to around_pit03 descr "South-east of the pit.";

end /* around_pit02 */


			around_pit03
names {"around_pit03","vialfill"}
title "South-east of the pit"
descr "Rounding the south-east corner of the pit you see the feared river
Styx flowing east and south of here. As you see a pile of broken humanoid
bones lying here a shiver runs down your spine. You can go west and north
from here."

extra {"pit","dark pit"}
"The dark pit is five hundred yards across. And so deep you can only see
ever darkening night when you look down into it. You are at the south side
of it."

extra {"skull","palace","fortress"}
"From here it seems the skull is made of solid bone. It looks human, but you
can't imagine a human being this big. From here you can see the front and
the left side of the skull. It looks like there is an entrance on top of it."

extra {"chains","chain"}
"The chains are very thick and look strong enough to hold a tremendous
weight. They are wrought of black steel and are probably magically
reinforced."

extra {"ash","ground","soil"}
"The ground seems to be made out of a strange mixture of ashes and
charcoal."

extra {"blood red sky","sky"}
"No sun lights it although some form of light emenates from it."

extra {"pile of broken bones","pile","bones"}
"The former owner of these bones looks to have been smashed, broken,
decapitated. What an ugly fate."

extra {"the river Styx","styx"}
"A wise man once said: If you swim the Styx you're barmy."

flags {UNIT_FL_NO_TELEPORT ,UNIT_FL_NO_WEATHER}
movement SECT_FIELD

west to around_pit02 descr "South of the pit.";
north to around_pit04 descr "East of the pit.";

end /* around_pit03 */


			around_pit04
names {"around_pit04","vialfill"}
title "East of the pit"
descr "Looking down into the pit to the west you see the skull fortress'
left side. One of the chains holding the skull is fastened into the ground
north of here. To the east flows the calm but deadly river Styx."

extra {"pit","dark pit"}
"The dark pit is five hundred yards across. And so deep you can only see
ever darkening night when you look down into it. You are at the south side
of it."

extra {"skull","palace","fortress"}
"From here it seems the skull is made of solid bone. It looks human, but you
can't imagine a human being this big. From here you can see the the left
side of the skull. It looks like there is an entrance on top of it."

extra {"chains","chain"}
"The chains are very thick and look strong enough to hold a tremendous
weight. They are wrought of black steel and are probably magically
reinforced."

extra {"ash","ground","soil"}
"The ground seems to be made out of a strange mixture of ashes and
charcoal."

extra {"blood red sky","sky"}
"No sun lights it although some form of light emenates from it."

extra {"the river Styx","styx"}
"A wise man once said: If you swim the Styx you're barmy."

flags {UNIT_FL_NO_TELEPORT ,UNIT_FL_NO_WEATHER}
movement SECT_FIELD

south to around_pit03 descr "South-east of the pit.";
north to e_o_pit descr "East of the pit.";

end /* around_pit04 */


			around_pit05
names {"around_pit05","vialfill"}
title "East of the pit"
descr "As you walk along the east side of the pit you stumble across a
corpse that is being consumed by a horde of maggots. You start to think that
a swim in the Styx might be a better fate than what must have happened to
this poor soul. One of the chains that the skull in the pit hangs from is
fastened south of here. You can also travel north."

extra {"pit","dark pit"}
"The dark pit is five hundred yards across. And so deep you can only see
ever darkening night when you look down into it. You are at the south side
of it."

extra {"skull","palace","fortress"}
"From here it seems the skull is made of solid bone.. It looks human, but you
can't imagine a human being this big. From here you can see the the left
side of the skull. It looks like there is an entrance on top of it."

extra {"chains","chain"}
"The chains are very thick and look strong enough to hold a tremendous
weight. They are wrought of black steel and are probably magically
reinforced."

extra {"rotting corpse","corpse"}
"The corpse of this once dwarf is home to a big hoard of maggots that pour
from every opening in the body made by raking claws."

extra {"ash","ground","soil"}
"The ground seems to be made out of a strange mixture of ashes and
charcoal."

extra {"blood red sky","sky"}
"No sun lights it although some form of light emenates from it."

extra {"the river Styx","styx"}
"A wise man once said: If you swim the Styx you're barmy."

flags {UNIT_FL_NO_TELEPORT ,UNIT_FL_NO_WEATHER}
movement SECT_FIELD

north to around_pit06 descr "North-east of the pit.";
south to e_o_pit descr "East of the pit.";

end /* around_pit05 */


			around_pit06
names {"around_pit06","vialfill"}
title "North-east of the pit"
descr "Looking east you see the river styx disappearing into a curtain of
mist before it reaches the abyss to the north. You can travel along the pit
south and west."

extra {"pit","dark pit"}
"The dark pit is five hundred yards across. And so deep you can only see
ever darkening night when you look down into it. You are at the south side
of it."

extra {"skull","palace","fortress"}
"From here it seems the skull is made of solid bone. It looks human, but you
can't imagine a human being this big. From here you can see the the back and
left side of the skull. It looks like there is an entrance on top of it."

extra {"chains","chain"}
"The chains are very thick and look strong enough to hold a tremendous
weight. They are wrought of black steel and are probably magically
reinforced."

extra {"ash","ground","soil"}
"The ground seems to be made out of a strange mixture of ashes and
charcoal."

extra {"blood red sky","sky"}
"No sun lights it although some form of light emenates from it."

extra {"the river Styx","styx"}
"A wise man once said: If you swim the Styx you're barmy."

flags {UNIT_FL_NO_TELEPORT ,UNIT_FL_NO_WEATHER}
movement SECT_FIELD

west to around_pit07 descr "North of the pit.";
south to around_pit05 descr "East of the pit.";

end /* around_pit06 */


			around_pit07
names {"around_pit07"}
title "North of the pit"
descr "West of here you can see the point where the northern of the four
chains that carry the skull fortress is fastened. You can go east back
towards the river Styx. An abyss and the pit prevent travel north and
south respectively."

extra {"pit","dark pit"}
"The dark pit is five hundred yards across. And so deep you can only see
ever darkening night when you look down into it. You are at the south side
of it."

extra {"skull","palace","fortress"}
"From here it seems the skull is made of solid bone. It looks human, but you
can't imagine a human being this big. From here you can see the the back
side of the skull. It looks like there is an entrance on top of it."

extra {"chains","chain"}
"The chains are very thick and look strong enough to hold a tremendous
weight. They are wrought of black steel and are probably magically
reinforced."

extra {"ash","ground","soil"}
"The ground seems to be made out of a strange mixture of ashes and
charcoal."

extra {"blood red sky","sky"}
"No sun lights it although some form of light emenates from it."

flags {UNIT_FL_NO_TELEPORT ,UNIT_FL_NO_WEATHER}
movement SECT_FIELD

west to n_o_pit descr "North of the pit.";
east to around_pit06 descr "North-east of the pit.";

end /* around_pit07 */


			styx_bank01
names {"styx_bank01","vialfill"}
title "The bank of the river Styx"
descr "You have arrived on the bank of the river Styx. The legendary river
flows east of here. To the west you see ash gray coloured plains. Large
cliffs with cracks in them block the way south, but you travel to the north
is possible."

extra {"ash","ground","soil"}
"The ground seems to be made out of a strange mixture of ashes and
charcoal."

extra {"blood red sky","sky"}
"No sun lights it although some form of light emenates from it."

extra {"the river Styx","styx"}
"A wise man once said: If you swim the Styx you're barmy."

flags {UNIT_FL_NO_TELEPORT ,UNIT_FL_NO_MOB,UNIT_FL_NOSAVE}
movement SECT_FIELD

north to around_pit01 descr "South of the pit.";
west to ash_21 descr "The edge of the plain of ash.";

end /* styx_bank01 */


			styx_bank02
names {"styx_bank02","vialfill"}
title "The bank of the river Styx"
descr "You have found a bank of the river Styx. The river ends, or maybe
starts, abrubtly here making you think it is not like any natural river.
It disappears into a thick fog downriver leading to dark places. Legend says
that only mystical boatmen using special boats are able to navigate the
Styx, and that people who swam in, or even drank the water died miserable
deaths."

extra {"the river Styx","styx"}
"The water of the river Styx is dark, almost black in colour. You are unable
to see very deep into it and if anyone lives there it is probably not worth
meeting."

east to path_13@demon_realm descr "A small path.";

flags { UNIT_FL_NOSAVE}
movement SECT_FIELD

end /* styx_bank02 */


			on_styx
names {"on_styx","vialfill"}
title "On the river Styx"
descr "Large banks of fog block sight farther than ten yards. What strikes
you as odd, is the fact that you don't come any closer to the fog, although
you have the distinct feeling that you are moving. At times you think you
can make out strange faces in the fog, or even moving shapes."

extra {"the river Styx","styx"}
"The water of the river Styx is dark, almost black in colour. You are unable
to see very deep into it and if anyone lives there it is probably not worth
meeting."

extra {"faces and shapes","faces","shapes"}
"They are not very clear but the ones you see are both humanoid and demonic
in appearance."

flags {UNIT_FL_NO_TELEPORT,UNIT_FL_NOSAVE}
movement SECT_FIELD

dilbegin styx_stuff();

var
   u	: unitptr;

code {

:init:
   heartbeat := PULSE_SEC*5;
:start:
   wait(SFB_DONE,(activator.type==UNIT_ST_PC) or
                 (activator.type==UNIT_ST_NPC));
   u := activator;
   secure(u,lost_act);
   pause;
   on rnd(0,9) goto a,b,c,d,e,f,g,h,i,j;
:a:
   act("A bloated corpse floats by.",A_ALWAYS,u,null,null,TO_ALL);
   goto finish;
:b:
   act("The boat rocks slightly.",A_ALWAYS,u,null,null,TO_ALL);
   goto finish;
:c:
   act("Bubbles of air surface on the port side.",
      A_ALWAYS,u,null,null,TO_ALL);
   goto finish;
:d:
   act("You see ripple in the water closing in on the boat.",
      A_ALWAYS,u,null,null,TO_ALL);
   goto finish;
:e:
   act("A small wave almost splashes into the boat.",
      A_ALWAYS,u,null,null,TO_ALL);
   goto finish;
:f:
   act("You think you see a face staring at you from below the surface.",
      A_ALWAYS,u,null,null,TO_ALL);
   goto finish;
:g:
   act("You shiver as a cold wind bites into your flesh.",
      A_ALWAYS,u,null,null,TO_ALL);
   goto finish;
:h:
   act("A horrible cry pieces the eerie silence.",
      A_ALWAYS,u,null,null,TO_ALL);
   goto finish;
:i:
   act("A dead tree log carrying a skelleton drifts by.",
      A_ALWAYS,u,null,null,TO_ALL);
   goto finish;
:j:
   act("You think you hear another boat not far away.",
      A_ALWAYS,u,null,null,TO_ALL);
   goto finish;
:finish:
   pause;
   pause;
   goto start;

:lost_act:
   unsecure(u);
   goto start;

}
dilend /* styx_stuff */

end /* on_styx */


			styx_bridge01
names {"styx_bridge01"}
title "On a bridge across the Styx"
descr "The stone bridge is carved in the form of a spinal column which means
you have to watch your every step. Below is the river flowing north. The
bridge continues east and you can get off the bridge to the west."

extra {"spine bridge","bridge"}
"It an enlarged version of the spinal column of some beast probably unknown
to you. The spine enters the ground on both sides of the styx and is bent so
that passage underneath by boat is still possible."

extra {"the river Styx","styx"}
"A wise man once said: If you swim the Styx you're barmy."

flags {UNIT_FL_NO_TELEPORT ,UNIT_FL_NO_MOB}
movement SECT_FIELD

east to styx_bridge02 descr "On a bridge across the Styx.";
west to e_o_pit descr "East of the pit.";

end /* styx_bridge01 */


			styx_bridge02
names {"styx_bridge02"}
title "On a bridge across the Styx"
descr "Standing on the bridge you see a large battlefield to the east. The
river Styx flows northward underneath the bridge. The bridge also continues
west."

extra {"spine bridge","bridge"}
"It an enlarged version of the spinal column of some beast probably unknown
to you. The spine enters the ground on both sides of the styx and is bent so
that passage underneath by boat is still possible."

extra {"the river Styx","styx"}
"A wise man once said: If you swim the Styx you're barmy."

flags {UNIT_FL_NO_TELEPORT ,UNIT_FL_NO_MOB}
movement SECT_FIELD

west to styx_bridge01 descr "On a bridge across the Styx.";
east to battle_03 descr "A battlefield.";

end /* styx_bridge02 */

/* --------------------- BATTLEFIELD ROOMS ---------------------------- */

			battle_01
names {"battle_01","vialfill"}
title "North side of the battlefield"
descr "The corpse of a demon lies here on it's back, a spear protruding from
it's stomach, and it's face contorted in aquish. The river Styx disappears
in a haze of mist west of here just before reaching the abyss that borders
the battlefield to the north and west. You can leave south along the
river."

extra {"spear"}
"It is a fairly common spear. The shaft was proken on impact."

extra {"the abyss","abyss"}
"Dark, bottomless and deadly."

extra {"the river Styx","styx"}
"A wise man once said: If you swim the Styx you're barmy."

BATTLE_EXTRA

flags {UNIT_FL_NO_TELEPORT ,UNIT_FL_NO_WEATHER}
movement SECT_FIELD

south to battle_02 descr "A battlefield.";

end /* battle_01 */


			battle_02
names {"battle_02","vialfill"}
title "On the battlefield"
descr "Examining the ground you find tracks that indicate that a struggle
took place here. Various footsteps lead towards the River Styx west of here.
There are clear marks of somebody trying to claw it's way back while being
dragged along. The battlefield stretches out further to the south, north and
east."

extra {"tracks"}
"It looks like somebody was taken for a swim."

extra {"the river Styx","styx"}
"A wise man once said: If you swim the Styx you're barmy."

BATTLE_EXTRA

flags {UNIT_FL_NO_TELEPORT ,UNIT_FL_NO_WEATHER}
movement SECT_FIELD

south to battle_03 descr "A battlefield.";
north to battle_01 descr "North side of the battlefield.";
east to battle_06 descr "North side of the battlefield.";


end /* battle_02 */


			battle_03
names {"battle_03"}
title "Entrance to the battlefield"
descr "Looking at the field ahead of you it's obvious a ferocious battle
took place here recently. Corpses of serveral kinds of demons lie at your
feet. You can leave this ugly place west using the bridge across the river
Styx. The battle field continues in all other directions."

extra {"demonic corpses","corpses"}
"Judging from the state of the corpses the battle took place only days
ago."

extra {"the river Styx","styx"}
"A wise man once said: If you swim the Styx you're barmy."

BATTLE_EXTRA

flags {UNIT_FL_NO_TELEPORT ,UNIT_FL_NO_WEATHER}
movement SECT_FIELD

south to battle_04 descr "A battlefield.";
north to battle_02 descr "A battlefield.";
east to battle_07 descr "A battlefield.";
west to styx_bridge02 descr "On a bridge across the river Styx.";


end /* battle_03 */


			battle_04
names {"battle_04","vialfill"}
title "On the battlefield"
descr "Corpses and severed limbs litter the bank of the Styx that flows west
of here. Numerous tracks indicate the these demons did not die here but were
dragged and carried here to be disposed off. The battlefield continues in
all other directions."

extra {"servered limbs and corpses","corpses","limbs","limb"}
"The limbs were hacked, torn and blasted off their owners. Taking a quick
glance at corpses and limbs you think should be able to puzzle at least a
few of them together."

extra {"the river Styx","styx"}
"A wise man once said: If you swim the Styx you're barmy."

BATTLE_EXTRA

flags {UNIT_FL_NO_TELEPORT ,UNIT_FL_NO_WEATHER}
movement SECT_FIELD

south to battle_05 descr "A battlefield.";
north to battle_03 descr "A battlefield.";
east to battle_08 descr "A battlefield.";

end /* battle_04 */


			battle_05
names {"battle_05","vialfill"}
title "The south edge of the battlefield"
descr "A lack of corpses suggests that there was little combat in this
corner of the battlefield. The only ones to be seen are a dozen or so that
probably tried to crawl away from the slaughtering but died of bloodloss and
fatigue. The cliffs that also border the plain of ash are block the way
south and east. The river Styx flows west."

extra {"cliff wall","cliffs","cliff"}
"They appear to be granite cliffs and have large cracks running through them
at places. Other than that there are no irregularities on them, making them
impossible to climb."

extra {"corpses"}
"Fleeing does not always mean you live."

extra {"the river Styx","styx"}
"A wise man once said: If you swim the Styx you're barmy."

BATTLE_EXTRA

flags {UNIT_FL_NO_TELEPORT ,UNIT_FL_NO_WEATHER}
movement SECT_FIELD

north to battle_04 descr "A battlefield.";

end /* battle_05 */


			battle_06
names {"battle_06"}
title "The north edge of the battlefield"
descr "The charred remains of a devil still smoldering under the blood
coloured sky. Next to it lies the corpse of a darkelf clad in black robes
who was knifed in the back with a black, evil looking dagger. To the south
you notice a fire burning. You can go in every direction but north where the
bottomless abyss lies."

extra {"the abyss","abyss"}
"Dark, bottomless and deadly."

BATTLE_EXTRA

flags {UNIT_FL_NO_TELEPORT ,UNIT_FL_NO_WEATHER}
movement SECT_FIELD

west to battle_02 descr "A battlefield.";
east to battle_09 descr "The north-east corner of the battlefield.";
south to battle_07 descr "The middle of the battlefield.";

end /* battle_06 */


			battle_07
names {"battle_07"}
title "The middle the battlefield"
descr "This is approximately the center of the battlefield. A huge pile of
bodies consisting of inhabitans of both the Abyss and Hades stands tall
here. It has been set on fire to prevent diseases and possible undead from
spreading across the land. Looking east you can barely make out an arch
in the landscape."

extra {"burning pile of bodies","pile","bodies"}
"It burns bright but the bodies are hardly consumed by the fire. This could
be because the demons from both plains are somewhat resistant to heat and
fire."

BATTLE_EXTRA

flags {UNIT_FL_NO_TELEPORT ,UNIT_FL_NO_WEATHER}
movement SECT_FIELD

west to battle_03 descr "Entrance to the battlefield.";
east to battle_10 descr "A portal on the battlefield.";
north to battle_06 descr "The north edge of the battlefield.";
south to battle_08 descr "The south edge of the battlefield.";

end /* battle_07 */


			battle_08
names {"battle_08"}
title "The south edge the battlefield"
descr "There is a big hole in the ground here as if something has exploded.
No bodies can be seen in it's vicinity, only parts. Although other parts of
the battlefield are being cleaned up nobody seems to take offence at the
gory bits that are literally strewn about here. You can go in all directions
but south where cliffs block the way."

extra {"cliff wall","cliffs","cliff"}
"They appear to be granite cliffs and have large cracks running through them
at places. Other than that there are no irregularities on them, making them
impossible to climb."

extra {"hole","pit"}
"It is about 6 feet deep and 20 yards in diameter."

extra {"gory bits and pieces","gory bits","bits","parts"}
"Try to puzzle THAT together!"

BATTLE_EXTRA

flags {UNIT_FL_NO_TELEPORT ,UNIT_FL_NO_WEATHER}
movement SECT_FIELD

west to battle_04 descr "A battlefield.";
east to battle_11 descr "The south-east corner of the battlefield.";
north to battle_07 descr "The middle of the battlefield.";

end /* battle_08 */


			battle_09
names {"battle_09"}
title "The north-east corner the battlefield"
descr "This corner has been relatively quiet during the past battle. The
attackers were probably not very keen on going in this direction, because
the field ends abrubtly to make place for the abyss. You notice a pretty
large arch standing south of here and you can also go west."

extra {"the abyss","abyss"}
"Dark, bottomless and deadly."

BATTLE_EXTRA

flags {UNIT_FL_NO_TELEPORT ,UNIT_FL_NO_WEATHER}
movement SECT_FIELD

west to battle_06 descr "The north edge of the battlefield.";
south to battle_10 descr "A portal on the battlefield.";

end /* battle_09 */


			battle_10
names {"battle_10"}
title "At a portal on the battlefield"
descr "Close to the edge of the abyss a very large arch that seems to
be a portal of some sort rises from the ground. The high concentration of
corpses with caved in heads and scattered brains makes you think that
someone wielding a skull splitter or equally powerful battleaxe, has sown
death and destruction here. You can leave this place in all directions but
east."

extra {"arch","portal"}
"The arch is about 30 feet high easily as broad. Strange runes that you
can't read cover every inch of it. It must be a portal but the way it
operates is beyond your grasp."

extra {"the abyss","abyss"}
"Dark, bottomless and deadly."

BATTLE_EXTRA

flags {UNIT_FL_NO_TELEPORT ,UNIT_FL_NO_WEATHER}
movement SECT_FIELD

west to battle_07 descr "The middle of the battlefield.";
south to battle_11 descr "The south-east corner of the battlefield.";
north to battle_09 descr "The north-east corner of the battlefield.";

end /* battle_10 */


			battle_11
names {"battle_11"}
title "The south-east corner the battlefield"
descr "There was not much killing done here. Only some unfortunates that
fled the heat of combat that took place north of here met ugly fates here at
the hands of their pursuers. To the south enormous cliffs rise up to the
heavens and east the abyss beckons you to jump in. You leave west or north
where you can make out a large arch."

extra {"cliff wall","cliffs","cliff"}
"They appear to be granite cliffs and have large cracks running through them
at places. Other than that there are no irregularities on them, making them
impossible to climb."

extra {"the abyss","abyss"}
"Dark, bottomless and deadly."

BATTLE_EXTRA

flags {UNIT_FL_NO_TELEPORT ,UNIT_FL_NO_WEATHER}
movement SECT_FIELD

west to battle_08 descr "A battlefield.";
north to battle_10 descr "A portal on the battlefield.";

end /* battle_11 */


/* ################################################################## */
/* -----------------------= MOBILES SECTION =------------------------ */
/* ################################################################## */

%mobiles

/* ------------------- FORTRES INHABITANTS -------------------------- */

/*
   Goruk is the ruler of this layer of the Abyss. He is not in the best
   of moods at them moment because an army of devils just recently launched
   an attack upon his domain. They were repelled but now he wants to do
   a counterstrike. He is waiting for Acina, his mage to devise a scroll
   that would open the portal to hell so he can do the attack. The devils
   closed the portal after leaving.
*/

			goruk
names {"Goruk the Abyssal lord","goruk","abyssal lord","lord"}
title "Goruk the Abyssal lord"
descr "Goruk the abyssal lord is pacing across the room."

extra {}
"Goruk is the ruler of this layer of the Abyss. His torso resembles that of
a humanoid although it is heavier muscled and he has deadly looking claws
instead of hands. Goruks legs resemble those found on vultures but they are
larger and allow him to stand up straight. His head is also like a vulture's
bald head and features a big mean looking beak. Wings to match sprout from
his back. Goruk's totally black, beady eyes look cold and uncaring."

extra {"head"}
"It looks like a vulture's head. The skull is bald and has a distinct bird
like shape. It features a large deadly looking beak and beady eyes that are
as black as a starless night."

extra {"beak"}
"This beak could rip flesh from your body with ease."

extra {"eyes"}
"They are totally black and have a cold and uncaring look to them."

extra {"torso"}
"Goruk's torso his broad and heavily muscled. It is the only part of him
that remotely resembles a humanoid form. The colour of his skin is ash gray
and looks a lot tougher than yours."

extra {"claws","claw"}
"They are large and somewhat resemble a dragon's foreclaws."

extra {"wings"}
"The wings seem to be big enough to carry their owner through the skies.
They have black feathers with an occasional gray one here and there."

extra {"legs"}
"These legs are birdlike but look very powerful. It might be wise to keep
away from the talons."

ABYSSAL_LORD(150,SEX_MALE)

alignment -1000
money 3 GOLD_PIECE

dilcopy no_disarm@abyss1();
dilcopy eat_given@abyss1();

dilbegin goruk_blah();

var
   i	: integer;

code {

:init:
   heartbeat := PULSE_SEC*10;
   i := interrupt(SFB_COM,self.position==POSITION_FIGHTING,in_fight);
:start:
   wait(SFB_DONE,activator.type==UNIT_ST_PC);
   pause;
   exec("growl",self);
   pause;
   exec("say Damn those devils!",self);
   pause;
   exec("curse",self);
   pause;
   exec("say I shall not rest before I have eradicated every single one "+
      "of them!",self);
   pause;
   exec("say Perhaps I should plan a counterstrike...",self);
   pause;
   exec("think",self);
   pause;
   exec("say Yes, that would be fun. I will lead the attack myself.",self);
   pause;
   exec("say But first I need Acina to open that blasted portal "+
      "again.",self);
   pause;
   exec("say I need her to double her efforts!",self);
   pause;
   exec("say If she doesn't hurry I'll be forced to eat her and replace "+
      "her with someone that is more competent.",self);
   pause;
   exec("say I SHALL HAVE MY REVENGE!",self);
   pause;
   heartbeat := PULSE_SEC*60;
   pause;
   pause;
   heartbeat := PULSE_SEC*10;
   goto start;

:in_fight:
   heartbeat := PULSE_SEC*3;
   while (self.position == POSITION_FIGHTING) pause;
   exec("moo",self);
   pause;
   exec("emote starts pacing across the room again.",self);
   heartbeat := PULSE_SEC*10;
   goto start;

}
dilend /* goruk_blah */

end /* Goruk the Abyssal lord */

/*
   Irchak, Goruk's general is busy planning the counterstrike into hell
*/

			irchak
names {"Irchak"}
title "Irchak the Abyssal general"
descr "Irchak the Abyssal general is standing here."

extra {}
"Irchak is the general of Goruk's forces. He is a very large well muscled
demon and has large claws and two horns on his head that could do some
serious impaling. What frightens you most about him is the gleam of
intelligence in his eyes and the air of authority that hangs around him."

extra {"head","face"}
"Looking at Irchak's face you can't help but notice his eyes piercing into
you mind. Two large horns are mounted on his skull that have seen some
action in the past. Large pointy teeth are bared as he flashes an evil grin
your way."

extra {"eyes"}
"Dark commanding eyes."

extra {"claws","claw"}
"They are large and somewhat resemble a dragon's foreclaws."

BASE_GREATER_TANARRI(125,ARM_PLATE,SEX_MALE)
MSET_ABILITY(18,17,15,20,10,10,5,5)
MSET_WEAPON(10,12,10,10,15,10)
MSET_SPELL(3,3,3,3,3,3,3,3,3,3,3)

exp 100
alignment -950
money 1 GOLD_PIECE

dilcopy no_disarm@abyss1();
dilcopy eat_given@abyss1();

dilbegin irchak_blah();

var
   i	: integer;

code {

:init:
   heartbeat := PULSE_SEC*10;
   i := interrupt(SFB_COM,self.position==POSITION_FIGHTING,in_fight);
:start:
   wait(SFB_DONE,activator.type==UNIT_ST_PC);
   pause;
   exec("think",self);
   pause;
   exec("say Now... if we get that portal to open we should charge "+
      "in.",self);
   pause;
   exec("emote checks a complicated map.",self);
   pause;
   exec("say Yes, that would be good.",self);
   pause;
   exec("say I'll send in the cannon fodder first to wear down the "+
      "defenders.",self);
   pause;
   exec("say Then the vrock elite troops will move in to slay them "+
      "all.",self);
   pause;
   exec("smile",self);
   pause;
   exec("emote paces across the room in deep thought.",self);
   pause;
   exec("say Revenge will be ours!",self);
   pause;
   heartbeat := PULSE_SEC*60;
   pause;
   pause;
   heartbeat := PULSE_SEC*10;
   goto start;

:in_fight:
   heartbeat := PULSE_SEC*3;
   while (self.position == POSITION_FIGHTING) pause;
   exec("moo",self);
   pause;
   exec("emote starts working on his battleplan again.",self);
   heartbeat := PULSE_SEC*10;
   goto start;

}
dilend /* irchak_blah */

end /* irchak */

/*
   Xorlock, Goruk's high priest has just obained a new deadly spell
   from the evil gods he worships.
*/

			xorlock
names {"Xorlock"}
title "Xorlock the high priest of Goruk"
descr "Xorlock the high priest of Goruk performing evil rites here."

extra {}
"Xorlock is probably the ugliest demon you ever saw. His flesh on his
demonic face looks bloated and sagged. Although most demons you have seen
are pretty well muscled, Xorlock is fat. It could be a mistake to disregard
him as harmless though as he is considerably large and looks mean."

extra {"head","face"}
"Just looking at Xorlock's face makes you shiver. His demonic face is
swollen and the flesh is sagged. He still has the sharp teeth that all of
the inhabitants of this plane seem to have in common."

extra {"eyes"}
"The sagged flesh leaves a lot of the black eyeballs uncovered."

extra {"claws","claw"}
"They are large and somewhat resemble a dragon's foreclaws."

BASE_GREATER_TANARRI(110,ARM_PLATE,SEX_MALE)
MSET_ABILITY(15,15,10,15,15,15,0,15)
MSET_WEAPON(9,9,9,8,9,6)
MSET_SPELL(10,4,4,4,4,4,4,4,4,4,4)
dilcopy combat_mag@function("","heal",30,0);

exp 120
alignment -950
money 1 GOLD_PIECE

dilbegin xorlock_blah();

var
   i	: integer;

code {

:init:
   heartbeat := PULSE_SEC*10;
   i := interrupt(SFB_COM,self.position==POSITION_FIGHTING,in_fight);
:start:
   wait(SFB_DONE,activator.type==UNIT_ST_PC);
   pause;
   exec("emote softly chants dark words.",self);
   pause;
   exec("emote watches as a black mist starts to swirl before him.",self);
   pause;
   exec("cackle",self);
   pause;
   exec("say That will get those devils!",self);
   pause;
   exec("say They will wither and die!",self);
   pause;
   exec("snicker",self);
   pause;
   exec("say Thank you almighty powers of the dark.",self);
   pause;
   exec("say I will use this spell to further your cause.",self);
   pause;
   exec("emote kneels and starts to pray.",self);
   pause;
   heartbeat := PULSE_SEC*60;
   pause;
   pause;
   heartbeat := PULSE_SEC*10;
   goto start;

:in_fight:
   heartbeat := PULSE_SEC*3;
   while (self.position == POSITION_FIGHTING) pause;
   exec("moo",self);
   pause;
   pause;
   exec("emote continues his evil rites.",self);
   heartbeat := PULSE_SEC*10;
   goto start;

}
dilend /* xorlock_blah */

end /* xorlock */

/*
   Acina, Goruk's mage is in trouble. She might end up as Goruk's dinner
   if she doesn't complete a scroll to open the portal on the battlefield
   fast. She will ask the players to do a quest for her so she can finish
   her research. She requires:
   *  A white Vrock feather (found on one of the Vrocks walking around)
   *  A piece of nabassu hide (same as above)
   *  A full vial of Styx water (player should fill vial at a room bordering
      the river Styx);
   *  A crimson gem (found on the parasite inside the belly of the stoned
      titan that is half buried in the plain of ash)
   She will give the player some experience and a portal scroll (she had
   enough stuff to make two)
   The scroll can be given to the dying devil who also needs the scroll to
   get back to hell.
*/

			acina
names {"acina"}
title "Acina the archmage of Goruk"
descr "Acina the archmage of Goruk is walking around here."

extra {}
"Acina is a beautiful human woman with a stunning figure and her face is one
of the prettiest you've ever seen, but the look on it is cold. She is a
woman that only lives for her own ambition."

extra {"head","face"}
"A very pretty face indeed! It's a shame there is no smile on it."

extra {"eyes"}
"Acina's eyes are pretty large for a human but it only enhances their
beauty."

sex SEX_FEMALE
race RACE_HUMAN
level 110
height 180
weight 130
NATURAL_DEF(WPN_FIST,ARM_CLOTHES)
MSET_ABILITY(10,10,10,15,20,15,20,0)
MSET_WEAPON(4,4,4,4,5,4)
MSET_SPELL(0,5,5,5,5,5,5,5,5,5,30)
dilcopy combat_mag@function("acid ball","",0,1);

exp 120
alignment -950
money 1 GOLD_PIECE

dilbegin acina_q();

var
   pc		: unitptr;
   obj		: unitptr;
   quest	: extraptr;

code{

:init:
   heartbeat:=PULSE_SEC*5;
   interrupt(SFB_COM,self.position==POSITION_FIGHTING,ina_fight);
:start:
   wait(SFB_DONE,(activator.type==UNIT_ST_PC) or
                 ((target==self) and
                  (command("give")) and
                  (activator.type==UNIT_ST_PC)));
   pc:=activator;
   secure(pc,lost_pc);

   if (command("give")) goto endstart;

   if(ACINA_QUEST_ONGOING in pc.quests)  goto start;
   if(ACINA_QUEST_FINISHED in pc.quests) goto start;

   pause;
   exec("say Ah, hello "+pc.name,self);
   pause;
   exec("think",self);
   pause;
   exec("say Maybe you could help me?",self);
   pause;
   exec("grin",self);
   pause;
   exec("say You see, I need to make a scroll.",self);
   pause;
   exec("say And if I don't finish it fast I fear I will be the main "+
      "course soon.",self);
   pause;
   exec("sigh",self);
   pause;
   exec("say I still need a few items to complete my research.",self);
   pause;
   exec("say And some are hard to obtain for me.",self);
   pause;
   exec("say Please NOD if you feel like helping me, otherwise SHAKE your "+
      "head.",self);
   wait(SFB_DONE,(command("nod") or command("shake")) and (activator==pc));
   if (command("shake"))
   {
      goto no_quest;
   }
   addextra(pc.quests,{ACINA_QUEST_ONGOING},"");
   exec("smile",self);
   pause;
   exec("say The items I need can all be found on this layer of the "+
      "Abyss.",self);
   pause;
   exec("say I will give you their names now.",self);
   pause;
   exec("think",self);
   pause;
   exec("say The first thing I need is a piece of Nabassu hide to write "+
      "the spell on.",self);
   pause;
   exec("say The second item is a white vrock feather, to write it "+
      "down.",self);
   pause;
   exec("say I don't think my lord would like me destroying his "+
      "minions.",self);
   pause;
   exec("grin",self);
   pause;
   exec("say The last two items are needed to fabricate the ink.",self);
   pause;
   exec("say I need a rare crimson gem that is sometimes found here in "+
      "the soil.",self);
   pause;
   exec("say And the last thing I need is a vial with water from the "+
      "Styx.",self);
   pause;
   obj := load("vial_empty@abyss1");
   link(obj,pc);
   act("$3n gives you a "+obj.name+".",
      A_SOMEONE,pc,null,self,TO_CHAR);
   act("$3n gives $1n a "+obj.name+".",
      A_SOMEONE,pc,null,self,TO_REST);
   exec("say If you happen to lose this vial come back and say 'lost "+
      "vial'.",self);
   exec("say Bring me these items. I am sure it will be a valuable "+
      "experience for you.",self);
   pause;
   exec("say Go now.",self);
   unsecure(pc);
   goto start;

:no_quest:
   exec("sigh",self);
   pause;
   exec("say So be it.",self);
   unsecure(pc);
   heartbeat := PULSE_SEC*30;
   pause;
   heartbeat := PULSE_SEC*5;
   goto start;

:endstart:
   if(ACINA_QUEST_ONGOING in pc.quests) goto get_item;
   unsecure(pc);
   goto start;

:get_item:
   if(not(ACINA_QUEST_ONGOING in activator.quests))
   {
      exec("say I dont need this!!",self);
      exec("drop "+medium.name,self);
      goto start;
   }
   if((medium.title=="a piece of nabassu hide") and
      ("nabassu hide" in medium.names))
   {
      if("nhide" in pc.quests)
      {
         exec("say I have already recieved this item from you.",self);
         exec("give "+medium.name+" "+activator.name,self);
      }
      else
      {
          destroy(medium);
          quest:=ACINA_QUEST_ONGOING in pc.quests;
          addstring(quest.names, "nhide");
          exec("say Yes, this will do nicely.",self);
      }
   }
   else if((medium.title=="a white vrock feather") and
           ("vrock feather" in medium.names))
   {
      if("vfeather" in pc.quests)
      {
         exec("say I have already recieved this item from you.",self);
         exec("give "+medium.name+" "+activator.name,self);
      }
      else
      {
         destroy(medium);
         quest:=ACINA_QUEST_ONGOING in pc.quests;
         addstring(quest.names, "vfeather");
         exec("say This is the feather i need.",self);
      }
   }
   else if((medium.title=="a crimson gem") and
           ("crimson gem" in medium.names))
   {
      if("cgem" in pc.quests)
      {
         exec("say I have already recieved this item from you.",self);
         exec("give "+medium.name+" "+activator.name,self);
      }
      else
      {
         destroy(medium);
         quest:=ACINA_QUEST_ONGOING in pc.quests;
         addstring(quest.names, "cgem");
         exec("say Ah thank you, these are very rare indeed.",self);
      }
   }
   else if((medium.title=="a full crystal vial") and
           ("full crystal vial" in medium.names))
   {
      if("fvial" in pc.quests)
      {
         exec("say I have already recieved this item from you.",self);
         exec("give "+medium.name+" "+activator.name,self);
      }
      else
      {
         destroy(medium);
         quest:=ACINA_QUEST_ONGOING in pc.quests;
         addstring(quest.names, "fvial");
         exec("say This looks good, I hope you didn't touch the "+
            "water.",self);
      }
   }
   else
   {
      exec("say I dont need this!!",self);
      exec("drop "+medium.name,self);
     }
:check_quest:
   if(("nhide" in pc.quests) and
      ("vfeather" in pc.quests) and
      ("cgem" in pc.quests) and
      ("fvial" in pc.quests)) goto finish;
   unsecure(pc);
   goto start;

:finish:
   exec("You have done well "+pc.name,self);
   pause;
   exec("say I think I can even make two scrolls.",self);
   pause;
   exec("emote cuts the Nabassu hide in two",self);
   pause;
   exec("emote holds the gem in her hand above the vial.",self);
   pause;
   exec("emote utters the words 'kragh pouder' and crushes the "+
      "gem.",self);
   pause;
   exec("emote smiles as the powder flows from her hand into the "+
      "vial.",self);
   pause;
   act("The powder and Styx water swirl around when they magicaly "+
      "combine!",A_ALWAYS,self,null,null,TO_ALL);
   pause;
   exec("emote gets the vrock feather and makes a small cut in it.",self);
   pause;
   exec("emote dips her new quill in the vial.",self);
   pause;
   exec("emote starts to write down a spell on the first hide.",self);
   pause;
   pause;
   pause;
   exec("say Well that's one!",self);
   pause;
   exec("jump",self);
   pause;
   exec("emote starts two write down a second scroll.",self);
   pause;
   pause;
   pause;
   exec("say This one is for you "+pc.name+".",self);
   pause;
   obj:=load("portal_scroll@abyss1");
   exec("give "+obj.name+" "+pc.name,self);
   link(obj,pc);
   act("$3n gives you a "+obj.name+".",
      A_SOMEONE,pc,null,self,TO_CHAR);
   act("$3n gives $1n a "+obj.name+".",
      A_SOMEONE,pc,null,self,TO_REST);
   exec("say Thank you very much "+pc.name+". You have really saved "+
      "me!",self);
   pause;
   exec("emote breathes a sigh of relief.",self);
   pause;
   exec("wave "+pc.name,self);
   subextra(pc.quests,ACINA_QUEST_ONGOING);
   addextra(pc.quests,{ACINA_QUEST_FINISHED},"");
   experience(2500,pc);
   act("You have gained 2500xp",A_ALWAYS,pc,null,null,TO_CHAR);
   unsecure(pc);
   goto start;

:ina_fight:
   heartbeat:=PULSE_SEC*2;
   while(self.position==POSITION_FIGHTING) pause;
   heartbeat:=PULSE_SEC*5;
   goto start;

:lost_pc:
   exec("sigh",self); pause;
   exec("say Nice talking to you too.",self); pause;
   unsecure(pc);
   goto start;

}
dilend /* acina_q */


dilbegin vial_reimb();

var
   obj	: unitptr;
   pc	: unitptr;

code {

:start:
   wait(SFB_DONE,(command(CMD_SAY)) and (argument=="lost vial"));
   pc := activator;
   if (not(ACINA_QUEST_ONGOING in pc.quests)) goto start;
   secure(pc,lost_pc);
   obj := load("vial_empty@abyss1");
   link(obj,pc);
   act("$3n gives you a "+obj.name+".",
      A_SOMEONE,pc,null,self,TO_CHAR);
   act("$3n gives $1n a "+obj.name+".",
      A_SOMEONE,pc,null,self,TO_REST);
   exec("say Here you go "+pc.name+"!",self);
   unsecure(pc);
   goto start;

:lost_pc:
   goto start;

}
dilend /* vial_reimb */

end /* acina */

/*
   Blork is Goruk's hobgoblin cook. He is engrossed in making some foul
   broth.
*/

			blork
names {"blork"}
title "Blork the master chef of demons"
descr "Blork the master chef of demons is cooking here."

extra {}
"Blork is a pretty large hobgoblin. He is somewhat overweight which is not
uncommon for a cook. The way he carries himself around the kitchen tells you
that he is an experienced cook, although his creations don't look very
appealing to you."

sex SEX_MALE
race RACE_HOBGOBLIN
level 70
height 180
weight 180
NATURAL_DEF(WPN_FIST,ARM_CLOTHES)
MSET_ABILITY(10,10,10,15,20,15,20,0)
MSET_WEAPON(9,9,6,6,9,6)
MSET_SPELL(5,5,5,5,5,5,5,5,5,5,5)

exp 100
alignment -350
money 2 SILVER_PIECE

dilbegin blork_blah();

var
   i	: integer;

code {

:init:
   heartbeat := PULSE_SEC*10;
   i := interrupt(SFB_COM,self.position==POSITION_FIGHTING,in_fight);
:start:
   wait(SFB_DONE,activator.type==UNIT_ST_PC);
   pause;
   exec("emote tastes his creation.",self);
   pause;
   exec("think",self);
   pause;
   exec("say Ah yes, some more bat balls that's what I need.",self);
   pause;
   exec("emote grabs a large bat from a pot.",self);
   pause;
   exec("emote hacks off the bat's testicles with his chopping "+
      "blade.",self);
   pause;
   act("The large bat screams with agony!",
      A_ALWAYS,self,null,null,TO_ALL);
   pause;
   exec("emote bites the head off the bat to stop it from "+
      "screaming.",self);
   pause;
   exec("emote casually tosses the balls into the boiling "+
      "cauldron.",self);
   pause;
   act("The cauldron responds by boiling over even harder.",
      A_ALWAYS,self,null,null,TO_ALL);
   exec("smile",self);
   pause;
   exec("emote tastes some of the repulsive broth in the cauldron.",self);
   pause;
   exec("say Much better!",self);
   pause;
   exec("emote stirs the broth with a large wooden spoon.",self);
   pause;
   exec("say Now I gotta find a good recipe for stuffed human.",self);
   pause;
   exec("snicker",self);
   pause;
   exec("emote gets busy checking various things in his kitchen.",self);
   pause;
   heartbeat := PULSE_SEC*60;
   pause;
   heartbeat := PULSE_SEC*10;
   goto start;

:in_fight:
   heartbeat := PULSE_SEC*3;
   while (self.position == POSITION_FIGHTING) pause;
   exec("moo",self);
   pause;
   exec("emote starts working on his food again.",self);
   heartbeat := PULSE_SEC*10;
   goto start;

}
dilend /* blork_blah */

/* ------------------- QUEST RELATED MOBS --------------------------- */

end /* blork */

/*
   This dying devil is actually the giver of the real quest as the quest
   for Acina only rewards experience and the item needed to complete the
   devil's quest. (This is the real quest, Acina's quest is just part of it)
   If the quest is completed the devil will give the player a dark anklet.
*/

			dying_devil
names {"dying devil","devil"}
title "a small devil"
descr "A small devil lies here, dying."

extra {}
"You recognize it as one of Hell's inhabitants. He is wounded and you're not
quite sure how long he will last."

LESSER_DEVIL(40)

exp 100
alignment -900

dilbegin devil_q();

var
   pc	: unitptr;
   obj	: unitptr;

code{

:init:
   heartbeat:=PULSE_SEC*5;
   interrupt(SFB_COM,self.position==POSITION_FIGHTING,ina_fight);
:start:
   wait(SFB_DONE,(activator.type==UNIT_ST_PC) or
                 ((target==self) and
                  (command("give")) and
                  (activator.type==UNIT_ST_PC)));
   pc:=activator;
   secure(pc,lost_pc);

   if (command("give")) goto endstart;

   if(DEVIL_QUEST_ONGOING in pc.quests)  goto start;
   if(DEVIL_QUEST_FINISHED in pc.quests) goto start;

   pause;
   exec("emote coughs up some blood.",self);
   pause;
   exec("emote whispers 'help!'",self);
   pause;
   exec("emote gurgles 'Would you please help me "+pc.name+"?'",self);
   pause;
   exec("emote winces in pain.",self);
   pause;
   exec("emote whispers 'I need a way to open this portal.'",self);
   pause;
   exec("emote whispers 'So I can get out of here.'",self);
   pause;
   exec("emote whispers 'Are you willing to help me "+pc.name+"?'",self);
   pause;
   exec("emote whispers 'Please NOD if you feel like helping me, "+
      "otherwise SHAKE your head.'",self);
   wait(SFB_DONE,(command("nod") or command("shake")) and (activator==pc));
   if (command("shake"))
   {
      goto no_quest;
   }
   addextra(pc.quests,{DEVIL_QUEST_ONGOING},"");
   exec("emote whispers 'Good! Please hurry I don't have much time "+
      "left.'",self);
   pause;
   unsecure(pc);
   goto start;

:no_quest:
   exec("sigh",self);
   pause;
   exec("say So be it.",self);
   unsecure(pc);
   heartbeat := PULSE_SEC*30;
   pause;
   heartbeat := PULSE_SEC*5;
   goto start;

:endstart:
   if(DEVIL_QUEST_ONGOING in pc.quests)  goto get_item;
   unsecure(pc);
   goto start;

:get_item:
   if(not(DEVIL_QUEST_ONGOING in activator.quests))
   {
      exec("say I dont need this!!",self);
      exec("drop "+medium.name,self);
      goto start;
   }
   if((medium.title=="a portal scroll") and
      ("portal scroll" in medium.names))
   {
      destroy(medium);
      exec("emote whispers 'You have saved me.'",self);
      pause;
      exec("emote whispers 'Allow me to reward you for your "+
         "efforts.'",self);
      pause;
      obj:=load("dark_anklet@abyss1");
      link(obj,pc);
      act("$3n gives you a Dark Anklet.",
         A_SOMEONE,pc,null,self,TO_CHAR);
      act("$3n gives $1n a Dark Anklet.",
         A_SOMEONE,pc,null,self,TO_REST);
      pause;
      exec("emote recites the portal scroll",self);
      pause;
      act("The portal pulses with bright light and opens!",
         A_ALWAYS,self,null,null,TO_ALL);
      subextra(pc.quests,DEVIL_QUEST_ONGOING);
      addextra(pc.quests,{DEVIL_QUEST_FINISHED},"");
      experience(1500,pc);
      pause;
      act("The portal closes again after the devil crawls through.",
         A_ALWAYS,self,null,null,TO_ALL);
      act("You have gained 1500xp",A_ALWAYS,pc,null,null,TO_CHAR);
      unsecure(pc);
      destroy(self);
   }
   else
   {
      exec("emote whispers 'This won't work.'",self);
      exec("give "+medium.name+" "+pc.name,self);
      goto start;
   }

:ina_fight:
   heartbeat:=PULSE_SEC*2;
   while(self.position==POSITION_FIGHTING) pause;
   heartbeat:=PULSE_SEC*5;
   goto start;

:lost_pc:
   exec("sigh",self); pause;
   exec("say Nice talking to you too.",self); pause;
   unsecure(pc);
   goto start;

}
dilend /* devil_q */

end /* dying_devil */

/*
   Lives inside the belly of the stoned titan buried in the plain of ash
*/

			parasite
names {"parasite"}
title "a parasite"
descr "A parasite is here feeding on the stomach's interior."

extra {}
"The parasite resembles a large spider. It has spidery legs and body but the
head is more like that found on other demons. Although the eyes are insect
like the mouth is filled with large teeth and you see saliva dripping out of
it."

PARASITE(80)
special SFUN_AGGRESSIVE "$1n doesn't want to share this space!"
   time 100 bits SFB_RANTIME

alignment -900

end /* parasite */

/* ------------------------ BOATMAN --------------------------------- */

/*
   The boatman provides passage into the abyss and is the only way of
   getting in here. He wants 1 gold piece in payment for his service. He
   doesn't provide the players with a way out though. The players can only
   exit the Abyss jumping out of the eyesockets in the skull fortress,
   falling off    one of the chains leading to the fortress (or the lower
   jaw) and with dragon wings
*/

			boatman
names {"styx boatman","boatman","rozof"}
title "a styx boatman"
descr "Rozof, a Styx boatman is standing here."

extra {}
"Although a demon, Rofoz is more human in appearance than the average demon.
He stands tall and is little skinny. His eyesockets are deep and it is
relatively easy to make out the form of his skull since his face does not
hold a lot of flesh. You notice him holding up his hand cupped. Maybe you
should say '&cbseek passage&cw'."

STYX_BOATMAN(150)

flags {UNIT_FL_NO_TELEPORT}
exp 100
alignment -500

dilbegin boat_main();

var
   pc		: unitptr;
   u		: unitptr;
   i		: integer;

code {

:init:
   heartbeat := PULSE_SEC*5;
   i := interrupt(SFB_COM,self.position==POSITION_FIGHTING,in_fight);
:start:
   wait(SFB_DONE,(command(CMD_SAY)) and
		 (activator.type==UNIT_ST_PC) and
	         (argument=="seek passage"));
   pc := activator;
   secure(pc,lost_pc);
   if (transfermoney(pc,null,5120))
   {
      exec("say That will cost you one gold piece "+pc.name+".",self);
      pause;
      act("$1n gestures and you are transfered into the boat.",
	 A_ALWAYS,self,null,pc,TO_VICT);
      act("$1n gestures and $3n is transfered into the boat.",
	 A_ALWAYS,self,null,pc,TO_NOTVICT);
      link(pc,self.outside);
      unsecure(pc);
      pause;
      goto more;
   }
   else
   {
      exec("say You don't have a gold piece to your name "+
         pc.name+"!",self);
      exec("sigh "+pc.name,self);
      unsecure(pc);
      pause;
      goto start;
   }
:more:
   exec("say Does anyone else want to come?",self);
   exec("say Please NOD if you do, or anyone SHAKE their head if "+
      "not",self);
   wait(SFB_DONE,(command(CMD_NOD) or command(CMD_SHAKE)) and
                 (activator.type==UNIT_ST_PC));
   pc := activator;
   secure(pc,lost_pc2);
   if (command(CMD_SHAKE))
   {
      unsecure(pc);
      goto sail;
   }
   if (command(CMD_NOD) and (pc.outside==self.outside))
   {
      exec("say You're already in my boat "+pc.name+"!",self);
      exec("bonk "+pc.name,self);
      unsecure(pc);
      pause;
      goto more;
   }
   if (transfermoney(pc,null,5120))
   {
      exec("say That will cost you one gold piece "+pc.name+".",self);
      pause;
      act("$1n gestures and you are transfered into the boat.",
	 A_ALWAYS,self,null,pc,TO_VICT);
      act("$1n gestures and $3n is transfered into the boat.",
	 A_ALWAYS,self,null,pc,TO_NOTVICT);
      link(pc,self.outside);
      unsecure(pc);
      pause;
      goto more;
   }
   else
   {
      exec("say You don't have a gold piece to your name "+
         pc.name+"!",self);
      exec("sigh "+pc.name,self);
      unsecure(pc);
      pause;
      goto more;
   }

:sail:
   pause;
   exec("emote pushes the boat into the mist using his pole",self);
   pause;
   act("The boat smoothly glides into the fog.",
      A_ALWAYS,self,null,null,TO_ALL);
   link(self.outside,findroom("on_styx@abyss1"));
   foreach (UNIT_ST_PC,u)
   {
      exec("look",u);
   }
   heartbeat := PULSE_SEC*10;
   pause;
   exec("emote pushes the boat forward with his pole.",self);
   pause;
   exec("emote steers the boat in another direction.",self);
   pause;
   exec("emote pushes the boat forward with his pole.",self);
   pause;
   heartbeat := PULSE_SEC*5;
   act("The boat glides into the fog again.",
      A_ALWAYS,self,null,null,TO_ALL);
   pause;
   link(self.outside,findroom("styx_bank01@abyss1"));
   exec("say We have arrived at our destination.",self);
   pause;
   act("$1n gestures and all passengers are transfered out of "+
      "the boat.",A_ALWAYS,self,null,u,TO_NOTVICT);
   foreach (UNIT_ST_NPC|UNIT_ST_PC,u)
   {
      if ((u != self) and (u.outside==self.outside))
      {
         act("$1n gestures and all passengers are transfered out of "+
            "the boat.",A_ALWAYS,self,null,u,TO_NOTVICT);
         link(u,self.outside.outside);
         exec("look",u);
      }
   }
   exec("say I advice you to be careful, it can be dangerous around "+
      "here.",self);
   pause;
   exec("emote waves goodbye.",self);
   pause;
   act("The slender boat disappears into the fog.",
      A_ALWAYS,self,null,null,TO_ALL);
   link(self.outside,findroom("styx_bank02@abyss1"));
   act("A slender boat emerges from the fog.",
      A_ALWAYS,self,null,null,TO_ALL);
   goto start;

:in_fight:
   while(self.position==POSITION_FIGHTING) pause;
   exec("curse",self);
   goto start;

:lost_pc:
   unsecure(pc);
   exec("sigh",self);
   goto start;

:lost_pc2:
   unsecure(pc);
   exec("sigh",self);
   goto more;

}
dilend /* boat_main */

end /* boatman */

/* ------------------------ SPIRITS --------------------------------- */

/*
   Below are 3 spirits representing evil things. They are Goruk's pets.
*/

			asmo
names {"death spirit","decay spirit","spirit","asmo"}
title "Asmo the spirit of death"
descr "Asmo the spirit of death is floating here."

extra {}
"You see a thick black mist floating around. The only thing you can
make out is a vague humanoid form where the mist is thicker than around the
edges."

DEATH_SPIRIT(90)

exp 120
alignment -1000
money 6 SILVER_PIECE

end /* asmo */


			scar
names {"cruelty spirit","spirit","scar"}
title "Scar the spirit of cruelty"
descr "Scar the spirit of cruelty is floating here."

extra {}
"You see a thick gray mist floating around here. The only thing you can
make out is a vague humanoid form where the mist is thicker than around the
edges."

CRUELTY_SPIRIT(85)

exp 120
alignment -1000
money 6 SILVER_PIECE

end /* scar */


			stab
names {"murder spirit","spirit","stab"}
title "Stab the spirit of murder"
descr "Stab the spirit of murder is floating here."

extra {}
"You see a thick red mist floating around here. The only thing you can
make out is a vague humanoid form where the mist is thicker than around the
edges."

MURDER_SPIRIT(88)

exp 100
alignment -1000
money 6 SILVER_PIECE

end /* scar */

/* ------------------------ VROCKS ---------------------------------- */

			vrock_1
names {"vrock"}
title "a Vrock"
descr "A deadly looking vrock is here searching for prey."

extra {}
"It looks like a cross-breed of human and vulture. It has a humanoid torso
but the head, legs and wings on it's back are those of a vulture. The way it
looks at you tells you it will find great pleasure in ripping you to shreds
with it's mighty claws."

extra {"head"}
"It is exactly like a vulture's head."

extra {"beak"}
"This beak could rip flesh from your body with ease."

extra {"eyes"}
"They are totally black and have a cold and uncaring look to them."

extra {"torso"}
"The torso his broad and heavily muscled. It is the only part of the vrock
that remotely resembles a humanoid form. The colour of his skin is ash gray
and looks a lot tougher than yours."

extra {"claws","claw"}
"They are large and as sharp as knives."

extra {"wings"}
"The wings seem to be big enough to carry their owner through the skies.
They have black feathers with an occasional gray one here and there."

extra {"legs"}
"These legs are birdlike but look very powerful. It might be wise to keep
away from the talons."

VROCK(95)
special SFUN_RANDOM_ZONE_MOVE time 150 bits SFB_RANTIME
special SFUN_AGGRESSIVE "$1n attacks $3n!" time 100 bits SFB_RANTIME
special SFUN_TEAMWORK "vrock"

alignment -900
money 4 SILVER_PIECE

end /* vrock_1 */


			vrock_2
names {"vrock"}
title "a Vrock"
descr "A deadly looking vrock is here searching for surviving devils."

extra {}
"It looks like a cross-breed of human and vulture. It has a humanoid torso
but the head, legs and wings on it's back are those of a vulture. The way it
looks at you tells you it will find great pleasure in ripping you to shreds
with it's mighty claws."

extra {"head"}
"It is exactly like a vulture's head."

extra {"beak"}
"This beak could rip flesh from your body with ease."

extra {"eyes"}
"They are totally black and have a cold and uncaring look to them."

extra {"torso"}
"The torso his broad and heavily muscled. It is the only part of the vrock
that remotely resembles a humanoid form. The colour of his skin is ash gray
and looks a lot tougher than yours."

extra {"claws","claw"}
"They are large and as sharp as knives."

extra {"wings"}
"The wings seem to be big enough to carry their owner through the skies.
They have black feathers with an occasional gray one here and there."

extra {"legs"}
"These legs are birdlike but look very powerful. It might be wise to keep
away from the talons."

VROCK(90)
special SFUN_RANDOM_ZONE_MOVE time 150 bits SFB_RANTIME
special SFUN_AGGRESSIVE "$1n attacks $3n!" time 100 bits SFB_RANTIME
special SFUN_TEAMWORK "vrock"

alignment -900
money 4 SILVER_PIECE

end /* vrock_2 */

/*
   Fortress guard
*/

			guard_vrock
names {"vrock guard","vrock"}
title "a Vrock"
descr "A powerful looking vrock is guarding the area."

extra {}
"It looks like a cross-breed of human and vulture. It has a humanoid torso
but the head, legs and wings on it's back are those of a vulture. The way it
looks at you tells you it will find great pleasure in ripping you to shreds
with it's mighty claws."

extra {"head"}
"It is exactly like a vulture's head."

extra {"beak"}
"This beak could rip flesh from your body with ease."

extra {"eyes"}
"They are totally black and have a cold and uncaring look to them."

extra {"torso"}
"The torso his broad and heavily muscled. It is the only part of the vrock
that remotely resembles a humanoid form. The colour of his skin is ash gray
and looks a lot tougher than yours."

extra {"claws","claw"}
"They are large and as sharp as knives."

extra {"wings"}
"The wings seem to be big enough to carry their owner through the skies.
They have black feathers with an occasional gray one here and there."

extra {"legs"}
"These legs are birdlike but look very powerful. It might be wise to keep
away from the talons."

VROCK(100)

alignment -900
money 4 SILVER_PIECE

special SFUN_TEAMWORK "vrock"

dilbegin g_vrock_act();

var
   pc	: unitptr;
   i	: integer;

code {

:init:
   heartbeat := PULSE_SEC*5;
   i := interrupt(SFB_COM,self.position==POSITION_FIGHTING,in_fight);
:start:
   wait(SFB_DONE,activator.type==UNIT_ST_PC);
   pc := activator;
   secure(pc,lost_pc);
   pause;
   on rnd(0,6) goto a,b,c,d,e,f,g;
:a:
   exec("glare "+pc.name,self);
   goto finish;
:b:
   exec("say If you make any trouble I'll skin you "+pc.name+"!",self);
   goto finish;
:c:
   exec("emote sizes "+pc.name+" up.",self);
   goto finish;
:d:
   exec("emote fingers its weapon.",self);
   goto finish;
:e:
   exec("say One false move and I will tear you apart "+pc.name+"!",self);
   goto finish;
:f:
   exec("emote waves his weapon in "+pc.name+"'s general direction.",self);
   goto finish;
:g:
   exec("emote growls in your direction.",self);
   goto finish;
:finish:
   unsecure(pc);
   pause;
   pause;
   pause;
   pause;
   goto start;

:in_fight:
   while(self.position==POSITION_FIGHTING) pause;
   exec("moo",self);
   goto start;

:lost_pc:
   unsecure(pc);
   pause;
   pause;
   goto start;

}
dilend /* g_vrock_act */

end /* guard_vrock */


			vrock_q
names {"vrock"}
title "a Vrock"
descr "A deadly looking vrock is here searching for surviving devils."

extra {}
"It looks like a cross-breed of human and vulture. It has a humanoid torso
but the head, legs and wings on it's back are those of a vulture. The way it
looks at you tells you it will find great pleasure in ripping you to shreds
with it's mighty claws."

extra {"head"}
"It is exactly like a vulture's head."

extra {"beak"}
"This beak could rip flesh from your body with ease."

extra {"eyes"}
"They are totally black and have a cold and uncaring look to them."

extra {"torso"}
"The torso his broad and heavily muscled. It is the only part of the vrock
that remotely resembles a humanoid form. The colour of his skin is ash gray
and looks a lot tougher than yours."

extra {"claws","claw"}
"They are large and as sharp as knives."

extra {"wings"}
"The wings seem to be big enough to carry their owner through the skies.
They have black feathers with an occasional gray one here and there."

extra {"legs"}
"These legs are birdlike but look very powerful. It might be wise to keep
away from the talons."

VROCK(110)
special SFUN_RANDOM_ZONE_MOVE time 150 bits SFB_RANTIME
special SFUN_AGGRESSIVE "$1n attacks $3n!" time 100 bits SFB_RANTIME
special SFUN_TEAMWORK "vrock"

alignment -900
money 4 SILVER_PIECE

end /* vrock_q */

/* ------------------------ BABAUS ---------------------------------- */


			babau_1
names {"babau"}
title "a Babau"
descr "An evil looking babau is here recruiting soldiers for the blood war."

extra {}
"The babau looks like a skeleton covered with a tough dark red hide. It has
a bony tail with a sharp spike at the end. The Tanar'ri's mouth is filled
with lines of razor sharp teeth and a large horn is mounted on it's skull.
Although one of the less powerful Tanar'ri it still looks dangerous."

extra {"head"}
"The head looks like a skull but with a tough hide covering it, a large
single horn is mounted on top of it. Rows of large pointy teeth line it's
mouth."

extra {"mouth"}
"This demon does not have a problem chewing it's meat."

extra {"eyes"}
"They glow if a soft gray light."

extra {"claws","claw"}
"They are large and as sharp as knives."

extra {"tail"}
"It's a hide covered bony tail with a sharp spike at the end that could do
some serious damage."

BABAU(83)
special SFUN_RANDOM_ZONE_MOVE time 150 bits SFB_RANTIME
special SFUN_AGGRESSIVE "$1n attacks $3n!" time 100 bits SFB_RANTIME
special SFUN_TEAMWORK "babau"

alignment -800
money 4 SILVER_PIECE

end /* babau_1 */


			babau_2
names {"babau"}
title "a Babau"
descr "A Babau walks around guarding the area."

extra {}
"The babau looks like a skeleton covered with a tough dark red hide. It has
a bony tail with a sharp spike at the end. The Tanar'ri's mouth is filled
with lines of razor sharp teeth and a large horn is mounted on it's skull.
Although one of the less powerful Tanar'ri it still looks dangerous."

extra {"head"}
"The head looks like a skull but with a tough hide covering it, a large
single horn is mounted on top of it. Rows of large pointy teeth line it's
mouth."

extra {"mouth"}
"This demon does not have a problem chewing it's meat."

extra {"eyes"}
"They glow if a soft gray light."

extra {"claws","claw"}
"They are large and as sharp as knives."

extra {"tail"}
"It's a hide covered bony tail with a sharp spike at the end that could do
some serious damage."

BABAU(86)
special SFUN_RANDOM_ZONE_MOVE time 150 bits SFB_RANTIME
special SFUN_AGGRESSIVE "$1n attacks $3n!" time 100 bits SFB_RANTIME
special SFUN_TEAMWORK "babau"

alignment -800
money 4 SILVER_PIECE

end /* babau_2 */

/* ----------------------- NABASSU ---------------------------------- */

/*
   The first nabassu is cleaning up the battlefield
*/

			nabassu_1
names {"nabassu"}
title "a Nabassu"
descr "An immature Nabassu is here tossing corpses into the Styx."

extra {}
"This large black skinned Tanar'ri has big claws and feet. Although vaguely
humanoid in posture it's overall appearance tells you it's a demon, not yet
fullgrown but still dangerous."

extra {"head"}
"The demon doesn't seem to have a real neck, or if it does it's as broad as
it's head which features large teeth and a set of burning red eyes."

extra {"mouth"}
"This demon does not have a problem chewing it's meat."

extra {"eyes"}
"They glow if a soft red light."

extra {"claws","claw"}
"They are large and as sharp as knives."

NABASSU(75)
special SFUN_TEAMWORK "nabassu"

alignment -700
money 4 SILVER_PIECE

dilbegin throw_styx();

var
   i	: integer;

code {

:init:
   heartbeat := PULSE_SEC*30;
   i := interrupt(SFB_COM,self.position==POSITION_FIGHTING,in_fight);
:start:
   on rnd(0,3) goto corpse, head, arm, leg;
:corpse:
   act("$1n picks up a corpse and tosses it into the Styx.",
      A_SOMEONE,self,null,null,TO_REST);
   act("The corpse lands in the Styx with a loud splash.",
      A_SOMEONE,self,null,null,TO_REST);
   pause;
   goto start;
:head:
   act("$1n picks up a decapitated head and tosses it into the Styx.",
      A_SOMEONE,self,null,null,TO_REST);
   act("The head lands in the Styx with a dull splash.",
      A_SOMEONE,self,null,null,TO_REST);
   pause;
   goto start;
:arm:
   act("$1n picks up a severed arm and tosses it into the Styx.",
      A_SOMEONE,self,null,null,TO_REST);
   act("The arm lands in the Styx with a splash.",
      A_SOMEONE,self,null,null,TO_REST);
   pause;
   goto start;
:leg:
   act("$1n picks up a severed leg and tosses it into the Styx.",
      A_SOMEONE,self,null,null,TO_REST);
   act("The leg lands in the Styx with a splash.",
      A_SOMEONE,self,null,null,TO_REST);
   pause;
   goto start;

:in_fight:
   heartbeat := PULSE_SEC*3;
   while (self.position == POSITION_FIGHTING) pause;
   exec("curse",self);
   pause;
   exec("emote resumes work.",self);
   heartbeat := PULSE_SEC*30;
   goto start;

}
dilend /* throw_styx */

end /* nabassu_1 */


			nabassu_2
names {"nabassu"}
title "a Nabassu"
descr "A Nabassu is here looking for a victim."

extra {}
"This large black skinned Tanar'ri has big claws and feet. Although vaguely
humanoid in posture it's overall appearance tells you it's a demon, and a
dangerous one at that."

extra {"head"}
"The demon doesn't seem to have a real neck, or if it does it's as broad as
it's head which features large teeth and a set of burning red eyes."

extra {"mouth"}
"This demon does not have a problem chewing it's meat."

extra {"eyes"}
"They glow if a soft red light."

extra {"claws","claw"}
"They are large and as sharp as knives."

NABASSU(83)
special SFUN_RANDOM_ZONE_MOVE time 150 bits SFB_RANTIME
special SFUN_AGGRESSIVE "$1n attacks $3n!" time 100 bits SFB_RANTIME
special SFUN_TEAMWORK "nabassu"

alignment -700
money 4 SILVER_PIECE

end /* nabassu_2 */


			nabassu_3
names {"nabassu"}
title "a Nabassu"
descr "An immature Nabassu is here looking for blood to feed on."

extra {}
"This large black skinned Tanar'ri has big claws and feet. Although vaguely
humanoid in posture it's overall appearance tells you it's a demon, not yet
fullgrown but still dangerous."

extra {"head"}
"The demon doesn't seem to have a real neck, or if it does it's as broad as
it's head which features large teeth and a set of burning red eyes."

extra {"mouth"}
"This demon does not have a problem chewing it's meat."

extra {"eyes"}
"They glow if a soft red light."

extra {"claws","claw"}
"They are large and as sharp as knives."

NABASSU(80)
special SFUN_RANDOM_ZONE_MOVE time 150 bits SFB_RANTIME
special SFUN_AGGRESSIVE "$1n attacks $3n!" time 100 bits SFB_RANTIME
special SFUN_TEAMWORK "nabassu"

alignment -700
money 3 SILVER_PIECE

end /* nabassu_3 */


			nabassu_q
names {"nabassu"}
title "a Nabassu"
descr "A Nabassu is here looking for a victim."

extra {}
"This large black skinned Tanar'ri has big claws and feet. Although vaguely
humanoid in posture it's overall appearance tells you it's a demon, and a
dangerous one at that."

extra {"head"}
"The demon doesn't seem to have a real neck, or if it does it's as broad as
it's head which features large teeth and a set of burning red eyes."

extra {"mouth"}
"This demon does not have a problem chewing it's meat."

extra {"eyes"}
"They glow if a soft red light."

extra {"claws","claw"}
"They are large and as sharp as knives."

NABASSU(83)
special SFUN_RANDOM_ZONE_MOVE time 150 bits SFB_RANTIME
special SFUN_AGGRESSIVE "$1n attacks $3n!" time 100 bits SFB_RANTIME
special SFUN_TEAMWORK "nabassu"

alignment -700
money 4 SILVER_PIECE

end /* nabassu_q */


/* ------------------------ DRETCH ---------------------------------- */

			dretch
names {"dretch"}
title "a Dretch"
descr "A Dretch is here cleaning the jaw."

extra {}
"This is the least powerful Tanar'ri you've seen on this plane. It is
smaller than the others you have encountered thus far. It looks like demon
that is melting and it's flesh hangs about it's bones as if it's about to
drip off."

extra {"head"}
"Not a pretty sight if you can call it a face at all."

extra {"claws","claw"}
"The sagging flesh makes the claws look less dangerous than they really
are."

DRETCH(75)
special SFUN_RANDOM_ZONE_MOVE time 150 bits SFB_RANTIME
special SFUN_TEAMWORK "dretch"

alignment -700
money 2 SILVER_PIECE

end /* dretch */

			dretch_ser01
names {"dretch"}
title "a Dretch"
descr "A Dretch servant is examining a strange table here."

extra {}
"This is the least powerful Tanar'ri you've seen on this plane. It is
smaller than the others you have encountered thus far. It looks like demon
that is melting and it's flesh hangs about it's bones as if it's about to
drip off."

extra {"head"}
"Not a pretty sight if you can call it a face at all."

extra {"claws","claw"}
"The sagging flesh makes the claws look less dangerous than they really
are."

DRETCH(75)

alignment -700
money 2 SILVER_PIECE

end /* dretch_ser01 */


			dretch_ser02
names {"dretch"}
title "a Dretch"
descr "A Dretch servant is here, worshiping the statue."

extra {}
"This is the least powerful Tanar'ri you've seen on this plane. It is
smaller than the others you have encountered thus far. It looks like demon
that is melting and it's flesh hangs about it's bones as if it's about to
drip off."

extra {"head"}
"Not a pretty sight if you can call it a face at all."

extra {"claws","claw"}
"The sagging flesh makes the claws look less dangerous than they really
are."

DRETCH(75)

alignment -700
money 2 SILVER_PIECE

end /* dretch_ser02 */


			prize_foozle
names {"prize foozle","foozle"}
title "&cwa &cmPurple&cw Prize Foozle"
descr "&cwA &cmpurple&cw Furry Fuzzy Prize Foozle happily hops around here."

extra {"eyes"}
"Awwwww how cute."

extra {"mouth"}
"The Foozles mouth seems to be smiling constantly."

race RACE_OTHER_CREATURE
sex SEX_NEUTRAL
height 10
weight 1

flags {UNIT_FL_NO_TELEPORT}
manipulate {MANIPULATE_TAKE}

NATURAL_DEF(WPN_BITE,ARM_CLOTHES)
MSET_ABILITY(13,13,13,13,12,12,12,12)
MSET_WEAPON(8,8,8,8,8,8)
MSET_SPELL(5,4,4,4,5,5,5,5,5,5,5)

level 0
exp -500

alignment 1000

dilcopy catchit@hobgob();

end /* prize_foozle */


/* ################################################################## */
/* ----------------------= OBJECTS SECTION =------------------------- */
/* ################################################################## */

%objects

/* -------------------- BIG BAD WEAPON ------------------------------ */

/*

Comments and stats on the Enforcer of Entropy:
* On level 150 mobile
   Craftmanship		20
   Magical Modifier	13
   spell level		65

   Stat bonus allowed for two worn max level 150: +5 (new rule)
   Strength		+3
   Dexterity		+2

   Skill bonus allowed for level 150: +16 (max of +10 on one)
   Battle axe		+10%

   The spell level was calculated like this:
     Weapons from level 45+ mobs can have 50-75 spell power.
     So 50-75 spell power (25 range) for a 155 (200-45) level mob range.
     Goruk is level 150, 150-45=105
     spell power = 50+(105/155)*25 = 67. I rounded it down to 65

* Dil
   12 charges maximum
   Allowed 12 recharges per 12 mud hours up to maximum
     Enforcer recharges 6 times per 12 mud hours for 2 charges

   The weapon has at the moment TWO dils.
   1. A level 65 SPL_FIREBALL_1 (normal extra damage dil) at 1 charge.
   2. A level 50 berserk (SPL_HASTE and SPL_RAISE_STR) at 3 charges.

   Note: Both dils take charges from the same charge pool.
     At present the second dil is still being discussed.

Note: Goruk (the mob wielding the item has a dil that prevents disarming)

*/


			enforcer
names {"Enforcer of Entropy","entropy","enforcer","battle axe","axe"}
title "&crEnforcer of Entropy&cw"
descr "An evil looking battle axe lies here, withering the ground."

extra {}
"The legendary battle axe looks dark and evil but is beautifully crafted.
The axe's double blades are wrought in cold black steel. The magically
reinforced handle is carved out of bone and features detailed demonic faces
that look as if they are howling in rage."

extra {"double blades","blades","blade"}
"The axe's double blades are made of cold black steel. There are streaks of
blood red within the metal that seem to move with a life of their own."

extra {"handle"}
"The axe's handle was carved in one piece out of solid bone. Along the
length of it you see the faces of demons, faces twisted in agony or howling
with rage. At the bottom of the handle a black gemstone is placed. You
notice a reddish light emenating from it."

extra {"$wear_s"}
"The evil power of your &crEnforcer of Entropy&cw enters your body."

extra {"$wear_o"}
"An evil twinkle appears in $1n's eyes."

extra {"$rem_s"}
"The evil power of your &crEnforcer of Entropy&cw leaves your body."

extra {"$wear_o"}
"The evil twinkle disappears from $1n's eyes."

extra {"$identify"}
"This weapon will raise your &c+bstrength&cw and &c+bdexterity&cw and will
take your &c+bskill&cw with the &c+bbattle axe&cw to new heights. You get
the feeling that giving the command '&crcleave&cw' will add to your weapon's
impact. Be warned though, this weapon recharges by taking some of your life
force from you."

extra {"$improved identify"}
"&lStrength    &c+b+2&cw   Craftmanship      &c+b7&cw
Dexterity   &c+b+2&cw   Magical Modifier  &c+b7&cw
Battle axe &c+b+7%&cw

The weapon will take &c+b25&cw hitpoints from you when it recharges.
It also has a second power activated by giving the command '&crberserk&cw'."

WEAPON_DEF(WPN_BATTLE_AXE,7,7)
MATERIAL_METAL("Cold Black Steel")
weight 20
manipulate {MANIPULATE_TAKE,MANIPULATE_WIELD,MANIPULATE_HOLD}

STR_TRANSFER(+2)
DEX_TRANSFER(+2)
WEAPON_TRANSFER(WPN_BATTLE_AXE,+7)
spell 65  /* spell level */
flags {UNIT_FL_MAGIC}

cost 1462 IRON_PIECE
rent 731 IRON_PIECE

dilcopy level_restrict@function(50,0,0,"");
dilcopy abi_restrict@function(ABIL_STR,100,0,0,"");
dilcopy abi_restrict@function(ABIL_DEX,100,0,0,"");
dilcopy weap_restrict@function(WPN_BATTLE_AXE,80,0,0,"");
dilcopy ali_restrict@function(-350,-1000,0,0,"");

/* charge dil starts here */

dilbegin recall entropy_charger();

code {

:start:
   heartbeat := PULSE_SEC*SECS_PER_MUD_DAY/12; /* 12 * 2 charges per day */
   wait(SFB_TICK,(self.equip==WEAR_WIELD) or (self.equip==WEAR_HOLD));
   heartbeat := PULSE_SEC*3;

   act("Your &crEnforcer of Entropy&cw absorbs some of your life force.",
      A_ALWAYS,self.outside,self,null,TO_CHAR);
   act("$1n's &crEnforcer of Entropy&cw absorbs some of $1n's life force.",
      A_ALWAYS,self.outside,self,null,TO_REST);
   act("You feel the terrors of the Abyss entering your mind.",
      A_ALWAYS,self.outside,self,null,TO_CHAR);
   act("A look of terror appears on $1n's face.",
      A_ALWAYS,self.outside,self,null,TO_REST);

   self.outside.hp := self.outside.hp - 25;
   if (self.outside.hp<=-10)
   {
      self.outside.hp := -9;
   }
   position_update(self.outside);

   sendto("charge",self);

   goto start;

}
dilend /* entropy_charger */

dilbegin recall aware entropy_blast();

var
   enemy	: unitptr;
   result	: integer;
   charge	: integer;
   charges	: integer;
   n		: integer;


code {

   charges := 12;

:init:
   heartbeat := PULSE_SEC*1;
   charge := interrupt(SFB_MSG,(activator==self) and
      (argument=="charge"), charge);

:start:
   wait(SFB_CMD,((activator==self.outside) and
                 (self.equip==WEAR_WIELD)) and
                ((command("cleave") or command("berserk"))));
   if (cmdstr=="cleave")
   {
      /* damage dil starts here */
      block;
      pause;
      enemy := self.outside.fighting;
      if (enemy==null) goto no_enemy;
      secure(enemy,start);
      if (charges<=0) goto empty;
      charges := charges - 1;
      n := rnd(10,110);
      if (n<self.outside.abilities[ABIL_DEX])
      {
         result := cast_spell(SPL_FIREBALL_1,
         self.outside,self,self.outside.fighting,"entropy_eff@abyss1");
      }
      else
      {
         act("You fail to control the power of your &crEnforcer of "+
            "Entropy&cw.",A_SOMEONE,self.outside,enemy,self,TO_CHAR);
      }
      goto start;
   }
   else
   {
      /* berserk dil starts here */
      block;
      pause;
      if (charges<=2) goto empty;
      charges := charges - 3;
      self.spells[SPL_ALL] := 50; /* we want spell level 50 for this */
      result := cast_spell(SPL_HASTE,
         self.outside,self,self.outside,"ent_bers_eff@abyss1");
      self.spells[SPL_ALL] := 65; /* original spell level 65 back now */
      goto start;
   }

:empty:
   act("Your &crEnforcer of Entropy&cw has not accumulated enough power "+
      "yet.",
      A_SOMEONE,self.outside,enemy,self,TO_CHAR);
   goto start;

:no_enemy:
   act("Black mist swirls up where your &crEnforcer of Entropy&cw strikes "+
      "the ground.",A_ALWAYS,self.outside,null,null,TO_CHAR);
   act("Black mist swirls up where $1n's &crEnforcer of Entropy&cw "+
      "strikes the ground.",A_SOMEONE,self.outside,null,null,TO_REST);
   goto start;

:charge:
   clear(charge);
   if (charges<12) charges := charges + 2;
   if (charges>12) charges := 12;
   goto init;
   goto start;

}
dilend /* entropy_blast */

dilbegin entropy_death();

code {

   heartbeat := PULSE_SEC*2;
:start:
   wait(SFB_COM,command(CMD_AUTO_COMBAT) and
      (self.equip==WEAR_WIELD) and
      (self.outside.fighting.hp < 10));
   act("The impact of your &crEnforcer of Entropy&cw OBLITERATES $3n!",
      A_ALWAYS,self.outside,null,self.outside.fighting,TO_CHAR);
   act("The impact of $1n's &crEnforcer of Entropy&cw OBLITERATES you!",
      A_SOMEONE,self.outside,null,self.outside.fighting,TO_VICT);
   act("The impact of $1n's &crEnforcer of Entropy&cw OBLITERATES $3n!",
      A_SOMEONE,self.outside,null,self.outside.fighting,TO_NOTVICT);
   self.outside.fighting.hp := -10;
   pause;
   goto start;

}
dilend /* entropy_death */

end /* enforcer */

/* --------------------- MOBILE EQUIP ------------------------------- */

/*
   Spear of Suffering for level 75 and 79 mobs
   Craftmanship 	12
   Magical Modifier	 8
   Stat bonus allowed: +4
     +2 Str
     +1 Dex
*/

			spear_suffering
names {"a spear of Suffering","spear"}
title "a spear of Suffering"
descr "A spear of Suffering lies here."

extra {}
"This spear looks pretty ordinary and you think it's not the only one of
it's sort. It is made in one piece of cold black steel, but it is lighter
than you expected."

WEAPON_DEF(WPN_SPEAR,0,0)
MATERIAL_METAL("Cold Black Steel")
weight 15
manipulate {MANIPULATE_TAKE,MANIPULATE_WIELD,MANIPULATE_HOLD}

flags {UNIT_FL_MAGIC}

cost 328 IRON_PIECE
rent 164 IRON_PIECE

dilcopy level_restrict@function(40,0,0,"");
dilcopy abi_restrict@function(ABIL_STR,70,0,0,"");
dilcopy abi_restrict@function(ABIL_DEX,70,0,0,"");

end /* spear_suffering */

/*
   Cutting Katana for level 100 mob
     Craftmanship	13 (14 allowed)
     Magical Modifier	 8 (9 allowed)
   Stat bonus allowed: +5
     +3 Strength
     +1 Dexterity
*/

			cutting_katana
names {"a katana of cutting","katana of cutting","katana"}
title "a katana of cutting"
descr "A katana of cutting lies here."

extra {}
"It looks like a katana but the blade's edge is barbed and looks like it can
tear open flesh with ease."

extra {"$identify"}
"Wielding this katana will increase your &c+bstrength&cw and
&c+bdexterity&cw."

manipulate {MANIPULATE_TAKE,MANIPULATE_WIELD,MANIPULATE_HOLD}
flags {UNIT_FL_MAGIC}

WEAPON_DEF(WPN_KATANA,4,4)
MATERIAL_METAL("Cold gleaming steel")
weight 15

STR_TRANSFER(+1)
DEX_TRANSFER(+1)
flags {UNIT_FL_MAGIC}

cost 328 IRON_PIECE
rent 164 IRON_PIECE

dilcopy level_restrict@function(45,0,0,"");
dilcopy abi_restrict@function(ABIL_STR,70,0,0,"");
dilcopy abi_restrict@function(ABIL_DEX,70,0,0,"");

end /* cutting_katana */

/*
   Belt of Command on Irchak, Goruk's general (level 125)
     Craftmanship/Magical Modifier N.A.
   Stat bonus allowed: +6
     +2 Strength
     +2 Dexterity
     +2 Charisma
   Skill bonus allowed: +13%
     +7% command spell skill
*/


			belt_of_command
names {"belt of command","belt"}
title "the belt of Command"
descr "An impressing looking belt is lying here."

extra {}
"This large awe inspiring leather belt looks like one fit for a leader. The
gem encrusted buckle is shaped like a shield on top of a sword."

extra {"$identify"}
"Wielding this belt will increase your &c+bstrength&cw, &c+bdexterity&cw
and &c+bcharisma&cw. It will also raise your &c+bskill&cw in the &c+bcommand
spell&cw."

MATERIAL_LEATHER("Black leather")
weight 1
manipulate {MANIPULATE_TAKE,MANIPULATE_HOLD,MANIPULATE_WEAR_WAIST}

STR_TRANSFER(+1)
DEX_TRANSFER(+1)
CHA_TRANSFER(+1)
flags {UNIT_FL_MAGIC}


cost 412 IRON_PIECE
rent 206 IRON_PIECE

dilcopy level_restrict@function(50,0,0,"");
dilcopy abi_restrict@function(ABIL_STR,70,0,0,"");
dilcopy abi_restrict@function(ABIL_DEX,70,0,0,"");
dilcopy abi_restrict@function(ABIL_CHA,70,0,0,"");

end /* belt_of_command */

/*
   Next 3 items (chopping blade, wooden spoon, greasy apron) on Blork
   the cook (level 60)
     Craftmanship 	11 (11 allowed)
     Magical Modifier	 7 (7 allowed)
   No other bonuses applied
*/


			chopping_blade
names {"a large chopping blade","chopping blade","blade"}
title "a large chopping blade"
descr "A large chopping blade rests on the ground here."

extra {}
"This chopping blade is a chef's finest. It is razorsharp and could be used
to chop both dead and living flesh."

WEAPON_DEF(WPN_HAND_AXE,0,0)
MATERIAL_METAL("Steel")
weight 3
manipulate {MANIPULATE_TAKE,MANIPULATE_WIELD,MANIPULATE_HOLD}

cost 112 IRON_PIECE
rent 56 IRON_PIECE

dilcopy level_restrict@function(35,0,0,"");

end /* chopping_blade */


			wooden_spoon
names {"a wooden spoon","wooden spoon","spoon"}
title "a wooden spoon"
descr "A wooden spoon rests on the ground here."

extra {}
"This large wooden kitchen utensil is exellent for stirring in cauldrons."

WEAPON_DEF(WPN_CLUB,0,0)
MATERIAL_WOOD("wood")
weight 2
manipulate {MANIPULATE_TAKE,MANIPULATE_WIELD,MANIPULATE_HOLD}

cost 112 IRON_PIECE
rent 56 IRON_PIECE

dilcopy level_restrict@function(35,0,0,"");

end /* wooden_spoon */


		 greasy_apron
names {"greasy apron","apron"}
title "Greasy Apron"
descr "A greasy apron soils the ground here."

extra {}
"The apron is made of sturdy canvas and is made stronger by the large
amounts of grease and food residue that have soaked into it."


manipulate {MANIPULATE_TAKE, MANIPULATE_WEAR_BODY}
ARMOUR_CHAIN(0,0)
MATERIAL_CLOTH("dirty canvas")
weight 2
manipulate {MANIPULATE_TAKE, MANIPULATE_WEAR_BODY}

cost 112 IRON_PIECE
rent 56 IRON_PIECE

dilcopy level_restrict@function(35,0,0,"");

end /* greasy_apron */

/*
   Battle mace on Xorlock the high Priest (level 110)
     Craftmanship	15 (16 allowed)
     Magical Modifier	 9 (10 allowed)
   No other bonuses applied
*/


			battle_mace
names {"a huge battle mace","battle mace","mace"}
title "a huge battle mace"
descr "A battle mace lies here."

extra {}
"This is an ordinary looking battle mace but it looks big and deadly."


WEAPON_DEF(WPN_BATTLE_MACE,0,0)
MATERIAL_METAL("Black Steel")
weight 20
manipulate {MANIPULATE_TAKE,MANIPULATE_WIELD,MANIPULATE_HOLD}

cost 144 IRON_PIECE
rent 72 IRON_PIECE

dilcopy level_restrict@function(40,0,0,"");

end /* battle_mace */

/*
   Broad sword on Irchak the general (level 125)
     Craftmanship	17 (17 allowed)
     Magical Modifier	11 (11 allowed)
   No other bonuses applied
*/

			broad_sword
names {"abyssal broadsword","broadsword","broad sword","sword"}
title "an abyssal broadsword"
descr "An abyssal broadsword lies here."

extra {}
"This is an ordinary looking broadsword was forged in the Abyss. Evil
looking decorations run along the hilt."

WEAPON_DEF(WPN_BROAD_SWORD,0,0)
MATERIAL_METAL("Black Steel")
weight 15
manipulate {MANIPULATE_TAKE,MANIPULATE_WIELD,MANIPULATE_HOLD}

cost 144 IRON_PIECE
rent 72 IRON_PIECE

dilcopy level_restrict@function(40,0,0,"");

end /* broad_sword */

/*
   The following set of armour is found on both Irchak (level 125) and
   Xorlock (level 110)
     Craftmanship	15 (16 allowed considering level 110)
     Magical Modifier	 8 (10 allowed considering level 110)
     On plate only:
     Magical Modifier	10 (10 allowed considering level 110)
   No other bonuses applied
*/


	         abyssal_helmet
names {"abyssal helmet","helmet"}
title "Abyssal Helmet"
descr "An abyssal helmet lies here."

extra{}
"This piece of armour was forged in the abyss from an alloy ofmetals found
here."


ARMOUR_PLATE(0,0)
MATERIAL_METAL("A dull gray metal")
weight 10
manipulate {MANIPULATE_TAKE, MANIPULATE_WEAR_HEAD}

cost 128 IRON_PIECE
rent 64 IRON_PIECE

dilcopy level_restrict@function(40,0,0,"");

end /* abyssal_helmet */


		abyssal_sleeves
names {"abyssal sleeves","sleeves"}
title "Abyssal Sleeves"
descr "A pair of abyssal sleeves lies here."

extra{}
"This piece of armour was forged in the abyss from an alloy ofmetals found
here."


ARMOUR_PLATE(0,0)
MATERIAL_METAL("A dull gray metal")
weight 10
manipulate {MANIPULATE_TAKE, MANIPULATE_WEAR_ARMS}

cost 128 IRON_PIECE
rent 64 IRON_PIECE

dilcopy level_restrict@function(40,0,0,"");

end /* abyssal sleeves */


		 abyssal_gloves
names {"abyssal gloves","gloves"}
title "Abyssal Gloves"
descr "A pair of abyssal gloves lies here."

extra{}
"This piece of armour was forged in the abyss from an alloy ofmetals found
here."


ARMOUR_PLATE(0,0)
MATERIAL_METAL("A dull gray metal")
weight 5
manipulate {MANIPULATE_TAKE, MANIPULATE_WEAR_HANDS}

cost 128 IRON_PIECE
rent 64 IRON_PIECE

dilcopy level_restrict@function(40,0,0,"");

end /* abyssal_gloves */


		 abyssal_plate
names {"abyssal plate","plate"}
title "Abyssal Plate"
descr "An abyssal plate lies here."

extra{}
"This piece of armour was forged in the abyss from an alloy ofmetals found
here."


ARMOUR_PLATE(0,0)
MATERIAL_METAL("A dull gray metal")
weight 15
manipulate {MANIPULATE_TAKE, MANIPULATE_WEAR_BODY}

cost 160 IRON_PIECE
rent 80 IRON_PIECE

dilcopy level_restrict@function(40,0,0,"");

end /* abyssal_plate */


		 abyssal_legging
names {"abyssal leggings","leggings"}
title "Abyssal Leggings"
descr "A pair of abyssal leggings lies here."

extra{}
"This piece of armour was forged in the abyss from an alloy ofmetals found
here."

ARMOUR_PLATE(0,0)
MATERIAL_METAL("A dull gray metal")
weight 10
manipulate {MANIPULATE_TAKE, MANIPULATE_WEAR_LEGS}

cost 128 IRON_PIECE
rent 64 IRON_PIECE

dilcopy level_restrict@function(40,0,0,"");

end /* abyssal_leggings */


		 abyssal_boots
names {"abyssal boots","boots"}
title "Abyssal Boots"
descr "A pair of abyssal boots lies here."

extra{}
"This piece of armour was forged in the abyss from an alloy ofmetals found
here."


ARMOUR_PLATE(0,0)
MATERIAL_METAL("A dull gray metal")
weight 5
manipulate {MANIPULATE_TAKE, MANIPULATE_WEAR_FEET}

cost 128 IRON_PIECE
rent 64 IRON_PIECE

dilcopy level_restrict@function(40,0,0,"");

end /* abyssal_boots */

/*
   Black robe on The Styx Boatman (level 120)
     Craftmanship	16 (17 allowed)
     Magical Modifier	10 (11 allowed)
   Stat bonus allowed for can only wear one level 120: +6
     +2 Brain
     +2 Dexterity
     +1 Magic power
*/

		 black_robe
names {"black robe","robe"}
title "a black robe"
descr "A black robe rests on the ground here."

extra {}
"It is made of rich black cloth but is otherwise devoid of decorations."

extra {"$identify"}
"This weapon will raise your &c+brain&cw, &c+bdexterity&cw and &c+magic
power&cw."

extra {"$improved identify"}
"&lBrain       &c+b+1&cw
Dexterity   &c+b+1&cw
Magic power &c+b+1&cw"

ARMOUR_PLATE(0,0)
MATERIAL_CLOTH("black cloth")
weight 2
manipulate {MANIPULATE_TAKE, MANIPULATE_WEAR_BODY}

BRA_TRANSFER(+1)
DEX_TRANSFER(+1)
MAG_TRANSFER(+1)
flags {UNIT_FL_MAGIC}

cost 410 IRON_PIECE
rent 205 IRON_PIECE

dilcopy level_restrict@function(50,0,0,"");
dilcopy abi_restrict@function(ABIL_BRA,70,0,0,"");
dilcopy abi_restrict@function(ABIL_DEX,70,0,0,"");
dilcopy abi_restrict@function(ABIL_MAG,45,0,0,"");

end /* black_robe */

/*
   Gray robe on Acina the archmage (level 110)
     Craftmanship	16 (16 allowed)
     Magical Modifier	10 (10 allowed)
   Stat bonus allowed for can only wear one level 120: +5
     +2 Brain
     +2 Charisma
     +1 Magic power
*/

		 gray_robe
names {"gray robe","robe"}
title "a gray robe"
descr "A gray robe rests on the ground here."

extra {}
"It is made out of fine high quality cloth and is embroidered with arcane
symbols."

ARMOUR_PLATE(0,0)
MATERIAL_CLOTH("gray cloth")
weight 2
manipulate {MANIPULATE_TAKE, MANIPULATE_WEAR_BODY}
flags {UNIT_FL_MAGIC}

cost 410 IRON_PIECE
rent 205 IRON_PIECE

dilcopy level_restrict@function(50,0,0,"");
dilcopy abi_restrict@function(ABIL_BRA,70,0,0,"");
dilcopy abi_restrict@function(ABIL_CHA,70,0,0,"");
dilcopy abi_restrict@function(ABIL_MAG,45,0,0,"");

end /* gray_robe */

/*
   Pole on The Styx Boatman (level 120)
     Craftmanship	15 (17 allowed)
     Magical Modifier	 9 (11 allowed)
   Stat bonus allowed for can only wear one level 120: +6
     +3 Strength
     +1 Dexterity
*/

			boatman_pole
names {"a boatman pole","boatman pole","pole"}
title "a boatman pole"
descr "A boatman's pole lies on the ground here."

extra {}
"This is a very large pole that can be used to push a boat through the
water. It can be used to thump people on the head too if used by skilled
hands."

WEAPON_DEF(WPN_QUARTERSTAFF,0,0)
MATERIAL_WOOD("wood")
weight 10
manipulate {MANIPULATE_TAKE,MANIPULATE_WIELD,MANIPULATE_HOLD}

flags {UNIT_FL_MAGIC}

cost 144 IRON_PIECE
rent 72 IRON_PIECE

dilcopy level_restrict@function(50,0,0,"");
dilcopy abi_restrict@function(ABIL_STR,70,0,0,"");
dilcopy abi_restrict@function(ABIL_DEX,50,0,0,"");

end /* boatman_pole */

                  styx_boat

names {"styx boat","boat"}
title "a styx boat"
descr "An elegant Styx boat lies in the middle of the Styx here."

extra {}
"It is a very elegant boat and although it looks slender it seems to be very
stable. In it's side are carved various faces that are in pain, sad of
suffering. It fits the deadly and sad river Styx nicely."

type ITEM_BOAT
MATERIAL_WOOD("special wood")
weight 200
CONTAINER_DEF(10000)
flags {UNIT_FL_NO_TELEPORT,UNIT_FL_TRANS,UNIT_FL_NOSAVE}

cost 100 PLATINUM_PIECE
rent 50 PLATINUM_PIECE

end /* styx_boat */

/* --------------------- QUEST REWARD ------------------------------- */

/*
   Reward for my quest
   Craftmanship/Magical Modifier N.A.
   Stat bonus allowed on quest anklet +2 total
   +1 Dexterity
   +1 Charisma
*/

			dark_anklet
names {"a dark anklet","dark anklet","anklet"}
title "a &c+nDark Anklet&cw"
descr "Someone's &c+nDark Anklet&cw rests on the ground here."

extra {}
"This anklet is made of a black metal that is unknown to you. You notice
arcane runes engraved in it. As you touch the metal a dark power enters your
body."

extra {"$identify"}
"&lDexterity   &c+b1&cw
Charisma     &c+b1&cw"

type ITEM_WORN
MATERIAL_METAL("black metal")
weight 1
manipulate {MANIPULATE_TAKE,MANIPULATE_WEAR_ANKLE,MANIPULATE_HOLD}

CHA_TRANSFER(+1)
DEX_TRANSFER(+1)
flags {UNIT_FL_MAGIC}

dilcopy quest_restrict@function(DEVIL_QUEST_FINISHED,0,0,"");

end /* dark_anklet */

/* --------------------- QUEST OBJECTS ------------------------------ */

			nab_hide
names {"nabassu hide","hide"}
title "a piece of nabassu hide"
descr "A piece of nabassu hide lies here."
extra {}
"It is a very tough piece of hide that provides good protection."

type ITEM_OTHER
weight 1
manipulate {MANIPULATE_TAKE, MANIPULATE_HOLD}

spell 150

end /* nab_hide */


			vrock_feather
names {"vrock feather","feather"}
title "a white vrock feather"
descr "A vrock feather lies here."
extra {}
"It's a large feather, white in colour, which is very uncommon on a vrock."

type ITEM_OTHER
weight 0
manipulate {MANIPULATE_TAKE, MANIPULATE_HOLD}

spell 150

end /* vrock_feather */


			crimson_gem
names {"crimson gem","gem"}
title "a crimson gem"
descr "A crimson gem rests on the ground here."
extra {}
"It's a reasonably large gem, deep crimson in colour."

type ITEM_OTHER
weight 0
manipulate {MANIPULATE_TAKE, MANIPULATE_HOLD}

spell 150

end /* crimson_gem */


			vial_empty
names {"crystal vial","vial","water"}
title "a crystal vial"
descr "A crystal vial rests on the ground here."
extra {}
"The vial sparkles a little as you hold it up to the light. Maybe you should
try to &cbhold the vial&cw and &cbfill vial&cw at a proper place."

LIQ_DEF(LIQ_WATER,2,20,0,0)
MATERIAL_GLASS("sparkling clear crystal")
manipulate {MANIPULATE_TAKE, MANIPULATE_HOLD}

/*
   Link full vial with styx water into the player's inventory if 'fill vial'
   is commanded at a room bordering the river Styx in this zone.
   Empty vial is destroyed.
*/

dilbegin hold_fill();

var
   pc	: unitptr;
   obj  : unitptr;

code {

:init:
   heartbeat := PULSE_SEC*3;
:start:
   wait(SFB_CMD,command("fill") and ("vial" in argument));
   pc := activator;
   if ((self.equip == WEAR_HOLD) and (pc==self.outside))
   {
      block;
      if ("vialfill" in self.outside.outside.names)
      {
         obj := load("vial_full@abyss1");
         link(obj,pc);
         act("You fill the vial with water from the Styx.",A_ALWAYS,
            self.outside,null,null,TO_CHAR);
         act("$1n fills the vial with water from the Styx.",A_ALWAYS,
            self.outside,null,null,TO_REST);
         destroy(self);
      }
      else
      {
         act("You can't fill it here!",A_ALWAYS,
            self.outside,null,null,TO_CHAR);
      }
   }

}
dilend /* hold_fill */

end /* vial_empty */


			vial_full
names {"full crystal vial","crystal vial","vial"}
title "a full crystal vial"
descr "A fulll crystal vial rests on the ground here."
extra {}
"The vial sparkles a little as you hold it up to the light."

type ITEM_OTHER
MATERIAL_GLASS("sparkling clear crystal")
manipulate {MANIPULATE_TAKE, MANIPULATE_HOLD}

end /* vial_full */


			portal_scroll
names {"a portal scroll","portal scroll","scroll"}
title "a portal scroll"
descr "A strange portal scroll lies here."
extra {}
"You can't make anything of it. Must be some alien kind of magic! Strange
runes seem to move as you look at them."

type ITEM_SCROLL
MATERIAL_CLOTH("nabassu hide")
manipulate {MANIPULATE_TAKE}

end /* portal_scroll */

/*
   Lord key below is key for door to the secret symbol room that leads to
   the room of Abyssal lords.
*/

			lord_key
names {"key of abyssal lords","key of lords","key","lord_key"}
title "the key of Abyssal lords"
descr "An evil looking black object lies here, catching you attention."
extra {}
"The key is really a disk wrought of black steel, somewhat like a big coin.
On both sides are arcane symbols that you can't read."

type ITEM_OTHER
weight 0
manipulate {MANIPULATE_TAKE, MANIPULATE_HOLD}

end /* lord_key */

/* --------------------- MISC STUFF --------------------------------- */

			sign
names {"large sign","sign"}
title "a large sign"
descr "A &crSIGN&cw is posted here."
extra {}
"&l
&s1____________________
|                    |
|     &c+nDARK LANDS&cw     |
|lie beyond  the Styx|
|groups level &cr50&cw only|
|____________________|
&s10||
&s10||
&s10||
&s1&cg'`^~^'`~^'`^~'`^~^'`&cw"

type ITEM_OTHER
weight 1000

end /* sign */

/* -------------------- ONLINE QUEST STUFF ---------------------------- */

			foozle_red
names {"red quest foozle","quest foozle","red foozle","foozle","qf","rqf"}
title "a &crRed&cw Quest Foozle"
descr "A small &crRed&cw Furry Fuzzy Fluffy Quest Foozle is hiding here."

extra {}
"This &crred&cw Foozle is a small furry little ball that is just big enough
to fill your hand. It shyly looks back at you with little beady eyes that
could beat those of a puppy anytime, anyday, and it smiles a little as it
produces a soft giggle. Foozles love to be stroked, ruffled and snuggled and
just doing that makes them happy and content."

extra {"$identify"}
"&l
This Foozle is for high level players (50+)
It has a spell level of 150 to prevent easy location."

type ITEM_OTHER
weight 0
manipulate {MANIPULATE_TAKE, MANIPULATE_HOLD}

spell 199

dilcopy give_move@abyss1();
dilcopy foozle_destroy@abyss1();
dilcopy foozle_happy@abyss1();
dilcopy give_tricky@abyss1();

end /* foozle_red */


			foozle_yellow
names {"yellow quest foozle","quest foozle","yellow foozle","foozle","qf","yqf"}
title "a &c+yYellow&cw quest Foozle"
descr "A small &c+yYellow&cw furry fuzzy fluffy quest Foozle is hiding here."

extra {}
"This &c+yyellow&cw Foozle is a small furry little ball that is just big enough
to fill your hand. It shyly looks back at you with little beady eyes that
could beat those of a puppy anytime, anyday, and it smiles a little as it
produces a soft giggle. Foozles love to be stroked, ruffled and snuggled and
just doing that makes them happy and content."

extra {"$identify"}
"&l
This Foozle is for high level players (50+)
It has a spell level of 150 to prevent easy location."

type ITEM_OTHER
weight 0
manipulate {MANIPULATE_TAKE, MANIPULATE_HOLD}

spell 75

dilcopy give_move@abyss1();
dilcopy foozle_destroy@abyss1();
dilcopy foozle_happy@abyss1();
dilcopy give_tricky@abyss1();

end /* foozle_yellow */


			foozle_blue
names {"blue quest foozle","quest foozle","blue foozle","foozle","qf","bqf"}
title "a &cbBlue&cw quest Foozle"
descr "A small &cbBlue&cw furry fuzzy fluffy quest Foozle is hiding here."

extra {}
"This &cbblue&cw Foozle is a small furry little ball that is just big enough
to fill your hand. It shyly looks back at you with little beady eyes that
could beat those of a puppy anytime, anyday, and it smiles a little as it
produces a soft giggle. Foozles love to be stroked, ruffled and snuggled and
just doing that makes them happy and content."

extra {"$identify"}
"&l
This Foozle is for medium level players (25-50)
It has a spell level of 40 to prevent easy location."

type ITEM_OTHER
weight 0
manipulate {MANIPULATE_TAKE, MANIPULATE_HOLD}

spell 40

dilcopy give_move@abyss1();
dilcopy foozle_destroy@abyss1();
dilcopy foozle_happy@abyss1();
dilcopy give_tricky@abyss1();

end /* foozle_blue */


			foozle_green
names {"green quest foozle","quest foozle","green foozle","foozle","qf","gqf"}
title "a &cgGreen&cw quest Foozle"
descr "A &cgGreen&cw furry fuzzy fluffy quest Foozle is hiding here."

extra {}
"This &cggreen&cw Foozle is a small furry little ball that is just big
enough to fill your hand. It shyly looks back at you with little beady
eyes that could beat those of a puppy anytime, anyday, and it smiles a
little as it produces a soft giggle. Foozles love to be stroked, ruffled and
snuggled and just doing that makes them happy and content."

extra {"$identify"}
"&l
This Foozle is for low level players (up to 25) or if you don't want any spell
level on the Foozle."

type ITEM_OTHER
weight 0
manipulate {MANIPULATE_TAKE, MANIPULATE_HOLD}

dilcopy give_move@abyss1();
dilcopy foozle_destroy@abyss1();
dilcopy foozle_happy@abyss1();
dilcopy give_tricky@abyss1();

end /* foozle_blue */


			foozle_black
names {"black quest foozle","quest foozle","black foozle","foozle","qf","nqf"}
title "a &c+nBlack&cw quest Foozle"
descr "A &c+nBlack&cw furry fuzzy fluffy quest Foozle is hiding here."

extra {}
"This &c+nblack&cw Foozle is a small furry little ball that is just big
enough to fill your hand. It shyly looks back at you with little beady eyes
that could beat those of a puppy anytime, anyday, and it smiles a little as
it produces a soft giggle. Foozles love to be stroked, ruffled and snuggled
and just doing that makes them happy and content."

extra {"$identify"}
"&l
This Foozle is made to be very hard to find.
It has a spell level of 150 and has an invisible flag."

type ITEM_OTHER
weight 0
manipulate {MANIPULATE_TAKE, MANIPULATE_HOLD}

flags {UNIT_FL_INVISIBLE}

spell 199

dilcopy give_move@abyss1();
dilcopy foozle_destroy@abyss1();
dilcopy foozle_happy@abyss1();
dilcopy give_tricky@abyss1();

end /* foozle_black */


			foozle_box
names {"foozle box","prize box","box"}
title "a Prize Foozle box"
descr "A Prize Foozle box rests on the ground here."

extra {}
"This box holds a prize Foozle until the prize winner opens the box and
claims the cute Foozle inside. The box is about ten inches wide on each size
and painted in bright happy colors. There are a few holes in the lid that
allow for breathing, although you are not sure if Foozles actually breathe.
To get the Foozle out and claim it just open the box."

extra {"lid"}
"It is painted in bright colors like yellow, red and blue. There are a few
small holes in it."

type ITEM_OTHER
CONTAINER_DEF(5)
open {EX_OPEN_CLOSE,EX_CLOSED}
weight 2
manipulate {MANIPULATE_TAKE}

dilcopy pfoozle_box@abyss1("prize_foozle@abyss1");

end /* foozle_box */


			foozle_guide
names {"foozle guide","guide"}
title "a guide on how to use Foozles"
descr "A guide on Foozles was discarded here."

extra {}
"&l
| A guide on how to use Quest Foozles
| Version 1.00
| Written by Nexus the Foozle Lover

For the Basics       look at 'section A'
For Advanced Use     look at 'section B'
For Prize Foozles    look at 'section C'

Note: There is an Online Quest Board now that you can use with online quest
to post the rules and hints on. That way you don't have to go shouting the
hints all the time and players can look at it if they forgot. You can post
seperate rules/hints and use different color Foozles for level ranges.

That's it.
Nexus the creator of Foozles."

extra {"section A"}
"&lA) The basics

To get yourself a foozle just load one from the abyss1 zone.
You can then place it on the ground somewhere for players to find. Right now
there are 5 kinds of normal Quest Foozles:
* &crRED&cw
  Has a spell level of 199 and is thus VERY hard to locate. Exellent if you
  want it found only by clues.
* &c+yYELLOW&cw
  Has a spell level of 75 and is thus easier to locate. Good for high level
  players.
* &cbBLUE&cw
  Has a spell level of 40 and is reasonably easy to locate Good for medium
  level players.
* &cgGREEN&cw
  Has no spell level and is thus very easy to locate. These are execllent
  for low level players.
* &c+nBLACK&cw
  This is the nastiest of all. It has a spell level of 199 and is invisible.
  This should make for a perfect hunt.

All foozles are named qf also and you can use 'where qf' to keep track of
them or use these for the seperate colors:
'rqf' red
'yqf' yellow
'bqf' blue
'gqf' green
'nqf' black."

extra {"section B"}
"&lB) Advanced use

All Foozles mentioned above have at this time 3 built in functions that can
be activated/used when the foozle is on the ground before you. Non-god
characters can't use these.

* 'lspan <number>' will set the lifespan for the Foozle to <number> minutes.
  The default lifespan is 120 which is 2 hours.

* 'hop <number>' will make the Foozle change rooms every <number> seconds.
  Use the command 'stop' to turn it off when next to the Foozle.
  The Foozle will hop through doors and across zones, but not onto water
  and NO_MOB areas. No doors and zone restriction might be added later.

* 'tricky' This will make the foozle jump out of a players inventory and
   even out of bags within the inventory. To keep the foozle there the
  player has to either 'stroke','snuggle' or 'ruffle' the Foozle once in
  a while. One of these will make the Foozle non-tricky for 10 minutes.
  When first loaded the Foozles will be non-tricky for 5 minutes.
  This can be turned off by giving the command 'nice'."

extra {"section C"}
"&lC) Prize Foozles.

There is a pet foozle that can be given out as a reward. Just load the
'foozle_box@abyss1' and have the player open it. The dil will do the
rest."

type ITEM_OTHER
weight 2

manipulate {MANIPULATE_TAKE,MANIPULATE_HOLD}

end /* foozle_guide */


			online_board
names {"online quest board","online board","board"}
title "the online quest board"
descr "An online quest board hovers in the air here."

extra {}
"This board is used to post messages or clues on during online quests."

type ITEM_OTHER
weight 1000

special SFUN_BULLETIN_BOARD "online"

end /* online_board */


			unfolded_boat
names {"folding boat","boat"}
title "a folding boat"
descr "A folding boat is here."

extra {}
"The folding boat just looks like a regular sturdy boat, but along the rail
you see arcane runes engraved in the wood. The boat looks very heavy, but
you have heard that these can keep folding themselves up further and further
until there is nothing but a small packet of wood left.. Only if you know the
unique magic command word though, and usually only the owner knows it."

extra {"wood"}
"The wood is heavy and strong, and is probably very hard to break since it
is magically reinforced."

extra {"runes"}
"Their meaning is beyond you."

extra {"$identify"}
"This boat will fold itself up into a small light weight packet of wood if
you know its unique magic command word."

extra {"$improved identify"}
"This boat will fold itself up into a small light weight packet of wood if
you know its unique magic command word. It has a capacity of 3000 pounds. It
will not fold the items inside it up with it."

extra {"$enter_s"}
"You climb into the sturdy wooden boat."

extra {"$enter_o"}
"$1n climbs into the sturdy wooden boat."

extra {"$exit_s"}
"You climb out of the sturdy wooden boat."

extra {"$exit_o"}
"$1n climbs out of the sturdy wooden boat."

type ITEM_BOAT
weight 500  /* who ever said solid wood was light? */
manipulate {MANIPULATE_ENTER} /* fold up to take */

CONTAINER_DEF(3000) /* slightly bigger than a canoe */
MATERIAL_WOOD("heavy oak wood")
flags {UNIT_FL_TRANS,UNIT_FL_MAGIC}

cost 50 PLATINUM_PIECE /* This is some piece of work */

end /* unfolded_boat */


			folded_boat
names {"folding boat","packet of wood","wood","packet"}
title "a magical packet of wood"
descr "A magical packet of wood was carelessly left here."

extra {}
"Upon closer inspection you recognize this as what must be a folding boat.
They are very rare, and only a few people that have accomplished great feats
are known to have them. If the right command word is spoken the packet will
unfold itself until it has become a sturdy medium size boat. There are runes
scratched into the wood."

extra {}
"The wood looks strong but is exeptionally light. It is magically reinforced
and thus very hard to break."

extra {"runes"}
"Their meaning is beyond you."

extra {"$identify"}
"This packet of wood will unfold itself until it becomes a medium sized
wooden ship if you know its unique magic command word."

extra {"$improved identify"}
"This packet of wood will unfold itself until it becomes a medium sized
wooden ship with a capacity of 3000 pounds if you know its unique magic
command word."

extra {"$get_s"}
"You pick up the packet of wood noticing it is remarkably light."

extra {"$get_o"}
"$1n picks up a packet of wood with ease, it must be remarkably light."

extra {"$drop_s"}
"You drop the light packet of wood."

extra {"$drop_o"}
"$1n drops are packet of wood that looks to weigh much less than you
thought."

type ITEM_OTHER
weight 2 /* very light folded up, that's the idea */
manipulate {MANIPULATE_TAKE,MANIPULATE_HOLD}

MATERIAL_WOOD("light weight oak wood")
flags {UNIT_FL_MAGIC}

cost 50 PLATINUM_PIECE /* This is some piece of work */

end /* folded_boat */


			creation_hammer
names {"godly hammer of creation","hammer of creation","hammer"}
title "a godly Hammer of Creation"
descr "A godly Hammer of Creation was left here."

extra {}
"This hammer was specially crafted to build a wide variety of things with.
It is highly magical and so powerful only gods can use its powers. It has
a firm wooden handle and a steel head."

manipulate {MANIPULATE_TAKE,MANIPULATE_HOLD,MANIPULATE_WIELD}
flags {UNIT_FL_MAGIC}

WEAPON_DEF(WPN_WAR_HAMMER,25,25)
MATERIAL_METAL("strong shiny steel")
weight 20

dilcopy level_restrict@function(220,0,99,"");

dilbegin hammer_dil();

var
   item		: string;
   obj		: unitptr;
   kind		: string; /* for shielding stuff */
   titlekind	: string;
   shieldstr	: string;
   resiststr	: string;
   shape	: string;
   winner	: string; /* for when owner is needed */
   winnerptr	: unitptr;
   tempstr	: string;

code {

:init:
   heartbeat := PULSE_SEC*3;
:start:
   wait(SFB_CMD,command("create"));
   if ((activator != self.outside) or (activator.level < GOD_LEVEL))
      goto start;
   item := getword(argument);
   if (item == "boat") goto boat;
   if (item == "brooch") goto brooch;

:brooch:
   kind := getword(argument);
   block;
   if (kind == "fire")
   {
      titlekind := "&crFire&cw";
      shieldstr := "101 102 103 127";
      resiststr := "43";
      shape := "is shaped like a small flame";
      goto brfinish;
   }
   if (kind == "cold")
   {
      titlekind := "&ccCold&cw";
      shieldstr := "104 105 106 128";
      resiststr := "44";
      shape := "resembles an ice crystal";
      goto brfinish;
   }
   if (kind == "lightning")
   {
      titlekind := "&c+wLightning&cw";
      shieldstr := "107 108 109 129";
      resiststr := "45";
      shape := "is shaped like a lightning bolt";
      goto brfinish;
   }
   if (kind == "acid")
   {
      titlekind := "&cgAcid&cw";
      shieldstr := "119 120 121 130";
      resiststr := "47";
      shape := "features a deep green emerald.";
      goto brfinish;
   }
   if (kind == "gas")
   {
      titlekind := "&cgGas&cw";
      shieldstr := "110 111 112 131";
      resiststr := "46";
      shape := "resembles small cloud";
      goto brfinish;
   }
   goto start;
:brfinish:
   obj := load("brooch_mold@abyss1");
   dilcopy("shielding_dil@abyss1("+shieldstr+","+resiststr+")",obj);
   tempstr := "brooch of "+kind+" shielding";
   obj.names.[0] := tempstr;
   addstring(obj.names,"brooch");
   obj.title := "Brooch of "+titlekind+" Shielding";
   obj.outside_descr := "A Brooch of "+titlekind+" Shielding has been "+
      "carelessly left here.";
   addextra(obj.extra,{""},
      "These brooches are rare and normally only given to winners of "+
      "online quests. It is made of pure platinum and "+shape+".");
   addextra(obj.extra,{"$improved identify"},
      "This brooch will absorb a total of one "+
      "thousand points of "+kind+" damage done to the wearer. It will "+
      "not absorb more than fifty damage per hit however so some damage "+
      "may still come through when it is cast by exeptionally powerful "+
      "creatures. When the brooch has absorbed the thousand points of "+
      "damage that effect will be expended. The brooch can also give "+
      kind+" resistance as per spell for a total of five times after "+
      "which that function will work no more. The command word for that "+
      "is 'resist'.");
   act("$1n's hammer of creation glows!",
      A_SOMEONE,self.outside,null,null,TO_REST);
   act("Your hammer of creation glows!",
      A_ALWAYS,self.outside,null,null,TO_CHAR);
   act("$1n creates a brooch of "+kind+" Shielding.",
      A_SOMEONE,self.outside,null,null,TO_REST);
   act("You create a brooch of "+kind+" Shielding.",
      A_ALWAYS,self.outside,null,null,TO_CHAR);
   link(obj,self.outside);
   goto start;

:boat:
   winner := getword(argument);
   log("Hammer of Creation : "+winner);
   tempstr := getword(argument);
   winnerptr := findunit(self.outside,winner,FIND_UNIT_WORLD,null);
   winner := winnerptr.name;
   log("Hammer of Creation : "+winner);
   block;
   act("$1n's hammer of creation glows!",
      A_SOMEONE,self.outside,null,null,TO_REST);
   act("Your hammer of creation glows!",
      A_ALWAYS,self.outside,null,null,TO_CHAR);
   act("$1n creates a folding boat.",
      A_SOMEONE,self.outside,null,null,TO_REST);
   act("You create a folding boat.",
      A_ALWAYS,self.outside,null,null,TO_CHAR);
   obj := load("folded_boat@abyss1");
   dilcopy("boat_folded@abyss1("+winner+","+tempstr+")",obj);
   link(obj,self.outside);
   goto start;

}
dilend /* hammer_dil */

end /* creation_hammer */


			brooch_mold
names {"brooch of whatever shielding"}
title "brooch of whatever Shielding"
descr "A brooch of whatever Shielding was carelessly left here."

extra {}
"These brooches are rare and normally only given to winners of online
quests. It is made of pure platinum and shaped like a whatever form."

extra {"$identify"}
"This brooch will increase your protection against magical fire."

extra {"$improved identify"}
"This brooch will absorb a total of one thousand points of whatever damage
done to the wearer. It will not absorb more than fifty damage per hit
however so some damage may still come through when it is cast by
exeptionally powerful creatures. When the brooch has absorbed the thousand
points of damage that effect will be expended. The brooch can also give
resistance as per spell for a total of five times after which that function
will work no more. The command word for that is 'resist'."

type ITEM_OTHER
manipulate {MANIPULATE_TAKE,MANIPULATE_WEAR_CHEST}
MATERIAL_METAL("strong shiny platinum")
weight 0

flags {UNIT_FL_MAGIC}
spell 50
value[1] 1000
value[2] 5

cost 1 PLATINUM_PIECE

end /* brooch_mold */


			horn_blasting
names {"horn of blasting","horn"}
title "a Horn of Blasting"
descr "A platinum horn lies here producing a howling sound."

extra {}
"This horn is made of platinum and is covered all over by golden runes that
produce a soft glow. It is a little under two feet in size and is remarkably
light. Whoever made it posessed great skill and must have spent a long time
making it."

extra {"$identify"}
"Blowing this horn when held will do serious blasting damage to people."

extra {"$get_s"}
"A great feeling of deadly power surges through you as you pick up the horn
of blasting."

extra {"$get_o"}
"$1n grins evilly while picking up the Horn of Blasting."

extra {"$drop_s"}
"You reluctantly place the Horn of Blasting on the ground."

extra {"$drop_o"}
"$1n reluctantly places the Horn of Blasting on the ground."

extra {"$wear_s"}
"You hold the Horn of Blasting and get ready to do some serious damage."

extra {"$wear_o"}
"$1n starts holding the Horn of Blasting. Maybe you should get out of here."

extra {"$rem_s"}
"You stop holding the Horn of Blasting."

extra {"$rem_o"}
"$1n stops using the Horn of Blasting. You feel safer now."

type ITEM_OTHER
manipulate {MANIPULATE_TAKE,MANIPULATE_HOLD}
MATERIAL_METAL("strong shiny platinum")
weight 1

flags {UNIT_FL_MAGIC}
spell 100

cost 1 PLATINUM_PIECE

dilcopy blasting_charge@abyss1();
dilcopy horn_blast@abyss1();

end /* horn_blasting */


/* ------------------------------ MISC STUFF ------------------------- */


			map
names {"valhalla map","valhalla","map"}
title "a large map"
descr "A large map of the various parts of Valhalla hangs on the wall."

extra {}
"&l
			&c+wThe World of Valhalla&cw

The directions are not exact, but I have tried to make them as accurate as
possible. There are three map sections for you to look at:

* Section &c+w1&cw - &c+wUdgaard&cw and its surroundings.
* Section &c+w2&cw - &c+wMidgaard&cw, &c+wRatswharf&cw, &c+wUrland&cw and their surroundings.
* Section &c+w3&cw - &c+wXiyang&cw, &c+wKhorsabad&cw and their surroundings

Notes:
- Links indicated as : are within the zone they are connected to
- Links indicated as = lead to other planes of existance

Lhaeo the Scribe."

extra {"section 1","1"}
"&l
Udgaard and surrounding area

        Killing
        Fields
          |
          | Halfling village
          |  |
&cc*&cwElfdom   |  |      Sewer    Goblins
&cc*&cw      \  |  |        :         :
&cc*&cw       Haon-Dor---&c+yUdgaard&cw---Cypress---> To Midgaard
&cc**************************************&cw->
                               &cc*&cw
                               &cc*&cw
                               &cc*&cw
                    Talen--Nymgaard--Trees
                                       |
                                   Sandy Beach--Baardek Keep"

extra {"section 2","2"}
"&l
Midgaard to Urland and surrounding areas

                          Dwarven            Skaven Arctic Tiamat
                 Undead     Keep              Caves   |    |
                  Keep       |                     >--+--mount--Akaren Keep
                   |       Hills==Citadel    Valley        |
            Death Swamp      |                             |
                 |   =       |                             |
                 | Elemental |   Kithyrn Tower             |
                 |           |        |                    |    Danalek==Hades
      Marches--Moors-Mansion |        +--Clouds            |       |
                 |           |        |                    |    Underdark
To Udgaard<---&c+yMidgaard&cw-------+--------+----&c+yRatswharf&cw----&c+yUrland&cw-<
          <-&cc***&cw:&cc*&cw|&cc*******&cw    |  Lost==+      &cc**********&cw          Gnomes
           Magic |      &cc*&cw    |  Lands |      &cc*&cw        &cc******&cw
         Academy |      &cc*&cw    |    Hobgoblins &cc*&cw
                 |      &cc*&cw    |        =      &cc*&cw
               Etznab   &cc*&cw    |      Gazha    &cc*&cw
                        &cc*&cw    |               &cc*&cw
                        &cc*****&cw|&cc****************&cw
                             |     &cc*&cw
                          Torsbay&cc***&cw
                             |
                          Boats to:
                           - Xiyang (Oriental)
                           - Khorsabad (Ariabian)
                           - Atlantis"

extra {"section 3","3"}
"&l
Xiyang, Khorsabad and surrounding areas


                       &c+yXiyang&cw
                         |         Garden
                         |           :
                         +---------Desert
                         |           |
 The Abyss--Demon Realm  |  Warntz   |
                  =      |   &cc*&cw       |
                  +--&cc*********&cw    &c+yKhorsabad&cw
                                     |
                                     | Cemetery
                                     |  |
                                  Isle of
                                  the Dead"

type ITEM_OTHER
weight 1000

end /* map */


/* ################################################################## */
/* --------------------= RESET SECTION=------------------------------ */
/* ################################################################## */

%reset


/* ------------------------ VROCKS ---------------------------------- */

load vrock_1    	into ash_01 		zonemax 7
load vrock_1    	into ash_08
load vrock_1    	into ash_11 		zonemax 7
load vrock_1    	into s_o_pit 		zonemax 7

load vrock_2 		into battle_01 		zonemax 4
load vrock_2 		into battle_11 		zonemax 4
load vrock_2 		into battle_09 		zonemax 4

/* vrock with quest item */
load vrock_q		into ash_12		zonemax 1
{
   load vrock_feather local 1
}

/* ------------------------ BABAUS ---------------------------------- */

load babau_1 		into ash_06 		zonemax 4
{
   equip spear_suffering	position WEAR_WIELD
}
load babau_1 		into e_o_pit 		zonemax 4
{
   equip spear_suffering	position WEAR_WIELD
}
load babau_1 		into ash_19 		zonemax 4
{
   equip spear_suffering	position WEAR_WIELD
}
load babau_2 		into battle_07 		zonemax 3
{
   equip spear_suffering	position WEAR_WIELD
}
load babau_2 		into battle_03 		zonemax 3
{
   equip spear_suffering	position WEAR_WIELD
}
load babau_2 		into battle_02 		zonemax 3
{
   equip spear_suffering	position WEAR_WIELD
}


/* ----------------------- NABASSU ---------------------------------- */

load nabassu_1 		into battle_04 		local 1
load nabassu_2 		into ash_05 		zonemax 4
load nabassu_2 		into battle_08 		zonemax 4
load nabassu_2 		into battle_01		zonemax 4

load nabassu_3 		into ash_03 		zonemax 5
load nabassu_3 		into ash_17 		zonemax 5
load nabassu_3 		into n_o_pit 		zonemax 5

/* nabassu with quest item */
load nabassu_q		into battle_01		zonemax 1
{
   load nab_hide local 1
}

/* ----------------------- GUARDS ----------------------------------- */

load guard_vrock 	into sk_top01 		local 1
{
   equip cutting_katana		position WEAR_WIELD
}
load guard_vrock 	into sk_mid01 		local 1
{
   equip cutting_katana		position WEAR_WIELD
}
load guard_vrock 	into sk_bot01 		local 1
{
   equip cutting_katana		position WEAR_WIELD
}
load guard_vrock 	into sk_guard_room 	local 2
{
   equip cutting_katana		position WEAR_WIELD
}
load guard_vrock 	into sk_guard_room 	local 2
{
   equip cutting_katana		position WEAR_WIELD
}
load guard_vrock 	into sk_throne_ante 	local 2
{
   equip cutting_katana		position WEAR_WIELD
}
load guard_vrock 	into sk_throne_ante 	local 2
{
   equip cutting_katana		position WEAR_WIELD
}
load guard_vrock 	into sk_entrance 	local 2
{
   equip cutting_katana		position WEAR_WIELD
}
load guard_vrock 	into sk_entrance 	local 2
{
   equip cutting_katana		position WEAR_WIELD
}


/* ----------------------- DRETCH ----------------------------------- */

load dretch	 	into sk_jaw03 		zonemax 5
load dretch	 	into sk_jaw04 		zonemax 5
load dretch	 	into sk_jaw05 		zonemax 5
load dretch_ser02	into sk_temple01 	local 1
load dretch_ser01	into sk_mil_room 	local 1

/* ---------------------- BIG MOBS ---------------------------------- */

load goruk		into sk_throne_room 	max 1
{
   equip enforcer 		position WEAR_WIELD
   load lord_key
}
load irchak		into sk_general_room 	max 1
{
   equip broad_sword		position WEAR_WIELD
   equip belt_of_command	position WEAR_WAIST
   equip abyssal_helmet		position WEAR_HEAD
   equip abyssal_sleeves	position WEAR_ARMS
   equip abyssal_gloves		position WEAR_HANDS
   equip abyssal_plate		position WEAR_BODY
   equip abyssal_legging	position WEAR_LEGS
   equip abyssal_boots		position WEAR_FEET
}
load xorlock		into sk_priest_room 	max 1
{
   equip battle_mace		position WEAR_WIELD
   equip abyssal_helmet		position WEAR_HEAD
   equip abyssal_sleeves	position WEAR_ARMS
   equip abyssal_gloves		position WEAR_HANDS
   equip abyssal_plate		position WEAR_BODY
   equip abyssal_legging	position WEAR_LEGS
   equip abyssal_boots		position WEAR_FEET
}
load acina		into sk_wiz_study 	max 1
{
   equip gray_robe		position WEAR_BODY
}

/* ----------------------- SPIRITS ---------------------------------- */

load asmo		into sk_room_death 	local 1
load scar		into sk_room_cruelty 	local 1
load stab		into sk_room_blood 	local 1

/* --------------------- OTHER MOBS --------------------------------- */

load parasite		into ash_belly 		local 1
{
   load crimson_gem local 1
}
load dying_devil	into battle_10 		local 1

/* XXX
load boatman            into styx_boat          local 1
{
   equip black_robe		position WEAR_BODY
   equip boatman_pole		position WEAR_WIELD
}
*/

load blork		into sk_kitchen 	local 1
{
   equip greasy_apron		position WEAR_BODY
   equip wooden_spoon		position WEAR_HOLD
   equip chopping_blade		position WEAR_WIELD
}

/* --------------------- OTHER ITEMS -------------------------------- */

load sign		into styx_bank02		max 1
load styx_boat		into styx_bank02 		max 1
{
   load boatman max 1
   {
      equip black_robe		position WEAR_BODY
      equip boatman_pole	position WEAR_WIELD
   }
}

/* ------------------------ DOORS ----------------------------------- */

door sk_entrance DOWN {EX_OPEN_CLOSE,EX_CLOSED}
door sk_top01 UP {EX_OPEN_CLOSE,EX_CLOSED}

door sk_top01 SOUTH {EX_OPEN_CLOSE,EX_CLOSED}
door sk_guard_room NORTH {EX_OPEN_CLOSE,EX_CLOSED}

door sk_top02 NORTH {EX_OPEN_CLOSE,EX_CLOSED}
door sk_kitchen SOUTH {EX_OPEN_CLOSE,EX_CLOSED}

door sk_top02 SOUTH {EX_OPEN_CLOSE,EX_CLOSED}
door sk_priest_room NORTH {EX_OPEN_CLOSE,EX_CLOSED}

door sk_top03 SOUTH {EX_OPEN_CLOSE,EX_CLOSED}
door sk_general_room NORTH {EX_OPEN_CLOSE,EX_CLOSED}

door sk_top03 NORTH {EX_OPEN_CLOSE,EX_CLOSED}
door sk_wiz_study SOUTH {EX_OPEN_CLOSE,EX_CLOSED}

door sk_mid01 NORTH {EX_OPEN_CLOSE,EX_CLOSED}
door sk_throne_ante SOUTH {EX_OPEN_CLOSE,EX_CLOSED}

door sk_throne_room EAST {EX_OPEN_CLOSE,EX_CLOSED,EX_LOCKED,EX_HIDDEN}
door sk_symbol_room WEST {EX_OPEN_CLOSE,EX_CLOSED,EX_LOCKED,EX_HIDDEN}

/* ------------------------ STUFF ----------------------------------- */

load god_board@midgaard		into the_nexus		local 1

%end



